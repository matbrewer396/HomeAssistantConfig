[
    {
        "id": "1e454935.091dd7",
        "type": "tab",
        "label": "Set input values",
        "disabled": false,
        "info": ""
    },
    {
        "id": "80866e71.966c6",
        "type": "tab",
        "label": "Alexa Inbound",
        "disabled": false,
        "info": ""
    },
    {
        "id": "cd950567.f864b8",
        "type": "tab",
        "label": "leaving / arriving",
        "disabled": false,
        "info": ""
    },
    {
        "id": "99d64a3d.f4e418",
        "type": "tab",
        "label": "Sun State Change",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b8a16318.b66a5",
        "type": "tab",
        "label": "Maintenance",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d73100a9.0d64d",
        "type": "tab",
        "label": "Auto Night",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a3158433.9d1f78",
        "type": "tab",
        "label": "Home / Away",
        "disabled": false,
        "info": ""
    },
    {
        "id": "1f9e3480.5be75c",
        "type": "tab",
        "label": "alexa testing",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a068bd5.28a8d4",
        "type": "tab",
        "label": "Presence Detection",
        "disabled": false,
        "info": ""
    },
    {
        "id": "f92add19.c43b9",
        "type": "tab",
        "label": "Input Selecter Handle",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a0a4859f.5a2a48",
        "type": "tab",
        "label": "Alarm",
        "disabled": false,
        "info": ""
    },
    {
        "id": "dceb45d8.425368",
        "type": "tab",
        "label": "Matt Lunch Time",
        "disabled": false,
        "info": ""
    },
    {
        "id": "48ba348c.61270c",
        "type": "tab",
        "label": "Fault Detection",
        "disabled": false,
        "info": ""
    },
    {
        "id": "940805f6.65fb98",
        "type": "tab",
        "label": "Testings",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a0cdc0f9.a362b",
        "type": "tab",
        "label": "BathRoom",
        "disabled": false,
        "info": ""
    },
    {
        "id": "acf12371.2c1ae",
        "type": "tab",
        "label": "Office",
        "disabled": false,
        "info": ""
    },
    {
        "id": "21d6efde.d0943",
        "type": "tab",
        "label": "Bedroom",
        "disabled": false,
        "info": ""
    },
    {
        "id": "c7191d19.c1e7b",
        "type": "tab",
        "label": "How Long In Bed",
        "disabled": false,
        "info": ""
    },
    {
        "id": "6e74caff.7ad1f4",
        "type": "tab",
        "label": "Kitchen",
        "disabled": false,
        "info": ""
    },
    {
        "id": "84ed1066.f22de",
        "type": "tab",
        "label": "Fridge / Freezer",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d1172b8b.3d3298",
        "type": "tab",
        "label": "DoorBell",
        "disabled": false,
        "info": ""
    },
    {
        "id": "9a341993.fbc528",
        "type": "tab",
        "label": "TV",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e361c01.ee9f54",
        "type": "tab",
        "label": "Hot Tub",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8a69107f.14257",
        "type": "tab",
        "label": "Library",
        "disabled": false,
        "info": ""
    },
    {
        "id": "5625076e.ee59e8",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a83e69e1.4b2ab8",
        "type": "subflow",
        "name": "Send Message",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 180,
                "wires": [
                    {
                        "id": "28fa280.0f108d8"
                    }
                ]
            }
        ],
        "out": [],
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": ""
            },
            {
                "name": "who",
                "type": "str",
                "value": ""
            },
            {
                "name": "notification_id",
                "type": "str",
                "value": ""
            },
            {
                "name": "title",
                "type": "str",
                "value": ""
            }
        ]
    },
    {
        "id": "47bc2d66.1132e4",
        "type": "subflow",
        "name": "Alexa",
        "info": "Pass in msg.say",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 60,
                "wires": [
                    {
                        "id": "c6c0af75.98fa5"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1440,
                "y": 60,
                "wires": [
                    {
                        "id": "275d0587.9c0bba",
                        "port": 0
                    }
                ]
            }
        ]
    },
    {
        "id": "a0cc6149.1f76e",
        "type": "subflow",
        "name": "Send Email",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "a0436269.f0533"
                    }
                ]
            }
        ],
        "out": []
    },
    {
        "id": "f5eab19a.7cf17",
        "type": "subflow",
        "name": "Error Handler",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 60,
                "wires": [
                    {
                        "id": "35126fda.6e6b4"
                    },
                    {
                        "id": "27296b10.af2594"
                    }
                ]
            }
        ],
        "out": []
    },
    {
        "id": "c9b308f8.01ef68",
        "type": "subflow",
        "name": "Good Night",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 40,
                "wires": [
                    {
                        "id": "4ad3a3ca.e993fc"
                    },
                    {
                        "id": "eafdd93e.9fb888"
                    },
                    {
                        "id": "13188644.21746a"
                    },
                    {
                        "id": "81018cf2.485d6"
                    },
                    {
                        "id": "d0cfbc85.dd2e7"
                    },
                    {
                        "id": "11925681.a709e9"
                    },
                    {
                        "id": "96315aaf.436ea8"
                    },
                    {
                        "id": "df1fe7a6.c64e78"
                    },
                    {
                        "id": "bc86c7f4.0d9708"
                    },
                    {
                        "id": "2971d7cd.f71318"
                    },
                    {
                        "id": "ddfafa57.793b48"
                    },
                    {
                        "id": "5a47e076.9bd83"
                    },
                    {
                        "id": "4cc8dc8e.5daea4"
                    },
                    {
                        "id": "9c8404e9.34ba08"
                    },
                    {
                        "id": "367929a4.b81d46"
                    },
                    {
                        "id": "63544d80.0c9704"
                    },
                    {
                        "id": "e1a0cf09.c2cb"
                    }
                ]
            }
        ],
        "out": []
    },
    {
        "id": "20dffe5a.37e8a2",
        "type": "subflow",
        "name": "Forward Light Comands",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "681f52a2.6e388c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 700,
                "y": 40,
                "wires": [
                    {
                        "id": "a14e6e3.6e53b9",
                        "port": 0
                    }
                ]
            }
        ]
    },
    {
        "id": "7df159d5.618c58",
        "type": "subflow",
        "name": "Set Bed Lights",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 80,
                "wires": [
                    {
                        "id": "e890483e.ef37a8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1020,
                "y": 60,
                "wires": [
                    {
                        "id": "54664ccd.b262b4",
                        "port": 0
                    }
                ]
            }
        ],
        "env": []
    },
    {
        "id": "56368b94.f11494",
        "type": "subflow",
        "name": "Is Dark",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 80,
                "wires": [
                    {
                        "id": "bac0e249.335d6"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 540,
                "y": 40,
                "wires": [
                    {
                        "id": "76978b35.4c91e4",
                        "port": 0
                    }
                ]
            },
            {
                "x": 540,
                "y": 100,
                "wires": [
                    {
                        "id": "76978b35.4c91e4",
                        "port": 1
                    }
                ]
            },
            {
                "x": 540,
                "y": 160,
                "wires": [
                    {
                        "id": "76978b35.4c91e4",
                        "port": 2
                    }
                ]
            }
        ],
        "env": [],
        "outputLabels": [
            "True",
            "False",
            "Unknown"
        ]
    },
    {
        "id": "2aff94ce.fdbbdc",
        "type": "subflow",
        "name": "Turn off computer",
        "info": "",
        "category": "sences",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "97ee681f.882eb8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 740,
                "y": 120,
                "wires": [
                    {
                        "id": "2554c135.8f322e",
                        "port": 0
                    }
                ]
            }
        ],
        "env": []
    },
    {
        "id": "fec14295.8a46d",
        "type": "subflow",
        "name": "PayLoad Status",
        "info": "",
        "category": "MSB Core",
        "in": [
            {
                "x": 100,
                "y": 140,
                "wires": [
                    {
                        "id": "3889bd46.c46682"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 480,
                "y": 40,
                "wires": [
                    {
                        "id": "3889bd46.c46682",
                        "port": 0
                    },
                    {
                        "id": "3889bd46.c46682",
                        "port": 1
                    },
                    {
                        "id": "3889bd46.c46682",
                        "port": 2
                    },
                    {
                        "id": "3889bd46.c46682",
                        "port": 3
                    }
                ]
            },
            {
                "x": 480,
                "y": 200,
                "wires": [
                    {
                        "id": "3889bd46.c46682",
                        "port": 4
                    },
                    {
                        "id": "3889bd46.c46682",
                        "port": 5
                    },
                    {
                        "id": "3889bd46.c46682",
                        "port": 6
                    },
                    {
                        "id": "3889bd46.c46682",
                        "port": 7
                    }
                ]
            },
            {
                "x": 480,
                "y": 320,
                "wires": [
                    {
                        "id": "3889bd46.c46682",
                        "port": 8
                    }
                ]
            }
        ],
        "env": []
    },
    {
        "id": "cdbc6ec6.2e0ec",
        "type": "subflow",
        "name": "Is any on home?",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 60,
                "wires": [
                    {
                        "id": "49841f4d.0e0a6"
                    },
                    {
                        "id": "1f3dd269.5d463e"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 880,
                "y": 40,
                "wires": [
                    {
                        "id": "78367767.3a14a8",
                        "port": 0
                    }
                ]
            },
            {
                "x": 880,
                "y": 100,
                "wires": [
                    {
                        "id": "78367767.3a14a8",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "outputLabels": [
            "True",
            "False"
        ]
    },
    {
        "id": "85970b46.61e358",
        "type": "subflow",
        "name": "Allow Notication",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "b4c7c6f4.4d91b8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1020,
                "y": 20,
                "wires": [
                    {
                        "id": "9488063b.727978",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1020,
                "y": 60,
                "wires": [
                    {
                        "id": "9488063b.727978",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "NOTHING"
            }
        ]
    },
    {
        "id": "7355692b.0038c8",
        "type": "subflow",
        "name": "Sec to Readable",
        "info": "",
        "category": "MSB Core",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "93417511.0ebcd8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 500,
                "y": 100,
                "wires": [
                    {
                        "id": "93417511.0ebcd8",
                        "port": 0
                    }
                ]
            }
        ],
        "env": []
    },
    {
        "id": "5ee4d578.f7736c",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "eef5a84.da24f58",
        "type": "server",
        "z": "",
        "name": "Home Assistant",
        "legacy": false,
        "hassio": true,
        "rejectUnauthorizedCerts": true
    },
    {
        "id": "1b6bc4ba.56ff4b",
        "type": "mqtt-broker",
        "z": "",
        "name": "monitor",
        "broker": "192.168.1.253",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "Hassio",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "525afe76.43e05",
        "type": "light-scheduler-settings",
        "z": "",
        "name": "Home",
        "latitude": "51.398660",
        "longitude": "-1.316950"
    },
    {
        "id": "152fa50f.b6f93b",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "56ac32d7.54222c",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "fe14a53.c42df58",
        "type": "light-scheduler-settings",
        "z": "",
        "name": "my settings",
        "latitude": "45.5490814",
        "longitude": "-22.44234640000001"
    },
    {
        "id": "abf0af3d.05949",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "90568782.0ff848",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "88eacd55.1ede5",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "9f26169c.88edf8",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "b630936b.d17eb",
        "type": "server",
        "z": "",
        "name": "Home Assistant"
    },
    {
        "id": "a71d0a02.2b45f8",
        "type": "server",
        "z": "",
        "name": "Home Assistant",
        "legacy": false,
        "hassio": false,
        "rejectUnauthorizedCerts": false
    },
    {
        "id": "e0e223e3.be824",
        "type": "ui_group",
        "z": "",
        "name": "Bulb switch",
        "tab": "c788498.02a4db8",
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "c788498.02a4db8",
        "type": "ui_tab",
        "z": "",
        "name": "Lights",
        "icon": "dashboard"
    },
    {
        "id": "3fa4c0fe.0f3ed",
        "type": "alexa-home-conf",
        "z": "",
        "username": "matbrewer396@gmail.com"
    },
    {
        "id": "404b4ef1.dd9e5",
        "type": "ui_group",
        "z": "",
        "name": "Default",
        "tab": "daa13738.1a9ba8",
        "disp": false,
        "width": "6"
    },
    {
        "id": "daa13738.1a9ba8",
        "type": "ui_tab",
        "z": "",
        "name": "Test",
        "icon": "dashboard",
        "order": 1
    },
    {
        "id": "839c216a.4a97d",
        "type": "api-call-service",
        "z": "a83e69e1.4b2ab8",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 710,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "c5f11237.56983",
        "type": "function",
        "z": "47bc2d66.1132e4",
        "name": "Build Data",
        "func": "msg.payload = {\n    \"data\":\n        { \"message\": msg.say\n        ,\"data\": {\"type\":\"tts\"}\n        , \"target\": msg.pri_alexa }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 60,
        "wires": [
            [
                "275d0587.9c0bba"
            ]
        ]
    },
    {
        "id": "275d0587.9c0bba",
        "type": "api-call-service",
        "z": "47bc2d66.1132e4",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "alexa_media",
        "data": "",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 1190,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "c6c0af75.98fa5",
        "type": "switch",
        "z": "47bc2d66.1132e4",
        "name": "",
        "property": "alexa",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "office",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Kitchen",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 230,
        "y": 180,
        "wires": [
            [
                "dfc50416.e4f068"
            ],
            [
                "f378f617.7ecbe8"
            ],
            [
                "2704ac25.a7fd64"
            ],
            [
                "3d3fb4fe.b5ba7c"
            ],
            [
                "f3a398d3.2da708"
            ]
        ]
    },
    {
        "id": "f3a398d3.2da708",
        "type": "change",
        "z": "47bc2d66.1132e4",
        "name": "All",
        "rules": [
            {
                "t": "set",
                "p": "pri_alexa",
                "pt": "msg",
                "to": "[\"media_player.bedroom_2\",\"media_player.living_room_2\",\"media_player.kitten\",\"media_player.office\",\"media_player.barthroom_2\"]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 300,
        "wires": [
            [
                "c5f11237.56983"
            ]
        ]
    },
    {
        "id": "2704ac25.a7fd64",
        "type": "change",
        "z": "47bc2d66.1132e4",
        "name": "Office",
        "rules": [
            {
                "t": "set",
                "p": "pri_alexa",
                "pt": "msg",
                "to": "[\"media_player.office\"]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 220,
        "wires": [
            [
                "c5f11237.56983"
            ]
        ]
    },
    {
        "id": "dfc50416.e4f068",
        "type": "change",
        "z": "47bc2d66.1132e4",
        "name": "Down",
        "rules": [
            {
                "t": "set",
                "p": "pri_alexa",
                "pt": "msg",
                "to": "[\"media_player.kitten\",\"media_player.living_room_2\",\"media_player.office\"]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 140,
        "wires": [
            [
                "c5f11237.56983"
            ]
        ]
    },
    {
        "id": "f378f617.7ecbe8",
        "type": "change",
        "z": "47bc2d66.1132e4",
        "name": "Up",
        "rules": [
            {
                "t": "set",
                "p": "pri_alexa",
                "pt": "msg",
                "to": "[\"media_player.bedroom_2\",\"media_player.barthroom_2\"]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 180,
        "wires": [
            [
                "c5f11237.56983"
            ]
        ]
    },
    {
        "id": "f3c4fe69.bcf49",
        "type": "server-state-changed",
        "z": "a3158433.9d1f78",
        "name": "Danni Home/Away",
        "server": "eef5a84.da24f58",
        "entityidfilter": "device_tracker.life360_danni",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 150,
        "y": 452,
        "wires": [
            [
                "b15702d1.3a09"
            ]
        ]
    },
    {
        "id": "8bff2496.0f9698",
        "type": "server-state-changed",
        "z": "a3158433.9d1f78",
        "name": "Matt Home/Away",
        "server": "eef5a84.da24f58",
        "entityidfilter": "device_tracker.life360_matt",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 140,
        "y": 492,
        "wires": [
            [
                "57ce7fd6.512fb"
            ]
        ]
    },
    {
        "id": "2040e4b1.d5c3fc",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "Home/Away State Change",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1180,
        "y": 520,
        "wires": [
            [
                "728fde3f.09ce9",
                "688dba9c.79d5d4",
                "28fe8ca4.275294",
                "e7ea3a2f.0a3d58"
            ]
        ]
    },
    {
        "id": "53c7d5e.0294d2c",
        "type": "inject",
        "z": "a3158433.9d1f78",
        "name": "Started",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "15",
        "x": 140,
        "y": 661,
        "wires": [
            [
                "2040e4b1.d5c3fc"
            ]
        ]
    },
    {
        "id": "688dba9c.79d5d4",
        "type": "api-current-state",
        "z": "a3158433.9d1f78",
        "name": "",
        "server": "eef5a84.da24f58",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "device_tracker.life360_matt",
        "override_payload": true,
        "override_data": true,
        "x": 1520,
        "y": 480,
        "wires": [
            [
                "5d6e628f.7aa7fc"
            ]
        ]
    },
    {
        "id": "728fde3f.09ce9",
        "type": "api-current-state",
        "z": "a3158433.9d1f78",
        "name": "",
        "server": "eef5a84.da24f58",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "device_tracker.life360_danni",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1530,
        "y": 440,
        "wires": [
            [
                "5d6e628f.7aa7fc"
            ]
        ]
    },
    {
        "id": "5d6e628f.7aa7fc",
        "type": "join",
        "z": "a3158433.9d1f78",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "4",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "num",
        "reduceFixup": "",
        "x": 1850,
        "y": 591,
        "wires": [
            [
                "4f9fd6c1.ad5b48"
            ]
        ]
    },
    {
        "id": "4f9fd6c1.ad5b48",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "Is Anyone Home",
        "func": "var currentstate = msg.payload[3];\n\n// is someone home?\nif (msg.payload[0] == \"home\" || msg.payload[1] == \"home\" || msg.payload[2] == \"on\") {\n    msg.payload=\"home\";\n} else {\n    msg.payload=\"away\";\n}\n\n// check if status need changing\nif ( (msg.payload==\"home\" && currentstate ==\"off\") || (msg.payload==\"away\" && currentstate ==\"on\") ) {\n    return msg; // Status Changed\n}\n//Else do nothin",
        "outputs": 1,
        "noerr": 0,
        "x": 2020,
        "y": 591,
        "wires": [
            [
                "4d55b523.00f95c"
            ]
        ]
    },
    {
        "id": "21652d70.72b232",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "Is Anyone Home?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "away",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2770,
        "y": 588,
        "wires": [
            [
                "634ad6f8.7dd188",
                "883e0b57.4516a8"
            ],
            [
                "6ee79555.3f313c"
            ]
        ]
    },
    {
        "id": "5833b5e2.1eff2c",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Is Any One Home - Bluetooth",
        "info": "",
        "x": 180,
        "y": 180,
        "wires": []
    },
    {
        "id": "28fe8ca4.275294",
        "type": "api-current-state",
        "z": "a3158433.9d1f78",
        "name": "Do we  have guests?",
        "server": "eef5a84.da24f58",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "input_boolean.guestmode",
        "override_payload": true,
        "x": 1460,
        "y": 600,
        "wires": [
            [
                "5d6e628f.7aa7fc"
            ]
        ]
    },
    {
        "id": "eaeaafd.b8a8f5",
        "type": "server-state-changed",
        "z": "a3158433.9d1f78",
        "name": "Guest Mode Change",
        "server": "eef5a84.da24f58",
        "entityidfilter": "input_boolean.guestmode",
        "entityidfiltertype": "substring",
        "haltifstate": "",
        "outputs": 1,
        "x": 150,
        "y": 601,
        "wires": [
            [
                "cab70747.d77428"
            ]
        ]
    },
    {
        "id": "1614fe61.738122",
        "type": "link in",
        "z": "a3158433.9d1f78",
        "name": "Home",
        "links": [
            "634ad6f8.7dd188"
        ],
        "x": 75,
        "y": 912,
        "wires": [
            [
                "aea97881.44ab78",
                "a2cfceb9.6eebc",
                "23bafa9c.c59eb6"
            ]
        ],
        "outputLabels": [
            "Home"
        ]
    },
    {
        "id": "634ad6f8.7dd188",
        "type": "link out",
        "z": "a3158433.9d1f78",
        "name": "Welcome Home",
        "links": [
            "1614fe61.738122",
            "2eee0fe3.6615e"
        ],
        "x": 2995,
        "y": 500,
        "wires": [],
        "inputLabels": [
            "Home"
        ]
    },
    {
        "id": "70cd6553.d9d7cc",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Some one is now home",
        "info": "",
        "x": 160,
        "y": 861,
        "wires": []
    },
    {
        "id": "e7ea3a2f.0a3d58",
        "type": "api-current-state",
        "z": "a3158433.9d1f78",
        "name": "Current State Is Any One Home?",
        "server": "eef5a84.da24f58",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "input_boolean.isanyonehome",
        "override_payload": true,
        "override_data": true,
        "x": 1500,
        "y": 640,
        "wires": [
            [
                "5d6e628f.7aa7fc"
            ]
        ]
    },
    {
        "id": "a849bd7.c3a3a4",
        "type": "light-scheduler",
        "z": "b8a16318.b66a5",
        "settings": "525afe76.43e05",
        "events": "[]",
        "topic": "",
        "name": "Minutely",
        "onPayload": "ON",
        "onPayloadType": "str",
        "offPayload": "OFF",
        "offPayloadType": "str",
        "onlyWhenDark": true,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "outputfreq": "output.minutely",
        "x": 80,
        "y": 180,
        "wires": [
            [
                "b8da62bc.cac9f"
            ]
        ]
    },
    {
        "id": "b8da62bc.cac9f",
        "type": "api-call-service",
        "z": "b8a16318.b66a5",
        "name": "trigger",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_boolean",
        "service": "toggle",
        "data": "{\"entity_id\":\"input_boolean.node_red\"}",
        "mergecontext": "",
        "x": 450,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "cf21f0fb.2f7f3",
        "type": "server-state-changed",
        "z": "b8a16318.b66a5",
        "name": "",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "input_boolean.node_red",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 180,
        "y": 240,
        "wires": [
            [
                "ec2a3737.b71338"
            ]
        ]
    },
    {
        "id": "ec2a3737.b71338",
        "type": "change",
        "z": "b8a16318.b66a5",
        "name": "Ok",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ok",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 240,
        "wires": [
            [
                "9214255.4c06fd8"
            ]
        ]
    },
    {
        "id": "9214255.4c06fd8",
        "type": "mqtt out",
        "z": "b8a16318.b66a5",
        "name": "Check In",
        "topic": "checkIn/nodeRED",
        "qos": "0",
        "retain": "",
        "broker": "1b6bc4ba.56ff4b",
        "x": 720,
        "y": 240,
        "wires": []
    },
    {
        "id": "f4d0131e.967c4",
        "type": "link out",
        "z": "a3158433.9d1f78",
        "name": "No One Home",
        "links": [
            "cf6185e1.eca748"
        ],
        "x": 3475,
        "y": 660,
        "wires": [],
        "inputLabels": [
            "NoOneHome"
        ]
    },
    {
        "id": "cb6f8d7b.e7f43",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Holiday Day Mode",
        "info": "",
        "x": 150,
        "y": 1140,
        "wires": []
    },
    {
        "id": "cf6185e1.eca748",
        "type": "link in",
        "z": "a3158433.9d1f78",
        "name": "No One Home",
        "links": [
            "f4d0131e.967c4"
        ],
        "x": 275,
        "y": 1320,
        "wires": [
            [
                "10c5642a.86179c",
                "606db896.9f2128",
                "b0c86ed5.ad287",
                "dc2626b6.cb8a88",
                "740c59e5.4fccd8"
            ]
        ]
    },
    {
        "id": "10c5642a.86179c",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "",
        "op2": "1",
        "op1type": "nul",
        "op2type": "str",
        "duration": "24",
        "extend": false,
        "units": "hr",
        "reset": "some_one_home",
        "bytopic": "all",
        "name": "",
        "x": 850,
        "y": 1320,
        "wires": [
            [
                "c29bf2f6.ae361",
                "6fd0fa0d.478324"
            ]
        ]
    },
    {
        "id": "2eee0fe3.6615e",
        "type": "link in",
        "z": "a3158433.9d1f78",
        "name": "",
        "links": [
            "634ad6f8.7dd188"
        ],
        "x": 275,
        "y": 1360,
        "wires": [
            [
                "ab10961d.96e4e8",
                "52988821.c30f68"
            ]
        ]
    },
    {
        "id": "b7036f12.99341",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "No One Home",
        "info": "",
        "x": 130,
        "y": 1320,
        "wires": []
    },
    {
        "id": "12b35117.aa471f",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Some one home",
        "info": "",
        "x": 140,
        "y": 1360,
        "wires": []
    },
    {
        "id": "ab10961d.96e4e8",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "some_one_home",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1360,
        "wires": [
            [
                "10c5642a.86179c",
                "606db896.9f2128"
            ]
        ]
    },
    {
        "id": "c29bf2f6.ae361",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Activing holiday - Message",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"I miss you! Activing holiday mode\",\"data\":{\"push\":{\"badge\":5,\"category\":\"missyou\"}}}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1100,
        "y": 1320,
        "wires": [
            []
        ]
    },
    {
        "id": "6fd0fa0d.478324",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Active Holiday Mode",
        "server": "eef5a84.da24f58",
        "service_domain": "input_boolean",
        "service": "turn_on",
        "data": "{\"entity_id\":\"input_boolean.holidaymode\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1080,
        "y": 1360,
        "wires": [
            []
        ]
    },
    {
        "id": "7bfe7445.6fe4ec",
        "type": "api-call-service",
        "z": "99d64a3d.f4e418",
        "name": "Turn Off Lights",
        "server": "eef5a84.da24f58",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hue_lightstrip_plus_1\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1040,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "626c9c60.30cf24",
        "type": "delay",
        "z": "99d64a3d.f4e418",
        "name": "wait 25 min",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 790,
        "y": 160,
        "wires": [
            [
                "7bfe7445.6fe4ec"
            ]
        ]
    },
    {
        "id": "c097e9b2.498308",
        "type": "server-state-changed",
        "z": "d1172b8b.3d3298",
        "name": "Press Door Bell",
        "server": "eef5a84.da24f58",
        "entityidfilter": "sensor.doorbell",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 120,
        "y": 180,
        "wires": [
            [
                "20c3a105.50479e"
            ]
        ]
    },
    {
        "id": "20c3a105.50479e",
        "type": "switch",
        "z": "d1172b8b.3d3298",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Ding",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 450,
        "y": 180,
        "wires": [
            [
                "758d40c5.72f3a",
                "ae019a30.ff6f78"
            ]
        ]
    },
    {
        "id": "d5016157.07bab",
        "type": "server-state-changed",
        "z": "99d64a3d.f4e418",
        "name": "Sun Changes",
        "server": "eef5a84.da24f58",
        "entityidfilter": "sun.sun",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 130,
        "y": 200,
        "wires": [
            [
                "65dc3645.de0718"
            ]
        ]
    },
    {
        "id": "90da2e6b.cdc5f",
        "type": "function",
        "z": "99d64a3d.f4e418",
        "name": "Check if sun is up",
        "func": "var oldstatus=global.get('sunstate') || \"unknown\";\n\nif (msg.payload == \"above_horizon\" && oldstatus == \"below_horizon\") {\n    global.set('sunstate', msg.payload)\n    return msg;\n} else if ( oldstatus !== msg.payload ) {\n    global.set('sunstate', msg.payload)\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 200,
        "wires": [
            [
                "626c9c60.30cf24",
                "6125c1be.4d871",
                "7186346f.4ab48c"
            ]
        ]
    },
    {
        "id": "9870fe03.bab26",
        "type": "server-state-changed",
        "z": "1e454935.091dd7",
        "name": "Good Night",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "input_boolean.goodnight",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 130,
        "y": 180,
        "wires": [
            [
                "a733e2b3.2fbae",
                "2ddc2933.91dc56"
            ]
        ]
    },
    {
        "id": "a733e2b3.2fbae",
        "type": "switch",
        "z": "1e454935.091dd7",
        "name": "Is On?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 290,
        "y": 180,
        "wires": [
            [
                "9567c19f.3fa0b"
            ]
        ]
    },
    {
        "id": "6e45a7ed.2c8728",
        "type": "api-call-service",
        "z": "d73100a9.0d64d",
        "name": "Is it Bed time - Matt",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Bed time? I'm turning everything off in 5 minutes\",\"data\":{\"push\":{\"badge\":5,\"category\":\"goodnight\"}}}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 2090,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "42b9d4f8.a38aac",
        "type": "server-events",
        "z": "d73100a9.0d64d",
        "name": "All",
        "server": "eef5a84.da24f58",
        "event_type": "",
        "x": 90,
        "y": 580,
        "wires": [
            [
                "719c46bb.4eab48"
            ]
        ]
    },
    {
        "id": "719c46bb.4eab48",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "",
        "property": "payload.event.actionName",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "STILL_AWAKE_30",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "STILL_AWAKE_60",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "STILL_AWAKE_180",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "GOOD_NIGHT_NOW",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "DISABLE_AUTO_NIGHT",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 290,
        "y": 580,
        "wires": [
            [
                "99df83ab.46e3b",
                "987ed362.eb692",
                "8a9e4a8c.294d28"
            ],
            [
                "99df83ab.46e3b",
                "be9e3159.3ea59"
            ],
            [
                "99df83ab.46e3b",
                "69a40cbb.df3674"
            ],
            [
                "33d67a23.de0b26"
            ],
            [
                "99df83ab.46e3b"
            ]
        ]
    },
    {
        "id": "3ba7ec90.402494",
        "type": "light-scheduler",
        "z": "d73100a9.0d64d",
        "settings": "525afe76.43e05",
        "events": "[{\"start\":{\"dow\":6,\"mod\":1365},\"end\":{\"dow\":0,\"mod\":0}},{\"start\":{\"dow\":5,\"mod\":1350},\"end\":{\"dow\":6,\"mod\":0}},{\"start\":{\"dow\":1,\"mod\":0},\"end\":{\"dow\":1,\"mod\":420}},{\"start\":{\"dow\":2,\"mod\":0},\"end\":{\"dow\":2,\"mod\":420}},{\"start\":{\"dow\":3,\"mod\":0},\"end\":{\"dow\":3,\"mod\":420}},{\"start\":{\"dow\":4,\"mod\":0},\"end\":{\"dow\":4,\"mod\":420}},{\"start\":{\"dow\":5,\"mod\":0},\"end\":{\"dow\":5,\"mod\":420}},{\"start\":{\"dow\":6,\"mod\":0},\"end\":{\"dow\":6,\"mod\":420}},{\"start\":{\"dow\":0,\"mod\":0},\"end\":{\"dow\":0,\"mod\":420}},{\"start\":{\"dow\":2,\"mod\":1290},\"end\":{\"dow\":3,\"mod\":0}},{\"start\":{\"dow\":3,\"mod\":1290},\"end\":{\"dow\":4,\"mod\":0}},{\"start\":{\"dow\":4,\"mod\":1290},\"end\":{\"dow\":5,\"mod\":0}},{\"start\":{\"dow\":0,\"mod\":1290},\"end\":{\"dow\":1,\"mod\":30}},{\"start\":{\"dow\":1,\"mod\":1200},\"end\":{\"dow\":2,\"mod\":0}},{\"start\":{\"dow\":2,\"mod\":1200},\"end\":{\"dow\":2,\"mod\":1290}},{\"start\":{\"dow\":3,\"mod\":1200},\"end\":{\"dow\":3,\"mod\":1290}},{\"start\":{\"dow\":4,\"mod\":1200},\"end\":{\"dow\":4,\"mod\":1290}},{\"start\":{\"dow\":0,\"mod\":1200},\"end\":{\"dow\":0,\"mod\":1290}},{\"start\":{\"dow\":6,\"mod\":1320},\"end\":{\"dow\":6,\"mod\":1365}},{\"start\":{\"dow\":5,\"mod\":1320},\"end\":{\"dow\":5,\"mod\":1350}},{\"start\":{\"dow\":6,\"mod\":1305},\"end\":{\"dow\":6,\"mod\":1320}},{\"start\":{\"dow\":5,\"mod\":1305},\"end\":{\"dow\":5,\"mod\":1320}},{\"start\":{\"dow\":1,\"mod\":1140},\"end\":{\"dow\":1,\"mod\":1200}},{\"start\":{\"dow\":2,\"mod\":1140},\"end\":{\"dow\":2,\"mod\":1200}},{\"start\":{\"dow\":3,\"mod\":1140},\"end\":{\"dow\":3,\"mod\":1200}},{\"start\":{\"dow\":0,\"mod\":1140},\"end\":{\"dow\":0,\"mod\":1200}},{\"start\":{\"dow\":4,\"mod\":1140},\"end\":{\"dow\":4,\"mod\":1200}}]",
        "topic": "",
        "name": "Auto Good Night",
        "onPayload": "On",
        "onPayloadType": "str",
        "offPayload": "Off",
        "offPayloadType": "str",
        "onlyWhenDark": false,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "outputfreq": "output.statechange.startup",
        "x": 130,
        "y": 360,
        "wires": [
            [
                "6f09f51.c3f470c"
            ]
        ]
    },
    {
        "id": "76161c80.f91cb4",
        "type": "rbe",
        "z": "d73100a9.0d64d",
        "name": "RBE",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 470,
        "y": 360,
        "wires": [
            [
                "3ab9d8ee.d56268"
            ]
        ]
    },
    {
        "id": "3ab9d8ee.d56268",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "Is it night",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "On",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 620,
        "y": 360,
        "wires": [
            [
                "e259c26a.e4ce5",
                "3f4805be.d14eba"
            ],
            [
                "8f58fd59.491a9"
            ]
        ]
    },
    {
        "id": "99df83ab.46e3b",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "Disabled minutes timer",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 742,
        "y": 510,
        "wires": [
            [
                "ef7cb132.ad547",
                "4ebb4395.792b0c",
                "a9920411.01ba78",
                "94c4fb0a.6129d8",
                "b399da43.7ff288",
                "c73f668c.f7ef28"
            ]
        ]
    },
    {
        "id": "ef7cb132.ad547",
        "type": "trigger",
        "z": "d73100a9.0d64d",
        "op1": "",
        "op2": "on",
        "op1type": "nul",
        "op2type": "str",
        "duration": "30",
        "extend": false,
        "units": "min",
        "reset": "off",
        "bytopic": "all",
        "name": "",
        "x": 972,
        "y": 610,
        "wires": [
            [
                "5d68af75.25cde",
                "57390bd5.d36854"
            ]
        ]
    },
    {
        "id": "4ebb4395.792b0c",
        "type": "trigger",
        "z": "d73100a9.0d64d",
        "op1": "",
        "op2": "on",
        "op1type": "nul",
        "op2type": "str",
        "duration": "60",
        "extend": false,
        "units": "min",
        "reset": "off",
        "bytopic": "all",
        "name": "",
        "x": 972,
        "y": 670,
        "wires": [
            [
                "5d68af75.25cde"
            ]
        ]
    },
    {
        "id": "a9920411.01ba78",
        "type": "trigger",
        "z": "d73100a9.0d64d",
        "op1": "",
        "op2": "on",
        "op1type": "nul",
        "op2type": "str",
        "duration": "180",
        "extend": false,
        "units": "min",
        "reset": "off",
        "bytopic": "all",
        "name": "",
        "x": 982,
        "y": 730,
        "wires": [
            [
                "5d68af75.25cde"
            ]
        ]
    },
    {
        "id": "5d68af75.25cde",
        "type": "link out",
        "z": "d73100a9.0d64d",
        "name": "Good Night Message",
        "links": [
            "c3aa3a6e.de2c88",
            "29c3c120.517e0e"
        ],
        "x": 1162,
        "y": 630,
        "wires": []
    },
    {
        "id": "57390bd5.d36854",
        "type": "debug",
        "z": "d73100a9.0d64d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1182,
        "y": 550,
        "wires": []
    },
    {
        "id": "987ed362.eb692",
        "type": "debug",
        "z": "d73100a9.0d64d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 732,
        "y": 570,
        "wires": []
    },
    {
        "id": "8a9e4a8c.294d28",
        "type": "delay",
        "z": "d73100a9.0d64d",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 742,
        "y": 610,
        "wires": [
            [
                "ef7cb132.ad547"
            ]
        ]
    },
    {
        "id": "be9e3159.3ea59",
        "type": "delay",
        "z": "d73100a9.0d64d",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 742,
        "y": 670,
        "wires": [
            [
                "4ebb4395.792b0c"
            ]
        ]
    },
    {
        "id": "69a40cbb.df3674",
        "type": "delay",
        "z": "d73100a9.0d64d",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 742,
        "y": 730,
        "wires": [
            [
                "a9920411.01ba78"
            ]
        ]
    },
    {
        "id": "e259c26a.e4ce5",
        "type": "api-current-state",
        "z": "d73100a9.0d64d",
        "name": "Holiday Mode",
        "server": "eef5a84.da24f58",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "input_boolean.holidaymode",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 800,
        "y": 360,
        "wires": [
            [
                "79ee0fe4.ad1bd"
            ]
        ]
    },
    {
        "id": "79ee0fe4.ad1bd",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "No?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 990,
        "y": 340,
        "wires": [
            [],
            [
                "6ea9b8b4.f2d438"
            ]
        ]
    },
    {
        "id": "4fe60a4.0699df4",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"message\":\"ding-dong. someone is at the door ding dong ding\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 560,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "33cd10bc.f8f8d",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 290,
        "y": 60,
        "wires": [
            [
                "4fe60a4.0699df4"
            ]
        ]
    },
    {
        "id": "de1dc5d2.7f3ee8",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"media_player.everywhere\",\"message\":\"ding-dong. someone is at the door ding dong ding\"}",
        "mergecontext": "",
        "x": 620,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "9b8fbc9.c6f7f4",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "Everywhere doesnt work",
        "info": "",
        "x": 330,
        "y": 160,
        "wires": []
    },
    {
        "id": "3df4c611.fbbcda",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Hallway Motion",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "binary_sensor.hallway_motion_sensor",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 120,
        "y": 400,
        "wires": [
            [
                "c8944506.30f148",
                "e04902ac.5849e"
            ]
        ]
    },
    {
        "id": "84d7dd65.ad146",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Bath Room Motion",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "binary_sensor.bathroom_motion_sensor",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 130,
        "y": 560,
        "wires": [
            [
                "8d007ed4.b4b9",
                "90fde8f7.a26cb8"
            ]
        ]
    },
    {
        "id": "64a723bb.a421cc",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "Triggered?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 870,
        "y": 660,
        "wires": [
            [
                "297e3f11.045a3"
            ]
        ]
    },
    {
        "id": "3b5bbfbe.77c1d",
        "type": "link in",
        "z": "d73100a9.0d64d",
        "name": "Good Night Triggered",
        "links": [],
        "x": 55,
        "y": 472,
        "wires": [
            [
                "7b1a73dc.d70fec"
            ]
        ]
    },
    {
        "id": "7b1a73dc.d70fec",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "On",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 472,
        "wires": [
            [
                "99df83ab.46e3b"
            ]
        ]
    },
    {
        "id": "55cdae2b.c2b73",
        "type": "comment",
        "z": "d73100a9.0d64d",
        "name": "Good Night Triggerd",
        "info": "",
        "x": 130,
        "y": 412,
        "wires": []
    },
    {
        "id": "65dc3645.de0718",
        "type": "rbe",
        "z": "99d64a3d.f4e418",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 330,
        "y": 200,
        "wires": [
            [
                "90da2e6b.cdc5f"
            ]
        ]
    },
    {
        "id": "2fb494b2.81f1ac",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Living Room Cam",
        "server": "5ee4d578.f7736c",
        "entityidfilter": " input_boolean.motionlivingroom",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 130,
        "y": 831,
        "wires": [
            [
                "2c51c6d4.5f6e0a",
                "8fb9ba5e.40ec38"
            ]
        ]
    },
    {
        "id": "c8944506.30f148",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Hallway Motion Detected",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Hallway Motion Detected",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "image",
                "pt": "msg",
                "to": "https://msb396.duckdns.org/api/camera_proxy/camera.living_room?token=6bf07bbf33a0a37622a7fd25c019ed1fb1169449b4a0b808fafdb5800b2e5c3f",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 400,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "8d007ed4.b4b9",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Bathroom Motion Detected",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Bathroom Motion Detected",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 560,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "2c51c6d4.5f6e0a",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Living Motion Detected",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Living Room Motion Detected",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "image",
                "pt": "msg",
                "to": "https://msb396.duckdns.org/api/camera_proxy/camera.living_room?token=6bf07bbf33a0a37622a7fd25c019ed1fb1169449b4a0b808fafdb5800b2e5c3f",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "trusted",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 831,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "8fb9ba5e.40ec38",
        "type": "api-current-state",
        "z": "a068bd5.28a8d4",
        "name": "Main Light Status On?",
        "server": "9f26169c.88edf8",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "light.living_room_lights",
        "override_payload": true,
        "override_data": true,
        "x": 680,
        "y": 1100,
        "wires": [
            [
                "59366fbb.88318"
            ]
        ]
    },
    {
        "id": "17dd0169.527b5f",
        "type": "api-current-state",
        "z": "a068bd5.28a8d4",
        "name": "Good Night Been Trigger",
        "server": "9f26169c.88edf8",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "input_boolean.goodnight_beentriggered",
        "override_payload": true,
        "override_data": true,
        "x": 1150,
        "y": 1100,
        "wires": [
            [
                "805e34e0.934a48"
            ]
        ]
    },
    {
        "id": "a961f727.8da2a8",
        "type": "api-call-service",
        "z": "99d64a3d.f4e418",
        "name": "Reset - Has Been Triggered",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_boolean",
        "service": "turn_off",
        "data": "{\"entity_id\":\"input_boolean.goodnight_beentriggered\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1140,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "59366fbb.88318",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "On / Off",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 880,
        "y": 1100,
        "wires": [
            [
                "17dd0169.527b5f"
            ],
            []
        ]
    },
    {
        "id": "805e34e0.934a48",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "On / Off",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1400,
        "y": 1100,
        "wires": [
            [
                "dee4af6a.215dc"
            ],
            []
        ]
    },
    {
        "id": "dee4af6a.215dc",
        "type": "debug",
        "z": "a068bd5.28a8d4",
        "name": "Trigger Light",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1620,
        "y": 1100,
        "wires": []
    },
    {
        "id": "f0d43a70.70bbb8",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "Set 60%",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "volume_set",
        "data": "{\"entity_id\":\"media_player.bedroom\",\"volume_level\":\"0.67\"}",
        "mergecontext": "",
        "x": 600,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "34f12c36.4e6ae4",
        "type": "function",
        "z": "1f9e3480.5be75c",
        "name": "Data",
        "func": "msg.payload.data = \n{\n    \"entity_id\": \"media_player.bedroom\",\n    \"volume_level\": \"1\"\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 730,
        "y": 360,
        "wires": [
            [
                "92091263.aba56"
            ]
        ]
    },
    {
        "id": "9dbceeb3.9578e",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 220,
        "y": 260,
        "wires": [
            [
                "f0d43a70.70bbb8"
            ]
        ]
    },
    {
        "id": "d21e3ef6.d533a",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 360,
        "wires": [
            [
                "7189aa7c.e53204"
            ]
        ]
    },
    {
        "id": "7189aa7c.e53204",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "Office Alexa",
        "rules": [
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "media_player.bedroom",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 360,
        "wires": [
            [
                "34f12c36.4e6ae4"
            ]
        ]
    },
    {
        "id": "92091263.aba56",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "Set vol",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "volume_set",
        "data": "{}",
        "mergecontext": "",
        "x": 930,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "38f95fb7.ba333",
        "type": "template",
        "z": "1f9e3480.5be75c",
        "name": "Format Floor Lamp Right State",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\n\"data\":\n    {\n        \"entity_id\" : \"media_player.bedroom\",\n        \"volume_level\": \"0.20\"\n    }\n}",
        "output": "json",
        "x": 530,
        "y": 460,
        "wires": [
            [
                "973b70d3.bdda1"
            ]
        ]
    },
    {
        "id": "c668dad9.6b1c18",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 460,
        "wires": [
            [
                "38f95fb7.ba333"
            ]
        ]
    },
    {
        "id": "973b70d3.bdda1",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "Set vol",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "volume_set",
        "data": "{\"entity_id\":\"matt\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 790,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "8dac45ba.71e228",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "Set 20%",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "volume_set",
        "data": "{\"entity_id\":\"media_player.bedroom\",\"volume_level\":\"0.20\"}",
        "mergecontext": "",
        "x": 600,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "f6a57dd8.6de63",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 220,
        "y": 320,
        "wires": [
            [
                "8dac45ba.71e228"
            ]
        ]
    },
    {
        "id": "2e171eab.0e1fc2",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 300,
        "y": 200,
        "wires": [
            [
                "de1dc5d2.7f3ee8"
            ]
        ]
    },
    {
        "id": "ed7b3a6b.a4ef58",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"media_player.bedroom\"}",
        "mergecontext": "",
        "x": 840,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "4518df0d.a41ba",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 210,
        "y": 660,
        "wires": [
            [
                "825f5454.f76ac8"
            ]
        ]
    },
    {
        "id": "825f5454.f76ac8",
        "type": "function",
        "z": "1f9e3480.5be75c",
        "name": "Data",
        "func": "msg.payload = { \"data\" : { \"message\":\"test\" } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 510,
        "y": 660,
        "wires": [
            [
                "ed7b3a6b.a4ef58",
                "10ca0df.86a63f2"
            ]
        ]
    },
    {
        "id": "38428bfe.d283b4",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"media_player.bedroom\",\"message\":\"test\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 880,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "1fc1ff4c.9939c1",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 520,
        "y": 1060,
        "wires": [
            [
                "38428bfe.d283b4"
            ]
        ]
    },
    {
        "id": "768e9aa2.a56d04",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "hello",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 860,
        "wires": [
            [
                "345154d3.e49bec",
                "cd8d0050.ddd2f"
            ]
        ]
    },
    {
        "id": "7c316de.10cbf94",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"media_player.bedroom\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 960,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "5a1e1a57.4d3ef4",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 860,
        "wires": [
            [
                "768e9aa2.a56d04"
            ]
        ]
    },
    {
        "id": "345154d3.e49bec",
        "type": "function",
        "z": "1f9e3480.5be75c",
        "name": "Data",
        "func": "msg.payload = { \"data\" : { \"message\": msg.payload } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 690,
        "y": 860,
        "wires": [
            [
                "7c316de.10cbf94",
                "e4d47da3.2e518"
            ]
        ]
    },
    {
        "id": "10ca0df.86a63f2",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 760,
        "y": 740,
        "wires": []
    },
    {
        "id": "e4d47da3.2e518",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 920,
        "y": 960,
        "wires": []
    },
    {
        "id": "cd8d0050.ddd2f",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 690,
        "y": 960,
        "wires": []
    },
    {
        "id": "6ba76e86.90686",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "love you",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 1180,
        "wires": [
            [
                "c5a87f6b.b1fb",
                "b77a59e9.4e7f28"
            ]
        ]
    },
    {
        "id": "ffce4eb3.c9188",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"{{payload.entity_id}}\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 940,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "8fddd837.d98638",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 1180,
        "wires": [
            [
                "6ba76e86.90686"
            ]
        ]
    },
    {
        "id": "c5a87f6b.b1fb",
        "type": "function",
        "z": "1f9e3480.5be75c",
        "name": "Data",
        "func": "msg.payload = { \"data\" : { \"message\": msg.payload, \"entity_id\": \"media_player.bedroom\" } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 1180,
        "wires": [
            [
                "ffce4eb3.c9188",
                "8650fb98.c4a298"
            ]
        ]
    },
    {
        "id": "8650fb98.c4a298",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 900,
        "y": 1280,
        "wires": []
    },
    {
        "id": "b77a59e9.4e7f28",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 670,
        "y": 1280,
        "wires": []
    },
    {
        "id": "76c30690.5cb578",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "Works",
        "info": "",
        "x": 170,
        "y": 760,
        "wires": []
    },
    {
        "id": "c57a7609.c118d8",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "Works",
        "info": "",
        "x": 210,
        "y": 960,
        "wires": []
    },
    {
        "id": "e12688a5.5e1d08",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "Works",
        "info": "",
        "x": 190,
        "y": 1280,
        "wires": []
    },
    {
        "id": "93e63b6f.e1c968",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 610,
        "y": 1400,
        "wires": []
    },
    {
        "id": "5021d846.7283b8",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "9854b95.7c0d448",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"{{payload.entity_id}}\"}",
        "mergecontext": "",
        "x": 920,
        "y": 1580,
        "wires": [
            []
        ]
    },
    {
        "id": "8e0b0daf.d15a4",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 160,
        "y": 1580,
        "wires": [
            [
                "8dbda0c1.7e531"
            ]
        ]
    },
    {
        "id": "aa63685c.307798",
        "type": "function",
        "z": "1f9e3480.5be75c",
        "name": "Data",
        "func": "msg.payload = { \"data\" : { \"message\": msg.say, \"entity_id\": \"media_player.bedroom\" } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 650,
        "y": 1580,
        "wires": [
            [
                "9854b95.7c0d448",
                "8547ff42.d9c95"
            ]
        ]
    },
    {
        "id": "8547ff42.d9c95",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 860,
        "y": 1680,
        "wires": []
    },
    {
        "id": "4abbb0cb.f3a51",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 630,
        "y": 1680,
        "wires": []
    },
    {
        "id": "2e3e3fc4.55f1",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "Works",
        "info": "",
        "x": 170,
        "y": 1680,
        "wires": []
    },
    {
        "id": "e6de8d04.cf81f",
        "type": "template",
        "z": "1f9e3480.5be75c",
        "name": "",
        "field": "say",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Hello there",
        "output": "str",
        "x": 380,
        "y": 1800,
        "wires": [
            [
                "ae8ac878.0b0e98"
            ]
        ]
    },
    {
        "id": "7388c377.5ca32c",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 130,
        "y": 1800,
        "wires": [
            [
                "e6de8d04.cf81f"
            ]
        ]
    },
    {
        "id": "ae8ac878.0b0e98",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 590,
        "y": 1800,
        "wires": []
    },
    {
        "id": "55bf0f12.25166",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 150,
        "y": 1880,
        "wires": [
            [
                "b9c01971.4fe2f8"
            ]
        ]
    },
    {
        "id": "54fbc760.47ff98",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 610,
        "y": 1880,
        "wires": []
    },
    {
        "id": "b9c01971.4fe2f8",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "custom",
                "pt": "msg",
                "to": "import",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 1880,
        "wires": [
            [
                "54fbc760.47ff98"
            ]
        ]
    },
    {
        "id": "8dbda0c1.7e531",
        "type": "template",
        "z": "1f9e3480.5be75c",
        "name": "",
        "field": "say",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Hello there",
        "output": "str",
        "x": 380,
        "y": 1580,
        "wires": [
            [
                "aa63685c.307798",
                "4abbb0cb.f3a51"
            ]
        ]
    },
    {
        "id": "91e2836.c76578",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 150,
        "y": 2060,
        "wires": [
            [
                "48cf8fc4.1d1d5"
            ]
        ]
    },
    {
        "id": "48cf8fc4.1d1d5",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 2060,
        "wires": [
            [
                "498b12ab.93bcac"
            ]
        ]
    },
    {
        "id": "c2c37fd1.f00b",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 148,
        "y": 2400,
        "wires": [
            [
                "52fcb4b.6d9df4c"
            ]
        ]
    },
    {
        "id": "52fcb4b.6d9df4c",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "media_player",
        "service": "play_media",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"spotify:playlist:Matt Awesomeness\",\"media_content_type\":\"SPOTIFY\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 488,
        "y": 2400,
        "wires": [
            []
        ]
    },
    {
        "id": "8a97349b.6d30a8",
        "type": "delay",
        "z": "1f9e3480.5be75c",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 760,
        "y": 2200,
        "wires": [
            [
                "96af5032.9920e"
            ]
        ]
    },
    {
        "id": "96af5032.9920e",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Warning - Unauthorised access detected, police are on route, live camera footage is now broadcasting",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 950,
        "y": 2200,
        "wires": [
            []
        ]
    },
    {
        "id": "498b12ab.93bcac",
        "type": "delay",
        "z": "1f9e3480.5be75c",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 600,
        "y": 2120,
        "wires": [
            [
                "6d4f455d.b0630c",
                "8a97349b.6d30a8"
            ]
        ]
    },
    {
        "id": "6d4f455d.b0630c",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Police notification complete",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 790,
        "y": 2120,
        "wires": [
            []
        ]
    },
    {
        "id": "6437b20a.d659fc",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Unauthorised access detected....",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 506,
        "wires": [
            [
                "6cee5fb.dff59a",
                "6a34c1de.08787",
                "d9df1088.5d408"
            ]
        ]
    },
    {
        "id": "91f48a4b.fab718",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Warning - Unauthorised access...",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Warning - Unauthorised access detected, police are on route, live camera footage is now broadcasting",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "all",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1460,
        "y": 620,
        "wires": [
            [
                "bc3ee15b.fdf2f"
            ]
        ]
    },
    {
        "id": "6cee5fb.dff59a",
        "type": "delay",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 980,
        "y": 580,
        "wires": [
            [
                "f7fc0936.ff5968",
                "c86c5f24.b123f"
            ]
        ]
    },
    {
        "id": "f7fc0936.ff5968",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Police notification complete",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Police notification complete",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1440,
        "y": 560,
        "wires": [
            [
                "bc3ee15b.fdf2f"
            ]
        ]
    },
    {
        "id": "f2f1fbdd.6f99a8",
        "type": "api-current-state",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm State",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "alarm_control_panel.home_alarm",
        "override_payload": true,
        "override_data": true,
        "x": 390,
        "y": 180,
        "wires": [
            [
                "ddc8f250.0fbf6"
            ]
        ]
    },
    {
        "id": "96f1c335.74979",
        "type": "switch",
        "z": "a0a4859f.5a2a48",
        "name": "Away Arm?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "armed_away",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 730,
        "y": 186,
        "wires": [
            [
                "379940a7.fafb9"
            ],
            [
                "6aaf5f6d.8996c"
            ]
        ]
    },
    {
        "id": "379940a7.fafb9",
        "type": "function",
        "z": "a0a4859f.5a2a48",
        "name": "Data",
        "func": "msg.payload = \n{\n  \"data\": \n  {\n    \"message\": msg.location,\n    \"data\": \n    {\n      \"push\": {\n            \"badge\": 5,\n            \"category\": \"alarm\"\n        },\"attachment\": \n      {\n        \"url\": msg.image,\n        \"content-type\": \"jpeg\",\n        \"hide-thumbnail\": false\n      }\n    }\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 950,
        "y": 186,
        "wires": [
            [
                "99c603ae.2957",
                "7825ad5c.712c84",
                "4766ddd2.ac3f44"
            ]
        ]
    },
    {
        "id": "297e3f11.045a3",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Motion Detected",
        "links": [
            "7f31a2c4.2e726c"
        ],
        "x": 1035,
        "y": 660,
        "wires": []
    },
    {
        "id": "7f31a2c4.2e726c",
        "type": "link in",
        "z": "a0a4859f.5a2a48",
        "name": "Trigger Alarm",
        "links": [
            "297e3f11.045a3"
        ],
        "x": 235,
        "y": 220,
        "wires": [
            [
                "f2f1fbdd.6f99a8"
            ]
        ]
    },
    {
        "id": "6635c661.8eab48",
        "type": "switch",
        "z": "a0a4859f.5a2a48",
        "name": "Disarmed?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "disarmed",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 390,
        "y": 846,
        "wires": [
            [
                "865758e5.35ac18",
                "ecc17d46.07f9f",
                "9bb7e742.fe6778"
            ]
        ]
    },
    {
        "id": "3c657c4b.85c364",
        "type": "server-state-changed",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm State Changes",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "alarm_control_panel.home_alarm",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 180,
        "y": 846,
        "wires": [
            [
                "6635c661.8eab48",
                "ada5b377.defe8"
            ]
        ]
    },
    {
        "id": "c86c5f24.b123f",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "",
        "op1type": "pay",
        "op2type": "pay",
        "duration": "-12",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1150,
        "y": 620,
        "wires": [
            [
                "91f48a4b.fab718"
            ]
        ]
    },
    {
        "id": "865758e5.35ac18",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm Disarmed",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 600,
        "y": 620,
        "wires": [
            [
                "c86c5f24.b123f",
                "6a34c1de.08787",
                "acec5703.4eb318",
                "99c603ae.2957",
                "ef97081d.287ae8",
                "7825ad5c.712c84"
            ]
        ]
    },
    {
        "id": "ecc17d46.07f9f",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm Disarmed",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Alarm Disarmed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 840,
        "y": 820,
        "wires": [
            [
                "1ff7fcd1.1bdbe3",
                "ea5b671b.6800a8"
            ]
        ]
    },
    {
        "id": "ada5b377.defe8",
        "type": "switch",
        "z": "a0a4859f.5a2a48",
        "name": "Arming?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "pending",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 400,
        "y": 1000,
        "wires": [
            [
                "2e706b9a.44a264",
                "5cbf4f55.ced48"
            ]
        ]
    },
    {
        "id": "88b513bf.db837",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm is arming",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Alarm is arming.. you have 25 seconds",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 940,
        "wires": [
            [
                "1ff7fcd1.1bdbe3"
            ]
        ]
    },
    {
        "id": "5f3ed30a.fb17ac",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm Armed",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Alarm is armed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1110,
        "y": 1080,
        "wires": [
            [
                "1ff7fcd1.1bdbe3"
            ]
        ]
    },
    {
        "id": "e1b8ad57.cdca",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "10 Seconds",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "10 Seconds",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1110,
        "y": 1020,
        "wires": [
            [
                "1ff7fcd1.1bdbe3"
            ]
        ]
    },
    {
        "id": "6a34c1de.08787",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "",
        "op1type": "pay",
        "op2type": "pay",
        "duration": "-1600",
        "extend": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1020,
        "y": 700,
        "wires": [
            [
                "445092e8.5863ac",
                "69c11c8f.e0f004"
            ]
        ]
    },
    {
        "id": "445092e8.5863ac",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"group.all_lights\",\"rgb_color\":[255,0,0],\"brightness_pct\":100,\"transition\":0}",
        "mergecontext": "",
        "x": 1270,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "69c11c8f.e0f004",
        "type": "delay",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "pauseType": "delay",
        "timeout": "800",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1250,
        "y": 700,
        "wires": [
            [
                "b9d838fa.304b58"
            ]
        ]
    },
    {
        "id": "acec5703.4eb318",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "1",
        "op2": "",
        "op1type": "str",
        "op2type": "nul",
        "duration": "15",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "Only Retrigger Once Every 15 Minute",
        "x": 930,
        "y": 340,
        "wires": [
            [
                "6437b20a.d659fc"
            ]
        ]
    },
    {
        "id": "b9d838fa.304b58",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"group.all_lights\",\"transition\":0}",
        "mergecontext": "",
        "x": 1470,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "72d4be48.c6af7",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Flash All Lights",
        "info": "",
        "x": 1000,
        "y": 660,
        "wires": []
    },
    {
        "id": "d9df1088.5d408",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 726,
        "wires": [
            [
                "82b8c853.e3ad78"
            ]
        ]
    },
    {
        "id": "82b8c853.e3ad78",
        "type": "delay",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 460,
        "y": 726,
        "wires": [
            [
                "6a34c1de.08787",
                "1c6435f7.2b5b4a"
            ]
        ]
    },
    {
        "id": "fc1c2aa.3cadfd8",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Diabled flashing lisghts after 5 minutes",
        "info": "",
        "x": 330,
        "y": 686,
        "wires": []
    },
    {
        "id": "4a0d618f.9e4e3",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 150,
        "y": 2560,
        "wires": [
            [
                "cd0f8311.b8f6"
            ]
        ]
    },
    {
        "id": "cd0f8311.b8f6",
        "type": "change",
        "z": "1f9e3480.5be75c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "hello",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 2560,
        "wires": [
            []
        ]
    },
    {
        "id": "758d40c5.72f3a",
        "type": "change",
        "z": "d1172b8b.3d3298",
        "name": "The door bell has been pressed The door bell has been pressed",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "The door bell has been pressed The door bell has been pressed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 220,
        "wires": [
            [
                "eabcdf61.a106d"
            ]
        ]
    },
    {
        "id": "ff31cac4.b7b148",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "3 minutes",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "I'll be turning everything off in 3 minutes",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2298,
        "y": 380,
        "wires": [
            [
                "747f847d.8cf0ec"
            ]
        ]
    },
    {
        "id": "5990015c.a324",
        "type": "switch",
        "z": "f92add19.c43b9",
        "name": "What is it?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "None",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Autonight - Wait 30 Minutes",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Autonight - Wait An Hour",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Autonight - Wait 3 Hour",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Bed Room - Night",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Living Room - Natural",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 350,
        "y": 460,
        "wires": [
            [],
            [
                "8322431a.be704"
            ],
            [
                "d89c7a04.840df8"
            ],
            [
                "5866fa08.5976e4"
            ],
            [],
            [
                "3a998864.180dc8"
            ]
        ]
    },
    {
        "id": "8322431a.be704",
        "type": "link out",
        "z": "f92add19.c43b9",
        "name": "Autonight - Wait 30 Minutes",
        "links": [
            "f7000620.ba0c58"
        ],
        "x": 515,
        "y": 220,
        "wires": []
    },
    {
        "id": "d89c7a04.840df8",
        "type": "link out",
        "z": "f92add19.c43b9",
        "name": "Autonight - Wait An Hour",
        "links": [
            "7534d7f.7558128"
        ],
        "x": 515,
        "y": 260,
        "wires": []
    },
    {
        "id": "5866fa08.5976e4",
        "type": "link out",
        "z": "f92add19.c43b9",
        "name": "Autonight - Wait 3 Hour",
        "links": [
            "e00bbec2.02f19"
        ],
        "x": 515,
        "y": 300,
        "wires": []
    },
    {
        "id": "e00bbec2.02f19",
        "type": "link in",
        "z": "d73100a9.0d64d",
        "name": "Rec - Autonight - Wait 3 Hour",
        "links": [
            "5866fa08.5976e4"
        ],
        "x": 241,
        "y": 792,
        "wires": [
            [
                "69a40cbb.df3674",
                "99df83ab.46e3b"
            ]
        ]
    },
    {
        "id": "7534d7f.7558128",
        "type": "link in",
        "z": "d73100a9.0d64d",
        "name": "Rec - Autonight - Wait An Hour",
        "links": [
            "d89c7a04.840df8"
        ],
        "x": 240,
        "y": 752,
        "wires": [
            [
                "be9e3159.3ea59",
                "99df83ab.46e3b"
            ]
        ]
    },
    {
        "id": "f7000620.ba0c58",
        "type": "link in",
        "z": "d73100a9.0d64d",
        "name": "Rec - Autonight - Wait 30 Minute",
        "links": [
            "8322431a.be704"
        ],
        "x": 240,
        "y": 712,
        "wires": [
            [
                "8a9e4a8c.294d28",
                "99df83ab.46e3b"
            ]
        ]
    },
    {
        "id": "a79f32af.f0649",
        "type": "api-call-service",
        "z": "f92add19.c43b9",
        "name": "Set to none",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_select",
        "service": "select_option",
        "data": "{\"entity_id\":\"input_select.set_scenes\",\"option\":\"None\"}",
        "mergecontext": "",
        "x": 350,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "cd0bc73b.5cabd8",
        "type": "switch",
        "z": "f92add19.c43b9",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "None",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 110,
        "y": 360,
        "wires": [
            [],
            [
                "a79f32af.f0649"
            ]
        ]
    },
    {
        "id": "c63b1959.997848",
        "type": "server-state-changed",
        "z": "f92add19.c43b9",
        "name": "On Change",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "input_select.set_scenes",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 110,
        "y": 460,
        "wires": [
            [
                "5990015c.a324",
                "cd0bc73b.5cabd8"
            ]
        ]
    },
    {
        "id": "3a998864.180dc8",
        "type": "api-call-service",
        "z": "f92add19.c43b9",
        "name": "Living Room - Natural",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"group.all_lights\",\"color_temp\":393,\"brightness_pct\":100,\"transition\":0}",
        "mergecontext": "",
        "x": 640,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "7de48d03.0ee034",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm is still active",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Alarm is still active... YOU HAVE 60 SECONDS... Alarm is still active",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1770,
        "y": 360,
        "wires": [
            [
                "e5e95e2e.4d267"
            ]
        ]
    },
    {
        "id": "99c603ae.2957",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "80",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "wait 60 seconds",
        "x": 820,
        "y": 280,
        "wires": [
            [
                "acec5703.4eb318"
            ]
        ]
    },
    {
        "id": "adc4fcb0.0b27d",
        "type": "server-events",
        "z": "a0a4859f.5a2a48",
        "name": "All",
        "server": "eef5a84.da24f58",
        "event_type": "",
        "x": 110,
        "y": 1580,
        "wires": [
            [
                "10e0084a.b4fab8"
            ]
        ]
    },
    {
        "id": "10e0084a.b4fab8",
        "type": "switch",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "property": "payload.event.actionName",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "SILENCE_ALARM",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "SOUND_ALARM",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 270,
        "y": 1580,
        "wires": [
            [
                "85e36c72.09a89"
            ],
            [
                "6437b20a.d659fc"
            ]
        ]
    },
    {
        "id": "85e36c72.09a89",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Disarm Alarm",
        "server": "5ee4d578.f7736c",
        "service_domain": "alarm_control_panel",
        "service": "alarm_disarm",
        "data": "{\"entity_id\":\"alarm_control_panel.home_alarm\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 480,
        "y": 1574,
        "wires": [
            []
        ]
    },
    {
        "id": "50c77ae0.374734",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Office Door Changed",
        "server": "5ee4d578.f7736c",
        "entityidfilter": " binary_sensor.office_door",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 140,
        "y": 1360,
        "wires": [
            [
                "5f4591ce.85447",
                "aa78949c.41c9a8"
            ]
        ]
    },
    {
        "id": "68e6824a.2d889c",
        "type": "comment",
        "z": "a068bd5.28a8d4",
        "name": "Office Door",
        "info": "",
        "x": 110,
        "y": 1320,
        "wires": []
    },
    {
        "id": "d1510a6c.f071b8",
        "type": "comment",
        "z": "a068bd5.28a8d4",
        "name": "Trun on Lving Room Light ",
        "info": "",
        "x": 690,
        "y": 1060,
        "wires": []
    },
    {
        "id": "5f4591ce.85447",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Office Door Open",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Office Door Open",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 993,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "6c7165c5.5f018c",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Font Door Open",
        "server": "5ee4d578.f7736c",
        "entityidfilter": " binary_sensor.font_door",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 120,
        "y": 891,
        "wires": [
            [
                "cc4f8d1.d9d097",
                "ae6cd96b.088a18"
            ]
        ]
    },
    {
        "id": "9c585f5f.3d0d4",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Font Door Open",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Font Door Open",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 893,
        "wires": [
            [
                "64a723bb.a421cc",
                "f6396294.e81f6",
                "f4e9b89.fd1c548"
            ]
        ]
    },
    {
        "id": "ef97081d.287ae8",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "name": "Send Once",
        "x": 1570,
        "y": 360,
        "wires": [
            [
                "7de48d03.0ee034"
            ]
        ]
    },
    {
        "id": "f6396294.e81f6",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "Open?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 850,
        "y": 838,
        "wires": [
            [
                "227f7678.7fa0aa",
                "cc2fcdb8.ee0ea",
                "19935555.b95fab"
            ],
            [
                "82e7bf66.f63d3"
            ]
        ],
        "outputLabels": [
            "Yes",
            null
        ]
    },
    {
        "id": "227f7678.7fa0aa",
        "type": "api-current-state",
        "z": "a068bd5.28a8d4",
        "name": "",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "binary_sensor.hallway_motion_sensor",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1180,
        "y": 840,
        "wires": [
            [
                "f767de46.4bd93"
            ]
        ]
    },
    {
        "id": "f767de46.4bd93",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "Is Dark?",
        "property": "data.attributes.dark",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1480,
        "y": 840,
        "wires": [
            [
                "f214d51b.258148",
                "259dae36.504b82",
                "f052224f.c6133"
            ]
        ]
    },
    {
        "id": "f214d51b.258148",
        "type": "api-call-service",
        "z": "a068bd5.28a8d4",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.hallway_light\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1750,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "259dae36.504b82",
        "type": "api-call-service",
        "z": "a068bd5.28a8d4",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.living_room_lights\",\"rgb_color\":[255,213,170],\"brightness_pct\":\"70\",\"transition\":\"10\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1750,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "f052224f.c6133",
        "type": "trigger",
        "z": "a068bd5.28a8d4",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "8",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1730,
        "y": 960,
        "wires": [
            [
                "1e5a6c60.ce90f4"
            ]
        ]
    },
    {
        "id": "9e478c97.728cd",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "Triggered?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1150,
        "y": 958,
        "wires": [
            [
                "afeb8d84.4c3d5"
            ]
        ]
    },
    {
        "id": "afeb8d84.4c3d5",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1440,
        "y": 960,
        "wires": [
            [
                "f052224f.c6133"
            ]
        ]
    },
    {
        "id": "1e5a6c60.ce90f4",
        "type": "api-call-service",
        "z": "a068bd5.28a8d4",
        "name": "Turn Off Light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.living_room_lights\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1940,
        "y": 758,
        "wires": [
            []
        ]
    },
    {
        "id": "a7e0ed6.c09071",
        "type": "comment",
        "z": "a068bd5.28a8d4",
        "name": "Todo - disable if camera is offline",
        "info": "",
        "x": 1670,
        "y": 1060,
        "wires": []
    },
    {
        "id": "cc2fcdb8.ee0ea",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Font Door Open",
        "links": [
            "ccedfcf.8e988",
            "ab6d64fd.ed48b8",
            "564fc868.c06818"
        ],
        "x": 1095,
        "y": 918,
        "wires": []
    },
    {
        "id": "ccedfcf.8e988",
        "type": "link in",
        "z": "dceb45d8.425368",
        "name": "",
        "links": [
            "cc2fcdb8.ee0ea"
        ],
        "x": 75,
        "y": 100,
        "wires": [
            [
                "912e1c7f.de2ae"
            ]
        ]
    },
    {
        "id": "ce93041d.165928",
        "type": "light-scheduler",
        "z": "dceb45d8.425368",
        "settings": "525afe76.43e05",
        "events": "[{\"start\":{\"dow\":1,\"mod\":705},\"end\":{\"dow\":1,\"mod\":900}},{\"start\":{\"dow\":2,\"mod\":705},\"end\":{\"dow\":2,\"mod\":900}},{\"start\":{\"dow\":3,\"mod\":705},\"end\":{\"dow\":3,\"mod\":900}},{\"start\":{\"dow\":4,\"mod\":705},\"end\":{\"dow\":4,\"mod\":900}},{\"start\":{\"dow\":5,\"mod\":705},\"end\":{\"dow\":5,\"mod\":900}},{\"start\":{\"dow\":3,\"mod\":660},\"end\":{\"dow\":3,\"mod\":705}},{\"start\":{\"dow\":4,\"mod\":660},\"end\":{\"dow\":4,\"mod\":705}},{\"start\":{\"dow\":5,\"mod\":660},\"end\":{\"dow\":5,\"mod\":705}},{\"start\":{\"dow\":2,\"mod\":600},\"end\":{\"dow\":2,\"mod\":705}},{\"start\":{\"dow\":1,\"mod\":600},\"end\":{\"dow\":1,\"mod\":705}},{\"start\":{\"dow\":3,\"mod\":600},\"end\":{\"dow\":3,\"mod\":660}},{\"start\":{\"dow\":4,\"mod\":600},\"end\":{\"dow\":4,\"mod\":660}},{\"start\":{\"dow\":5,\"mod\":600},\"end\":{\"dow\":5,\"mod\":660}}]",
        "topic": "",
        "name": "Lunch Time",
        "onPayload": "On",
        "onPayloadType": "str",
        "offPayload": "Off",
        "offPayloadType": "str",
        "onlyWhenDark": false,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "outputfreq": "output.statechange.startup",
        "x": 130,
        "y": 40,
        "wires": [
            [
                "d0306c25.0b7d6"
            ]
        ]
    },
    {
        "id": "d0306c25.0b7d6",
        "type": "change",
        "z": "dceb45d8.425368",
        "name": "SET LunchTime Var",
        "rules": [
            {
                "t": "set",
                "p": "LunchTime",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "LunchTimeBeenTrigged",
                "pt": "global",
                "to": "off",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "bb795d4b.f8fac",
        "type": "switch",
        "z": "dceb45d8.425368",
        "name": "Is Lunch Time?",
        "property": "LunchTime",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "On",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 900,
        "y": 100,
        "wires": [
            [
                "653873b9.0eb50c",
                "15e0bafe.3d9b75",
                "a68116a7.421e68",
                "4bc559fe.71cd38",
                "d6eda8a.8082c58"
            ]
        ]
    },
    {
        "id": "15e0bafe.3d9b75",
        "type": "change",
        "z": "dceb45d8.425368",
        "name": "Have a good lunch",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Have a good lunch. Timer set",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "LunchTime.BeenTrigged",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 100,
        "wires": [
            [
                "bb3f35b4.b93fa8"
            ]
        ]
    },
    {
        "id": "912e1c7f.de2ae",
        "type": "delay",
        "z": "dceb45d8.425368",
        "name": "",
        "pauseType": "rate",
        "timeout": "20",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "2",
        "rateUnits": "hour",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 380,
        "y": 100,
        "wires": [
            [
                "22eeb88e.7e8268"
            ]
        ]
    },
    {
        "id": "f6271c50.692e3",
        "type": "change",
        "z": "dceb45d8.425368",
        "name": "You been home for 50 minutes",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "You been home for 50 minutes... almost time for you to go back",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 160,
        "wires": [
            [
                "bb3f35b4.b93fa8"
            ]
        ]
    },
    {
        "id": "653873b9.0eb50c",
        "type": "delay",
        "z": "dceb45d8.425368",
        "name": "",
        "pauseType": "delay",
        "timeout": "50",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1110,
        "y": 160,
        "wires": [
            [
                "f6271c50.692e3",
                "b8fb1826.2cb798"
            ]
        ]
    },
    {
        "id": "c10515b6.577c78",
        "type": "change",
        "z": "dceb45d8.425368",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 160,
        "wires": [
            [
                "653873b9.0eb50c",
                "4bc559fe.71cd38"
            ]
        ]
    },
    {
        "id": "741edf94.e15ec",
        "type": "change",
        "z": "dceb45d8.425368",
        "name": "You been home for an hour",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "You been home for an hour - got back to work",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 260,
        "wires": [
            [
                "bb3f35b4.b93fa8"
            ]
        ]
    },
    {
        "id": "4bc559fe.71cd38",
        "type": "delay",
        "z": "dceb45d8.425368",
        "name": "",
        "pauseType": "delay",
        "timeout": "60",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1110,
        "y": 260,
        "wires": [
            [
                "741edf94.e15ec",
                "9a499cf3.62e0b"
            ]
        ]
    },
    {
        "id": "b3c666ee.88c4a8",
        "type": "function",
        "z": "cd950567.f864b8",
        "name": "Data",
        "func": "msg.payloadvalue = msg.payload\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"is Matt here: \" + msg.payload\n  }\n}\n\nif (0 < msg.payloadvalue && msg.payloadvalue < 100) {\n    msg.goodpayload = true \n} else {\n    msg.goodpayload = false\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 240,
        "wires": [
            [
                "d1dbd941.ea1448"
            ]
        ]
    },
    {
        "id": "4d976d7c.19f594",
        "type": "server-state-changed",
        "z": "cd950567.f864b8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "entityidfilter": "sensor.matt_living_room",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "num",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 240,
        "y": 240,
        "wires": [
            [
                "b3c666ee.88c4a8",
                "57c6dcb1.08eb84"
            ]
        ]
    },
    {
        "id": "3c08ccb.8006134",
        "type": "function",
        "z": "cd950567.f864b8",
        "name": "Data",
        "func": "msg.payloadvalue = msg.payload\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"is Danni here: \" + msg.payload\n  }\n}\n\nif (0 < msg.payloadvalue && msg.payloadvalue < 100) {\n    msg.goodpayload = true \n} else {\n    msg.goodpayload = false\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 320,
        "wires": [
            [
                "d1dbd941.ea1448"
            ]
        ]
    },
    {
        "id": "3e1e5c2e.53cbe4",
        "type": "server-state-changed",
        "z": "cd950567.f864b8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "entityidfilter": "sensor.danni_living_room",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "num",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 240,
        "y": 320,
        "wires": [
            [
                "3c08ccb.8006134",
                "57c6dcb1.08eb84"
            ]
        ]
    },
    {
        "id": "3939d20a.94fe3e",
        "type": "mqtt out",
        "z": "cd950567.f864b8",
        "name": "Scan For Who Left",
        "topic": "btmonitor/scan/DEPART",
        "qos": "0",
        "retain": "false",
        "broker": "1b6bc4ba.56ff4b",
        "x": 830,
        "y": 580,
        "wires": []
    },
    {
        "id": "55bdf0a5.df3c4",
        "type": "trigger",
        "z": "cd950567.f864b8",
        "op1": "",
        "op2": "",
        "op1type": "pay",
        "op2type": "pay",
        "duration": "-15",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 570,
        "y": 580,
        "wires": [
            [
                "3939d20a.94fe3e"
            ]
        ]
    },
    {
        "id": "60eb60ce.fc86c",
        "type": "inject",
        "z": "cd950567.f864b8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 580,
        "y": 660,
        "wires": [
            [
                "3939d20a.94fe3e"
            ]
        ]
    },
    {
        "id": "82e7bf66.f63d3",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Font Door Close",
        "links": [
            "3f687ec7.49a272",
            "3d0ad1be.cff38e",
            "81fd62da.1a92e",
            "ba0cbec6.deb3e"
        ],
        "x": 975,
        "y": 1000,
        "wires": []
    },
    {
        "id": "3d0ad1be.cff38e",
        "type": "link in",
        "z": "cd950567.f864b8",
        "name": "",
        "links": [
            "82e7bf66.f63d3"
        ],
        "x": 95,
        "y": 540,
        "wires": [
            [
                "a4fe4e36.81ffd",
                "ab08cc66.4d35a"
            ]
        ]
    },
    {
        "id": "a4fe4e36.81ffd",
        "type": "trigger",
        "z": "cd950567.f864b8",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "10",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 270,
        "y": 580,
        "wires": [
            [
                "55bdf0a5.df3c4"
            ]
        ]
    },
    {
        "id": "ab08cc66.4d35a",
        "type": "trigger",
        "z": "cd950567.f864b8",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "5",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 270,
        "y": 480,
        "wires": [
            [
                "57c6dcb1.08eb84"
            ]
        ]
    },
    {
        "id": "57c6dcb1.08eb84",
        "type": "change",
        "z": "cd950567.f864b8",
        "name": "Disable Rescan",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 480,
        "wires": [
            [
                "55bdf0a5.df3c4",
                "a4fe4e36.81ffd"
            ]
        ]
    },
    {
        "id": "89f71aea.e8f178",
        "type": "comment",
        "z": "cd950567.f864b8",
        "name": "Blue Tooth Tracker",
        "info": "",
        "x": 170,
        "y": 200,
        "wires": []
    },
    {
        "id": "6827bf6c.c4045",
        "type": "comment",
        "z": "cd950567.f864b8",
        "name": "Font Door Closed",
        "info": "",
        "x": 160,
        "y": 420,
        "wires": []
    },
    {
        "id": "a631dd8.5d2e22",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Font Door Open For More 20 Minutes",
        "info": "",
        "x": 210,
        "y": 360,
        "wires": []
    },
    {
        "id": "564fc868.c06818",
        "type": "link in",
        "z": "48ba348c.61270c",
        "name": "Door Open",
        "links": [
            "cc2fcdb8.ee0ea"
        ],
        "x": 75,
        "y": 420,
        "wires": [
            [
                "88571fc3.58e4c"
            ]
        ]
    },
    {
        "id": "3f687ec7.49a272",
        "type": "link in",
        "z": "48ba348c.61270c",
        "name": "Door Closed",
        "links": [
            "82e7bf66.f63d3"
        ],
        "x": 75,
        "y": 480,
        "wires": [
            [
                "6ecdefb4.76dc2"
            ]
        ]
    },
    {
        "id": "88571fc3.58e4c",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "20",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 410,
        "y": 420,
        "wires": [
            [
                "da0bfd7.66d92"
            ]
        ]
    },
    {
        "id": "6ecdefb4.76dc2",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Clear",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 480,
        "wires": [
            [
                "88571fc3.58e4c"
            ]
        ]
    },
    {
        "id": "da0bfd7.66d92",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Font Door Open for More Then 20 Minutes",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Font Door Sensor",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart office node mcu. Note open the office door",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 420,
        "wires": [
            [
                "82cfabc3.c2c478"
            ]
        ]
    },
    {
        "id": "82cfabc3.c2c478",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 875,
        "y": 420,
        "wires": []
    },
    {
        "id": "c6717092.75d4b",
        "type": "link in",
        "z": "48ba348c.61270c",
        "name": "",
        "links": [
            "82cfabc3.c2c478",
            "20b5a1d8.a650fe",
            "a1cec523.a181e8",
            "f7cb7ddf.cc703",
            "48a7f807.8583d8",
            "a6165491.aa9ba8",
            "b32e27f7.8449f8",
            "f6daaed4.01e24",
            "ab9413e4.3c106",
            "3a06d91d.c9d8a6",
            "51f52cc1.b9deb4",
            "748d8b68.2ac2f4",
            "856f0f59.ec59e",
            "e81c2f88.73a11",
            "6d9e86a4.e66318",
            "38b94500.07dd2c"
        ],
        "x": 75,
        "y": 240,
        "wires": [
            [
                "347552a6.bfcbce"
            ]
        ]
    },
    {
        "id": "a0fe31c8.e093b",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "info": "",
        "x": 140,
        "y": 200,
        "wires": []
    },
    {
        "id": "347552a6.bfcbce",
        "type": "function",
        "z": "48ba348c.61270c",
        "name": "Bulid Message",
        "func": "msg = {\n   \n   to:\"matbrewer396@gmail.com\",\n   topic: \"Fault Detected - \" + msg.fault.name,\n   payload: \"Item: \"  + msg.fault.item + \"\\nAction To Fix: \" + msg.fault.actiontofix \n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 280,
        "y": 240,
        "wires": [
            [
                "275e27be.7bb5e8"
            ]
        ]
    },
    {
        "id": "a0436269.f0533",
        "type": "e-mail",
        "z": "a0cc6149.1f76e",
        "server": "smtp.gmail.com",
        "port": "465",
        "secure": true,
        "name": "matbrewer396@gmail.com",
        "dname": "Send email",
        "x": 270,
        "y": 40,
        "wires": []
    },
    {
        "id": "ca7402bc.ba7c8",
        "type": "subflow:a0cc6149.1f76e",
        "z": "48ba348c.61270c",
        "name": "",
        "x": 750,
        "y": 240,
        "wires": []
    },
    {
        "id": "bc4d59ad.37cb48",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 500,
        "y": 500,
        "wires": [
            [
                "da0bfd7.66d92"
            ]
        ]
    },
    {
        "id": "8ee737f2.2dc868",
        "type": "function",
        "z": "f5eab19a.7cf17",
        "name": "Bulid Message",
        "func": "msg = {\n   \n   to:\"matbrewer396@gmail.com\",\n   topic: \"Error Handler - \" + msg.error.message,\n   payload: \"Error Message: \"  + msg.error.message + \"\\nStack: \" + msg.error.stack + \"\\nmsg: \" + JSON.stringify(msg)\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 600,
        "y": 180,
        "wires": [
            [
                "605540a6.9e19d"
            ]
        ]
    },
    {
        "id": "605540a6.9e19d",
        "type": "subflow:a0cc6149.1f76e",
        "z": "f5eab19a.7cf17",
        "name": "",
        "x": 850,
        "y": 180,
        "wires": []
    },
    {
        "id": "6a988d08.ea81a4",
        "type": "catch",
        "z": "48ba348c.61270c",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "c600d799.d43db8"
            ]
        ]
    },
    {
        "id": "c600d799.d43db8",
        "type": "subflow:f5eab19a.7cf17",
        "z": "48ba348c.61270c",
        "name": "",
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "b13f59.51b620a8",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "33d0326a.f58f6e",
        "type": "catch",
        "z": "dceb45d8.425368",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 400,
        "wires": [
            [
                "18b03c93.6dde53"
            ]
        ]
    },
    {
        "id": "18b03c93.6dde53",
        "type": "subflow:f5eab19a.7cf17",
        "z": "dceb45d8.425368",
        "name": "",
        "x": 350,
        "y": 400,
        "wires": []
    },
    {
        "id": "dbb967e1.d73fe8",
        "type": "comment",
        "z": "dceb45d8.425368",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 360,
        "wires": []
    },
    {
        "id": "75add89.a073b28",
        "type": "catch",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "scope": null,
        "x": 140,
        "y": 80,
        "wires": [
            [
                "dea2d204.a3696"
            ]
        ]
    },
    {
        "id": "dea2d204.a3696",
        "type": "subflow:f5eab19a.7cf17",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "x": 370,
        "y": 80,
        "wires": []
    },
    {
        "id": "7d109bd.4b04e64",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Error Handler",
        "info": "",
        "x": 150,
        "y": 40,
        "wires": []
    },
    {
        "id": "ae08baef.481318",
        "type": "catch",
        "z": "cd950567.f864b8",
        "name": "",
        "scope": null,
        "x": 140,
        "y": 80,
        "wires": [
            [
                "fd8af2a8.a89f8"
            ]
        ]
    },
    {
        "id": "fd8af2a8.a89f8",
        "type": "subflow:f5eab19a.7cf17",
        "z": "cd950567.f864b8",
        "name": "",
        "env": [],
        "x": 370,
        "y": 80,
        "wires": []
    },
    {
        "id": "ccfe093f.2bd2f8",
        "type": "comment",
        "z": "cd950567.f864b8",
        "name": "Error Handler",
        "info": "",
        "x": 150,
        "y": 40,
        "wires": []
    },
    {
        "id": "12c91848.692d98",
        "type": "catch",
        "z": "f92add19.c43b9",
        "name": "",
        "scope": null,
        "x": 100,
        "y": 80,
        "wires": [
            [
                "57855714.0ccd88"
            ]
        ]
    },
    {
        "id": "57855714.0ccd88",
        "type": "subflow:f5eab19a.7cf17",
        "z": "f92add19.c43b9",
        "name": "",
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "285eecda.fca384",
        "type": "comment",
        "z": "f92add19.c43b9",
        "name": "Error Handler",
        "info": "",
        "x": 110,
        "y": 40,
        "wires": []
    },
    {
        "id": "53afba59.94cd24",
        "type": "catch",
        "z": "a068bd5.28a8d4",
        "name": "",
        "scope": null,
        "x": 100,
        "y": 80,
        "wires": [
            [
                "1e9a78cb.b78cc7"
            ]
        ]
    },
    {
        "id": "1e9a78cb.b78cc7",
        "type": "subflow:f5eab19a.7cf17",
        "z": "a068bd5.28a8d4",
        "name": "",
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "c269451e.f6d8d8",
        "type": "comment",
        "z": "a068bd5.28a8d4",
        "name": "Error Handler",
        "info": "",
        "x": 110,
        "y": 40,
        "wires": []
    },
    {
        "id": "b2e2aedc.7117d",
        "type": "catch",
        "z": "d73100a9.0d64d",
        "name": "",
        "scope": null,
        "x": 100,
        "y": 80,
        "wires": [
            [
                "1982b0d2.f9443f"
            ]
        ]
    },
    {
        "id": "1982b0d2.f9443f",
        "type": "subflow:f5eab19a.7cf17",
        "z": "d73100a9.0d64d",
        "name": "",
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "68a1ed88.1aaa84",
        "type": "comment",
        "z": "d73100a9.0d64d",
        "name": "Error Handler",
        "info": "",
        "x": 110,
        "y": 40,
        "wires": []
    },
    {
        "id": "242a2aaa.ee74b6",
        "type": "catch",
        "z": "b8a16318.b66a5",
        "name": "",
        "scope": [
            "db6f141.f0d81e8",
            "e4ae5383.2ab6e",
            "91a25b55.043368"
        ],
        "x": 70,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "de155525.5f5328",
        "type": "subflow:f5eab19a.7cf17",
        "z": "b8a16318.b66a5",
        "name": "",
        "x": 310,
        "y": 80,
        "wires": []
    },
    {
        "id": "86a0baf9.b8cff8",
        "type": "comment",
        "z": "b8a16318.b66a5",
        "name": "Error Handler",
        "info": "",
        "x": 90,
        "y": 40,
        "wires": []
    },
    {
        "id": "c0de7131.1686b",
        "type": "catch",
        "z": "a3158433.9d1f78",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "879f1d84.3c4b6"
            ]
        ]
    },
    {
        "id": "879f1d84.3c4b6",
        "type": "subflow:f5eab19a.7cf17",
        "z": "a3158433.9d1f78",
        "name": "",
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "a5b767c6.469a78",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "545ec4ed.99005c",
        "type": "catch",
        "z": "99d64a3d.f4e418",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 120,
        "wires": [
            [
                "f420f60b.9e3a88"
            ]
        ]
    },
    {
        "id": "f420f60b.9e3a88",
        "type": "subflow:f5eab19a.7cf17",
        "z": "99d64a3d.f4e418",
        "name": "",
        "x": 350,
        "y": 120,
        "wires": []
    },
    {
        "id": "30d4c722.2476b8",
        "type": "comment",
        "z": "99d64a3d.f4e418",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 80,
        "wires": []
    },
    {
        "id": "80401489.e84f88",
        "type": "catch",
        "z": "d1172b8b.3d3298",
        "name": "",
        "scope": null,
        "x": 100,
        "y": 80,
        "wires": [
            [
                "5ce21bd9.903e14"
            ]
        ]
    },
    {
        "id": "5ce21bd9.903e14",
        "type": "subflow:f5eab19a.7cf17",
        "z": "d1172b8b.3d3298",
        "name": "",
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "fcc53040.d1dd7",
        "type": "comment",
        "z": "d1172b8b.3d3298",
        "name": "Error Handler",
        "info": "",
        "x": 110,
        "y": 40,
        "wires": []
    },
    {
        "id": "4d7db1db.68172",
        "type": "catch",
        "z": "1e454935.091dd7",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "33052106.48eb7e"
            ]
        ]
    },
    {
        "id": "33052106.48eb7e",
        "type": "subflow:f5eab19a.7cf17",
        "z": "1e454935.091dd7",
        "name": "",
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "6d8cc228.7b4ecc",
        "type": "comment",
        "z": "1e454935.091dd7",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "2cf95ee5.b42bd2",
        "type": "catch",
        "z": "9a341993.fbc528",
        "name": "",
        "scope": null,
        "x": 100,
        "y": 80,
        "wires": [
            [
                "63def445.f2b16c"
            ]
        ]
    },
    {
        "id": "63def445.f2b16c",
        "type": "subflow:f5eab19a.7cf17",
        "z": "9a341993.fbc528",
        "name": "",
        "env": [],
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "86e81af9.0b95d8",
        "type": "comment",
        "z": "9a341993.fbc528",
        "name": "Error Handler",
        "info": "",
        "x": 110,
        "y": 40,
        "wires": []
    },
    {
        "id": "35126fda.6e6b4",
        "type": "debug",
        "z": "f5eab19a.7cf17",
        "name": "Error Handler",
        "active": true,
        "tosidebar": true,
        "console": true,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 220,
        "y": 180,
        "wires": []
    },
    {
        "id": "19935555.b95fab",
        "type": "mqtt out",
        "z": "a068bd5.28a8d4",
        "name": "Scan For Who Arrive",
        "topic": "btmonitor/scan/ARRIVE",
        "qos": "0",
        "retain": "false",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1160,
        "y": 880,
        "wires": []
    },
    {
        "id": "c0dff3d8.fcde3",
        "type": "server-state-changed",
        "z": "a3158433.9d1f78",
        "name": "Matt Home / Away",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "sensor.matt_living_room",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 150,
        "y": 220,
        "wires": [
            [
                "db76988.e552268"
            ]
        ]
    },
    {
        "id": "e5299478.e59328",
        "type": "server-state-changed",
        "z": "a3158433.9d1f78",
        "name": "Danni Home / Away",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "sensor.danni_living_room",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 150,
        "y": 260,
        "wires": [
            [
                "85dea4f7.0782b8"
            ]
        ]
    },
    {
        "id": "2b671e1d.f76fd2",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Is Any One Home - Life 360",
        "info": "",
        "x": 180,
        "y": 400,
        "wires": []
    },
    {
        "id": "db76988.e552268",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "Greater then 10?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "10",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 370,
        "y": 220,
        "wires": [
            [
                "81818922.360f98",
                "52956d68.af7aa4"
            ],
            [
                "bea24dc.62f6cb",
                "7ba936d7.0aba18"
            ]
        ],
        "outputLabels": [
            "Yes",
            "No"
        ]
    },
    {
        "id": "a963880c.9251f8",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "10",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1430,
        "y": 320,
        "wires": [
            [
                "209f26a6.4bd9ba"
            ]
        ]
    },
    {
        "id": "41325690.252b68",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Confirm Via 360",
        "info": "",
        "x": 1060,
        "y": 280,
        "wires": []
    },
    {
        "id": "aea97881.44ab78",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Disarm Alarm",
        "server": "5ee4d578.f7736c",
        "service_domain": "alarm_control_panel",
        "service": "alarm_disarm",
        "data": "{\"entity_id\":\"alarm_control_panel.home_alarm\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 240,
        "y": 912,
        "wires": [
            []
        ]
    },
    {
        "id": "34d4aee9.cd2842",
        "type": "api-current-state",
        "z": "a3158433.9d1f78",
        "name": "Alarm State",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "alarm_control_panel.home_alarm",
        "override_payload": true,
        "override_data": true,
        "x": 1050,
        "y": 320,
        "wires": [
            [
                "46fd8d3a.619004"
            ]
        ]
    },
    {
        "id": "46fd8d3a.619004",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "Away Arm?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "armed_away",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1235,
        "y": 320,
        "wires": [
            [
                "a963880c.9251f8"
            ]
        ]
    },
    {
        "id": "209f26a6.4bd9ba",
        "type": "api-current-state",
        "z": "a3158433.9d1f78",
        "name": "Current State Is Any One Home?",
        "server": "eef5a84.da24f58",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "input_boolean.isanyonehome",
        "override_payload": true,
        "override_data": true,
        "x": 1701,
        "y": 320,
        "wires": [
            [
                "b6af2fa1.e4bed"
            ]
        ]
    },
    {
        "id": "b6af2fa1.e4bed",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "360 Confirms",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1975,
        "y": 320,
        "wires": [
            [],
            [
                "c95bfc57.f496a",
                "c869da06.29c528"
            ]
        ]
    },
    {
        "id": "e14e20ef.1b779",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Active Alarm",
        "server": "5ee4d578.f7736c",
        "service_domain": "alarm_control_panel",
        "service": "alarm_arm_away",
        "data": "{\"entity_id\":\"alarm_control_panel.home_alarm\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 2458,
        "y": 328,
        "wires": [
            []
        ]
    },
    {
        "id": "3cb54a9.5114fb6",
        "type": "link out",
        "z": "a3158433.9d1f78",
        "name": "",
        "links": [],
        "x": 2403,
        "y": 368,
        "wires": []
    },
    {
        "id": "c95bfc57.f496a",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "20",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "Wait 20 Seconds",
        "x": 2238,
        "y": 328,
        "wires": [
            [
                "e14e20ef.1b779",
                "3cb54a9.5114fb6"
            ]
        ]
    },
    {
        "id": "c869da06.29c528",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "Alarm is still active",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Life 360 failed to comfirm GPS... Activing alarm",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2236,
        "y": 288,
        "wires": [
            []
        ]
    },
    {
        "id": "844ae5a1.9d66b8",
        "type": "api-call-service",
        "z": "940805f6.65fb98",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone_iphone10smax",
        "data": "{\"entity_id\":\"matt\",\"message\":\"Go back to work!\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 480,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "5ebe7a8d.2ffe14",
        "type": "inject",
        "z": "940805f6.65fb98",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 260,
        "y": 160,
        "wires": [
            [
                "844ae5a1.9d66b8"
            ]
        ]
    },
    {
        "id": "1251ab92.3861f4",
        "type": "catch",
        "z": "940805f6.65fb98",
        "name": "",
        "scope": null,
        "x": 220,
        "y": 80,
        "wires": [
            [
                "5adb5e2d.0e772"
            ]
        ]
    },
    {
        "id": "5adb5e2d.0e772",
        "type": "subflow:f5eab19a.7cf17",
        "z": "940805f6.65fb98",
        "name": "",
        "x": 450,
        "y": 80,
        "wires": []
    },
    {
        "id": "cb727108.25cf6",
        "type": "comment",
        "z": "940805f6.65fb98",
        "name": "Error Handler",
        "info": "",
        "x": 230,
        "y": 40,
        "wires": []
    },
    {
        "id": "91a25b55.043368",
        "type": "api-call-service",
        "z": "b8a16318.b66a5",
        "name": "trigger",
        "server": "5ee4d578.f7736c",
        "service_domain": "hassio",
        "service": "snapshot_full",
        "data": "",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 710,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "ada41b1a.6921a8",
        "type": "comment",
        "z": "b8a16318.b66a5",
        "name": "Watch Dog",
        "info": "",
        "x": 80,
        "y": 140,
        "wires": []
    },
    {
        "id": "39c59c56.fad0d4",
        "type": "comment",
        "z": "b8a16318.b66a5",
        "name": "Backup",
        "info": "",
        "x": 70,
        "y": 320,
        "wires": []
    },
    {
        "id": "db6f141.f0d81e8",
        "type": "light-scheduler",
        "z": "b8a16318.b66a5",
        "settings": "525afe76.43e05",
        "events": "[{\"start\":{\"dow\":2,\"mod\":240},\"end\":{\"dow\":2,\"mod\":255}},{\"start\":{\"dow\":3,\"mod\":240},\"end\":{\"dow\":3,\"mod\":255}},{\"start\":{\"dow\":4,\"mod\":240},\"end\":{\"dow\":4,\"mod\":255}},{\"start\":{\"dow\":5,\"mod\":240},\"end\":{\"dow\":5,\"mod\":255}},{\"start\":{\"dow\":6,\"mod\":240},\"end\":{\"dow\":6,\"mod\":255}},{\"start\":{\"dow\":0,\"mod\":240},\"end\":{\"dow\":0,\"mod\":255}},{\"start\":{\"dow\":1,\"mod\":240},\"end\":{\"dow\":1,\"mod\":255}}]",
        "topic": "",
        "name": "4am",
        "onPayload": "true",
        "onPayloadType": "bool",
        "offPayload": "false",
        "offPayloadType": "bool",
        "onlyWhenDark": true,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "outputfreq": "output.statechange",
        "x": 70,
        "y": 380,
        "wires": [
            [
                "92457156.7ed4e"
            ]
        ]
    },
    {
        "id": "e4ae5383.2ab6e",
        "type": "switch",
        "z": "b8a16318.b66a5",
        "name": "Only On",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 440,
        "y": 380,
        "wires": [
            [
                "91a25b55.043368"
            ]
        ]
    },
    {
        "id": "908042fb.5ade1",
        "type": "inject",
        "z": "b8a16318.b66a5",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 100,
        "y": 440,
        "wires": [
            [
                "91a25b55.043368"
            ]
        ]
    },
    {
        "id": "4ad3a3ca.e993fc",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Office Light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"light.office_light\" }",
        "mergecontext": "",
        "x": 230,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "adc7b89a.d6d8a8",
        "type": "comment",
        "z": "c9b308f8.01ef68",
        "name": "Lights",
        "info": "",
        "x": 210,
        "y": 40,
        "wires": []
    },
    {
        "id": "d87f007e.fe521",
        "type": "comment",
        "z": "c9b308f8.01ef68",
        "name": "Switches",
        "info": "",
        "x": 480,
        "y": 40,
        "wires": []
    },
    {
        "id": "eafdd93e.9fb888",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Office LightStrip",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"light.office_light_rgb\" }",
        "mergecontext": "",
        "x": 240,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "13188644.21746a",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Living Room Light 1",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"light.living_room_light_1\" }",
        "mergecontext": "",
        "x": 260,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "81018cf2.485d6",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Living Room Light 2",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"light.living_room_light_2\" }",
        "mergecontext": "",
        "x": 260,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "d0cfbc85.dd2e7",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Living Room Light 3",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"light.living_room_light_3\" }",
        "mergecontext": "",
        "x": 260,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "11925681.a709e9",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Bed Room Light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"light.bed_room_light\" }",
        "mergecontext": "",
        "x": 240,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "96315aaf.436ea8",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Library Plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.plug_06\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 490,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "df1fe7a6.c64e78",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Living Room Plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.plug_03\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 510,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "bc86c7f4.0d9708",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Dryer",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.51268403dc4f2233b115\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 470,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "2971d7cd.f71318",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Reset Request",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_boolean",
        "service": "turn_off",
        "data": "{\"entity_id\":\"input_boolean.goodnight\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 900,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "ddfafa57.793b48",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Turn off PC",
        "server": "eef5a84.da24f58",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.mattpc\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 490,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "18474d73.df01f3",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Turn off TV",
        "server": "eef5a84.da24f58",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"switch.tv\" }",
        "mergecontext": "",
        "x": 710,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "5a47e076.9bd83",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Confirm Trigger",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_boolean",
        "service": "turn_on",
        "data": "{\"entity_id\":\"input_boolean.goodnight_beentriggered\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 900,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "4cc8dc8e.5daea4",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Library 1",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hue_white_lamp_1\"}",
        "mergecontext": "",
        "x": 220,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "9c8404e9.34ba08",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Library 2",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hue_white_lamp_2\"}",
        "mergecontext": "",
        "x": 220,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "6f951353.3c766c",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "BedRoom Availability",
        "info": "",
        "x": 160,
        "y": 580,
        "wires": []
    },
    {
        "id": "bbc4a0fd.013b2",
        "type": "mqtt in",
        "z": "48ba348c.61270c",
        "name": "",
        "topic": "checkIn/bedroomMCU",
        "qos": "2",
        "broker": "1b6bc4ba.56ff4b",
        "x": 160,
        "y": 620,
        "wires": [
            [
                "ba0f14ff.fbf9f8",
                "246c516.4b14bae"
            ]
        ]
    },
    {
        "id": "ba0f14ff.fbf9f8",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "4",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 430,
        "y": 600,
        "wires": [
            [
                "c7b3c2cc.794f6",
                "ddf2b558.0a23f8",
                "18bb5523.688fcb"
            ]
        ]
    },
    {
        "id": "c7b3c2cc.794f6",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/bedroomMCU",
        "topic": "availability/bedroomMCU",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 770,
        "y": 660,
        "wires": []
    },
    {
        "id": "246c516.4b14bae",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bedroom",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 640,
        "wires": [
            [
                "c7b3c2cc.794f6"
            ]
        ]
    },
    {
        "id": "be55b0fe.1cdef",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Bedroom Node MCU - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 980,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "d0b308ee.2b6718",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Office Availability",
        "info": "",
        "x": 140,
        "y": 740,
        "wires": []
    },
    {
        "id": "ce89f0f5.323d5",
        "type": "mqtt in",
        "z": "48ba348c.61270c",
        "name": "",
        "topic": "checkIn/OfficeMCU",
        "qos": "2",
        "broker": "1b6bc4ba.56ff4b",
        "x": 150,
        "y": 780,
        "wires": [
            [
                "17046a13.6635d6",
                "2478e925.50b0a6"
            ]
        ]
    },
    {
        "id": "17046a13.6635d6",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "8",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 430,
        "y": 760,
        "wires": [
            [
                "a1464cf1.f62f5",
                "c8b5465c.584e48",
                "a8227300.13432"
            ]
        ]
    },
    {
        "id": "a1464cf1.f62f5",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/OfficeMCU",
        "topic": "availability/OfficeMCU",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 760,
        "y": 820,
        "wires": []
    },
    {
        "id": "2478e925.50b0a6",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.office",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 800,
        "wires": [
            [
                "a1464cf1.f62f5"
            ]
        ]
    },
    {
        "id": "cad6c4a0.0570e8",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Office Node MCU - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 960,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "42ae3ca6.5e2724",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "DoorBell Availability",
        "info": "",
        "x": 150,
        "y": 880,
        "wires": []
    },
    {
        "id": "c92cc768.f09d78",
        "type": "mqtt in",
        "z": "48ba348c.61270c",
        "name": "",
        "topic": "checkIn/doorbellMCU",
        "qos": "2",
        "broker": "1b6bc4ba.56ff4b",
        "x": 160,
        "y": 920,
        "wires": [
            [
                "ea63a6c3.d7ce48",
                "12fd2314.e17cad"
            ]
        ]
    },
    {
        "id": "ea63a6c3.d7ce48",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "8",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 430,
        "y": 900,
        "wires": [
            [
                "7164f4a4.e5a42c",
                "b0bc999f.9ff708",
                "21d9c69d.9f8e7a"
            ]
        ]
    },
    {
        "id": "7164f4a4.e5a42c",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/doorbellMCU",
        "topic": "availability/doorbellMCU",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 770,
        "y": 960,
        "wires": []
    },
    {
        "id": "12fd2314.e17cad",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.doorbell",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 940,
        "wires": [
            [
                "7164f4a4.e5a42c"
            ]
        ]
    },
    {
        "id": "ac6c25a0.3f1b98",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"BeNode MCU - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 960,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "ddf2b558.0a23f8",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Bedroom Node MCU has not checked in",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Bedroom Node MCU",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart bedroom node mcu",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bedroom",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 580,
        "wires": [
            [
                "20b5a1d8.a650fe"
            ]
        ]
    },
    {
        "id": "20b5a1d8.a650fe",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 935,
        "y": 580,
        "wires": []
    },
    {
        "id": "c8b5465c.584e48",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Bedroom Node MCU has not checked in",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Bedroom Node MCU",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart office node mcu. Note open the office door",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.office",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 740,
        "wires": [
            [
                "a1cec523.a181e8"
            ]
        ]
    },
    {
        "id": "a1cec523.a181e8",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 935,
        "y": 740,
        "wires": []
    },
    {
        "id": "b0bc999f.9ff708",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Door Beel Node MCU has not checked in",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Doorbell Node MCU",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart doorbell node mcu",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.doorbell",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 880,
        "wires": [
            [
                "f7cb7ddf.cc703"
            ]
        ]
    },
    {
        "id": "f7cb7ddf.cc703",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 935,
        "y": 880,
        "wires": []
    },
    {
        "id": "2ddc2933.91dc56",
        "type": "debug",
        "z": "1e454935.091dd7",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 310,
        "y": 140,
        "wires": []
    },
    {
        "id": "9567c19f.3fa0b",
        "type": "subflow:c9b308f8.01ef68",
        "z": "1e454935.091dd7",
        "name": "",
        "env": [],
        "x": 460,
        "y": 180,
        "wires": []
    },
    {
        "id": "9bdbae6b.e8281",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Bedroom Window Changed",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "binary_sensor.bedroom_window",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 160,
        "y": 340,
        "wires": [
            [
                "53670de2.10b724"
            ]
        ]
    },
    {
        "id": "53670de2.10b724",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Bedroom Window",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Bedroom Window",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 340,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "7323ca0e.ee9ac4",
        "type": "comment",
        "z": "d73100a9.0d64d",
        "name": "",
        "info": "",
        "x": 0,
        "y": 0,
        "wires": []
    },
    {
        "id": "9876b938.b17e98",
        "type": "comment",
        "z": "d73100a9.0d64d",
        "name": "Wait for us to both be in bed",
        "info": "",
        "x": 1560,
        "y": 240,
        "wires": []
    },
    {
        "id": "a2ee88e7.636588",
        "type": "alexa-home",
        "z": "1f9e3480.5be75c",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51092",
        "acknoledge": true,
        "name": "Lights",
        "topic": "",
        "x": 190,
        "y": 3020,
        "wires": [
            [
                "ad70c306.9adcd",
                "415a0565.3a3dac"
            ]
        ]
    },
    {
        "id": "ad70c306.9adcd",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 550,
        "y": 3020,
        "wires": []
    },
    {
        "id": "bb3f35b4.b93fa8",
        "type": "subflow:47bc2d66.1132e4",
        "z": "dceb45d8.425368",
        "name": "",
        "env": [],
        "x": 1800,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "bc3ee15b.fdf2f",
        "type": "subflow:47bc2d66.1132e4",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "x": 1710,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "1ff7fcd1.1bdbe3",
        "type": "subflow:47bc2d66.1132e4",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "x": 1350,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "eabcdf61.a106d",
        "type": "subflow:47bc2d66.1132e4",
        "z": "d1172b8b.3d3298",
        "name": "",
        "x": 1270,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "415a0565.3a3dac",
        "type": "api-render-template",
        "z": "1f9e3480.5be75c",
        "name": "last alexa",
        "server": "5ee4d578.f7736c",
        "template": "{%- for entity in states.media_player -%}\n    {%- if state_attr(entity.entity_id, 'last_called') == True -%}\n      {{ entity.entity_id }}\n    {%- endif -%}\n{%- endfor -%}",
        "x": 440,
        "y": 3080,
        "wires": [
            [
                "56203d03.1384b4"
            ]
        ]
    },
    {
        "id": "56203d03.1384b4",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 670,
        "y": 3080,
        "wires": []
    },
    {
        "id": "20a92ac4.9495e6",
        "type": "alexa-home",
        "z": "80866e71.966c6",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51159",
        "acknoledge": true,
        "name": "Living Room Lights",
        "topic": "",
        "x": 150,
        "y": 160,
        "wires": [
            [
                "666e0981.f04888"
            ]
        ]
    },
    {
        "id": "666e0981.f04888",
        "type": "change",
        "z": "80866e71.966c6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "light",
                "pt": "msg",
                "to": "light.living_room_lights",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 160,
        "wires": [
            [
                "91ab16e5.33d3e8"
            ]
        ]
    },
    {
        "id": "681f52a2.6e388c",
        "type": "function",
        "z": "20dffe5a.37e8a2",
        "name": "",
        "func": "light = msg.light\ncommad = \"turn_on\"\nif (msg.command == \"TurnOffRequest\") {\n    commad = \"turn_off\"\n}\n\nif (msg.command == \"SetPercentageRequest\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : commad,\n     \"data\" : \n        { \n            \"entity_id\" : light,\n            \"brightness_pct\": msg.payload\n        } \n    }\n} else  if (msg.command == \"SetColorRequest\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : commad,\n     \"data\" : \n        { \n            \"entity_id\" : light,\n            \"hs_color\": [msg.payload.hue,80 ]\n        } \n    }\n\n\n} else {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : commad,\n     \"data\" : \n        { \n            \"entity_id\" : light\n        } \n    }\n}\n\n    \n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 270,
        "y": 40,
        "wires": [
            [
                "a14e6e3.6e53b9"
            ]
        ],
        "outputLabels": [
            "On"
        ]
    },
    {
        "id": "a14e6e3.6e53b9",
        "type": "api-call-service",
        "z": "20dffe5a.37e8a2",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "",
        "service": "",
        "data": "",
        "mergecontext": "",
        "x": 530,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "91ab16e5.33d3e8",
        "type": "subflow:20dffe5a.37e8a2",
        "z": "80866e71.966c6",
        "name": "",
        "x": 600,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "5b59c84c.9553a8",
        "type": "alexa-home",
        "z": "80866e71.966c6",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51160",
        "acknoledge": true,
        "name": "Bedroom Light",
        "topic": "",
        "x": 140,
        "y": 220,
        "wires": [
            [
                "980377c2.231538"
            ]
        ]
    },
    {
        "id": "980377c2.231538",
        "type": "change",
        "z": "80866e71.966c6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "light",
                "pt": "msg",
                "to": "light.bed_room_light",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 220,
        "wires": [
            [
                "b7f733d5.5494"
            ]
        ]
    },
    {
        "id": "b7f733d5.5494",
        "type": "subflow:20dffe5a.37e8a2",
        "z": "80866e71.966c6",
        "name": "",
        "x": 600,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "b7351a9a.445f48",
        "type": "alexa-home",
        "z": "80866e71.966c6",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51162",
        "acknoledge": true,
        "name": "Library Lights",
        "topic": "",
        "x": 130,
        "y": 280,
        "wires": [
            [
                "ccb7686f.ae6c38"
            ]
        ]
    },
    {
        "id": "ccb7686f.ae6c38",
        "type": "change",
        "z": "80866e71.966c6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "light",
                "pt": "msg",
                "to": "light.library_lights",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 280,
        "wires": [
            [
                "1cbdb8cf.6331d7"
            ]
        ]
    },
    {
        "id": "1cbdb8cf.6331d7",
        "type": "subflow:20dffe5a.37e8a2",
        "z": "80866e71.966c6",
        "name": "",
        "x": 600,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "dec4310e.4d01c",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Bluetooth Tracker Availability",
        "info": "",
        "x": 180,
        "y": 1060,
        "wires": []
    },
    {
        "id": "1fdc6496.317dbb",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "20",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 710,
        "y": 1080,
        "wires": [
            [
                "96e20405.870f58",
                "80752034.8088",
                "38de4a13.9e07c6",
                "644d8797.711c28"
            ]
        ]
    },
    {
        "id": "96e20405.870f58",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/bluetoothtracker",
        "topic": "availability/bluetoothtracker",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1060,
        "y": 1140,
        "wires": []
    },
    {
        "id": "51c0fbb2.abfe34",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1120,
        "wires": [
            [
                "96e20405.870f58"
            ]
        ]
    },
    {
        "id": "cbb5e819.633268",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Bluetooth Tracker - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1260,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "80752034.8088",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Can not ping bluetooth tracker",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Bluetooth Tracker Pi Zero",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart Bluetooth Tracker Pi Zero",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 1060,
        "wires": [
            [
                "48a7f807.8583d8"
            ]
        ]
    },
    {
        "id": "48a7f807.8583d8",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 1215,
        "y": 1060,
        "wires": []
    },
    {
        "id": "b8badc29.ed561",
        "type": "ping",
        "z": "48ba348c.61270c",
        "name": "Check BT On Every 2 Minutes",
        "host": "192.168.1.205",
        "timer": "120",
        "x": 180,
        "y": 1120,
        "wires": [
            [
                "124b807c.ce19b"
            ]
        ]
    },
    {
        "id": "124b807c.ce19b",
        "type": "switch",
        "z": "48ba348c.61270c",
        "name": "Is offline?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 440,
        "y": 1120,
        "wires": [
            [],
            [
                "51c0fbb2.abfe34",
                "1fdc6496.317dbb"
            ]
        ]
    },
    {
        "id": "2c5e4896.5acbd8",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "RM Mini Availability",
        "info": "",
        "x": 150,
        "y": 1240,
        "wires": []
    },
    {
        "id": "a9b99e17.0b437",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "8",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 710,
        "y": 1260,
        "wires": [
            [
                "a5e82cce.9e94c",
                "d8742850.a3fb68",
                "8d22476.bf1ffb8"
            ]
        ]
    },
    {
        "id": "899c25f0.69a088",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1300,
        "wires": [
            [
                "8d22476.bf1ffb8"
            ]
        ]
    },
    {
        "id": "4b56562a.e13668",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"RM min - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1240,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "a5e82cce.9e94c",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Can not ping RM Mimi",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "RM Mimi",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Check RM Mini network connection / power supply ",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 1240,
        "wires": [
            [
                "a6165491.aa9ba8"
            ]
        ]
    },
    {
        "id": "a6165491.aa9ba8",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 1215,
        "y": 1240,
        "wires": []
    },
    {
        "id": "40fb610.df8f4a",
        "type": "ping",
        "z": "48ba348c.61270c",
        "name": "Check RM Mini On Every 2 Minutes",
        "host": "192.168.1.202",
        "timer": "120",
        "x": 200,
        "y": 1300,
        "wires": [
            [
                "24f7770e.b891b8"
            ]
        ]
    },
    {
        "id": "24f7770e.b891b8",
        "type": "switch",
        "z": "48ba348c.61270c",
        "name": "Is offline?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 440,
        "y": 1300,
        "wires": [
            [],
            [
                "899c25f0.69a088",
                "a9b99e17.0b437"
            ]
        ]
    },
    {
        "id": "f1f04b2f.da4be8",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Living Room Cam Availability",
        "info": "",
        "x": 180,
        "y": 1380,
        "wires": []
    },
    {
        "id": "a4255651.6b2fa8",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "4",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 710,
        "y": 1400,
        "wires": [
            [
                "7777aa85.124f64",
                "e9c109a5.b4ce18"
            ]
        ]
    },
    {
        "id": "af146bf.3df0b98",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1440,
        "wires": [
            [
                "141d4bb.57eb4b4"
            ]
        ]
    },
    {
        "id": "3fc21522.ece32a",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Living Room Cam - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1240,
        "y": 1420,
        "wires": [
            []
        ]
    },
    {
        "id": "7777aa85.124f64",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Can not ping Living Room Cam",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Living Room Cam",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Check Living Room Cam network connection / power supply ",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 1380,
        "wires": [
            [
                "b32e27f7.8449f8"
            ]
        ]
    },
    {
        "id": "b32e27f7.8449f8",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 1215,
        "y": 1380,
        "wires": []
    },
    {
        "id": "bea7e8f6.3d6718",
        "type": "ping",
        "z": "48ba348c.61270c",
        "name": "Check Living Room Cam On Every 2 Minutes",
        "host": "192.168.1.203",
        "timer": "5",
        "x": 230,
        "y": 1440,
        "wires": [
            [
                "8ea47506.ccd558"
            ]
        ]
    },
    {
        "id": "8ea47506.ccd558",
        "type": "switch",
        "z": "48ba348c.61270c",
        "name": "Is offline?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 500,
        "y": 1440,
        "wires": [
            [],
            [
                "af146bf.3df0b98",
                "a4255651.6b2fa8"
            ]
        ]
    },
    {
        "id": "6d2e1465.714b2c",
        "type": "inject",
        "z": "b8a16318.b66a5",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 240,
        "y": 140,
        "wires": [
            [
                "b8da62bc.cac9f"
            ]
        ]
    },
    {
        "id": "98aa72cd.d6907",
        "type": "mqtt in",
        "z": "940805f6.65fb98",
        "name": "Incomming Message",
        "topic": "debug/cmd",
        "qos": "2",
        "broker": "1b6bc4ba.56ff4b",
        "x": 230,
        "y": 320,
        "wires": [
            [
                "ca16acb4.e3947"
            ]
        ]
    },
    {
        "id": "c153add7.75976",
        "type": "mqtt out",
        "z": "940805f6.65fb98",
        "name": "Send Message",
        "topic": "debug/cmd",
        "qos": "",
        "retain": "",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1940,
        "y": 320,
        "wires": []
    },
    {
        "id": "ca16acb4.e3947",
        "type": "switch",
        "z": "940805f6.65fb98",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "_.*",
                "vt": "str",
                "case": false
            },
            {
                "t": "eq",
                "v": "Start",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 460,
        "y": 320,
        "wires": [
            [],
            [
                "7276d065.72cba",
                "c92e60a1.f4408"
            ],
            []
        ]
    },
    {
        "id": "7276d065.72cba",
        "type": "change",
        "z": "940805f6.65fb98",
        "name": "Starting",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "_Starting",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 320,
        "wires": [
            [
                "c153add7.75976"
            ]
        ]
    },
    {
        "id": "44d37400.9af96c",
        "type": "switch",
        "z": "940805f6.65fb98",
        "name": "",
        "property": "devicecheckin.bedroom",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 400,
        "wires": [
            [
                "30bc6f2.183e99"
            ],
            [
                "ffbefee1.a753b"
            ]
        ]
    },
    {
        "id": "c92e60a1.f4408",
        "type": "delay",
        "z": "940805f6.65fb98",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 644,
        "y": 400,
        "wires": [
            [
                "4c2e800a.57398",
                "fde5f2e1.df06b",
                "54481ce7.202ae4"
            ]
        ]
    },
    {
        "id": "30bc6f2.183e99",
        "type": "function",
        "z": "940805f6.65fb98",
        "name": "Pass",
        "func": "msg.payload = \"_PASSED: \" + msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1730,
        "y": 420,
        "wires": [
            [
                "c153add7.75976"
            ]
        ]
    },
    {
        "id": "ffbefee1.a753b",
        "type": "function",
        "z": "940805f6.65fb98",
        "name": "Fail",
        "func": "msg.payload = \"_FAILED: \" + msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1730,
        "y": 480,
        "wires": [
            [
                "c153add7.75976"
            ]
        ]
    },
    {
        "id": "4c2e800a.57398",
        "type": "change",
        "z": "940805f6.65fb98",
        "name": "Bedroom MCU",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Bedroom MCU",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 400,
        "wires": [
            [
                "44d37400.9af96c"
            ]
        ]
    },
    {
        "id": "fde5f2e1.df06b",
        "type": "change",
        "z": "940805f6.65fb98",
        "name": "Office MCU",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Office MCU",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 440,
        "wires": [
            [
                "d2bf8513.ffe618"
            ]
        ]
    },
    {
        "id": "54481ce7.202ae4",
        "type": "change",
        "z": "940805f6.65fb98",
        "name": "Door Bell MCU",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Door Bell MCU",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 480,
        "wires": [
            [
                "fc2ce462.291488"
            ]
        ]
    },
    {
        "id": "d2bf8513.ffe618",
        "type": "switch",
        "z": "940805f6.65fb98",
        "name": "",
        "property": "devicecheckin.office",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 440,
        "wires": [
            [
                "30bc6f2.183e99"
            ],
            [
                "ffbefee1.a753b"
            ]
        ]
    },
    {
        "id": "fc2ce462.291488",
        "type": "switch",
        "z": "940805f6.65fb98",
        "name": "",
        "property": "devicecheckin.doorbell",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 480,
        "wires": [
            [
                "30bc6f2.183e99"
            ],
            [
                "ffbefee1.a753b"
            ]
        ]
    },
    {
        "id": "a68116a7.421e68",
        "type": "api-call-service",
        "z": "dceb45d8.425368",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Have a good lunch. Timer set\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1320,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "85dabb98.674a08",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Actvice Alarm",
        "server": "5ee4d578.f7736c",
        "service_domain": "alarm_control_panel",
        "service": "alarm_arm_away",
        "data": "{\"entity_id\":\"alarm_control_panel.home_alarm\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1080,
        "y": 1260,
        "wires": [
            []
        ]
    },
    {
        "id": "606db896.9f2128",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "40",
        "extend": false,
        "units": "s",
        "reset": "some_one_home",
        "bytopic": "all",
        "name": "",
        "x": 850,
        "y": 1260,
        "wires": [
            [
                "85dabb98.674a08",
                "86692ab8.010d38",
                "404814cc.c2c46c",
                "f6c97631.876a78",
                "72c8674b.8e3c38"
            ]
        ]
    },
    {
        "id": "103364c9.218bfb",
        "type": "link in",
        "z": "a0a4859f.5a2a48",
        "name": "Arming Alarm",
        "links": [
            "b0c86ed5.ad287"
        ],
        "x": 435,
        "y": 1034,
        "wires": [
            [
                "2e706b9a.44a264"
            ]
        ]
    },
    {
        "id": "2e706b9a.44a264",
        "type": "function",
        "z": "a0a4859f.5a2a48",
        "name": "Join",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 690,
        "y": 1000,
        "wires": [
            [
                "88b513bf.db837",
                "6b2ad87a.0e91f8",
                "87cfb997.596a08"
            ]
        ]
    },
    {
        "id": "b0c86ed5.ad287",
        "type": "link out",
        "z": "a3158433.9d1f78",
        "name": "",
        "links": [
            "103364c9.218bfb"
        ],
        "x": 415,
        "y": 1260,
        "wires": []
    },
    {
        "id": "9a499cf3.62e0b",
        "type": "api-call-service",
        "z": "dceb45d8.425368",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Lunch is over\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1320,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "b8fb1826.2cb798",
        "type": "api-call-service",
        "z": "dceb45d8.425368",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Its been 50 minutes\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1320,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "22eeb88e.7e8268",
        "type": "switch",
        "z": "dceb45d8.425368",
        "name": "Has been triggered?",
        "property": "LunchTimeBeenTrigged",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 620,
        "y": 100,
        "wires": [
            [],
            [
                "bb795d4b.f8fac"
            ]
        ]
    },
    {
        "id": "6125c1be.4d871",
        "type": "change",
        "z": "99d64a3d.f4e418",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "LunchTime.BeenTrigged",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 860,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "92457156.7ed4e",
        "type": "rbe",
        "z": "b8a16318.b66a5",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 260,
        "y": 380,
        "wires": [
            [
                "e4ae5383.2ab6e"
            ]
        ]
    },
    {
        "id": "4c78e362.ee846c",
        "type": "inject",
        "z": "dceb45d8.425368",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 1060,
        "y": 60,
        "wires": [
            [
                "a68116a7.421e68"
            ]
        ]
    },
    {
        "id": "75f52e86.a7882",
        "type": "inject",
        "z": "940805f6.65fb98",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 880,
        "y": 80,
        "wires": [
            [
                "c6085f5d.88cde",
                "fc7e4e44.13255",
                "14e7d3ea.9f72ec"
            ]
        ]
    },
    {
        "id": "c6085f5d.88cde",
        "type": "api-call-service",
        "z": "940805f6.65fb98",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Test\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1140,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "fc7e4e44.13255",
        "type": "api-call-service",
        "z": "940805f6.65fb98",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "ios_iphone_10smax",
        "data": "{\"entity_id\":\"matt\",\"message\":\"TEst\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1160,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "2c90b7d5.a716f8",
        "type": "api-call-service",
        "z": "940805f6.65fb98",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "ios_iphone_10smax",
        "data": "{\"entity_id\":\"matt\",\"message\":\"TEst\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1140,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "14e7d3ea.9f72ec",
        "type": "api-call-service",
        "z": "940805f6.65fb98",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone_iphone10smax",
        "data": "{\"message\":\"Have a good lunch. Timer set\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1160,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "9a49fe8e.6bfee",
        "type": "trigger",
        "z": "a0cdc0f9.a362b",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "45",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 770,
        "y": 940,
        "wires": [
            [
                "52c7bf3f.bee33",
                "9d9f388a.1c7c88"
            ]
        ]
    },
    {
        "id": "e9f4888d.6daf78",
        "type": "server-state-changed",
        "z": "a0cdc0f9.a362b",
        "name": "Bath Time",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "input_boolean.bathtime",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 160,
        "y": 1080,
        "wires": [
            [
                "bc8fc4c1.1f1378"
            ]
        ]
    },
    {
        "id": "bc8fc4c1.1f1378",
        "type": "switch",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 370,
        "y": 1080,
        "wires": [
            [
                "9a49fe8e.6bfee"
            ],
            [
                "8b85e6e3.f5e478",
                "9d078a72.d4b5a8"
            ]
        ]
    },
    {
        "id": "8b85e6e3.f5e478",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Turn Off Bathroom light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\" light.bathroom_light\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1390,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "52c7bf3f.bee33",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Turn Off Bath Time",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_boolean",
        "service": "turn_off",
        "data": "{\"entity_id\":\"input_boolean.bathtime\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 970,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "9d9f388a.1c7c88",
        "type": "trigger",
        "z": "a0cdc0f9.a362b",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "10",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1050,
        "y": 940,
        "wires": [
            [
                "8b85e6e3.f5e478"
            ]
        ]
    },
    {
        "id": "a4d35f77.97058",
        "type": "catch",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "8079fb7e.7d99e8"
            ]
        ]
    },
    {
        "id": "8079fb7e.7d99e8",
        "type": "subflow:f5eab19a.7cf17",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "9c1e7371.cd6ba",
        "type": "comment",
        "z": "a0cdc0f9.a362b",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "90fde8f7.a26cb8",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Bathroom Motion Detected",
        "links": [
            "4fe3f102.783b3"
        ],
        "x": 355,
        "y": 600,
        "wires": []
    },
    {
        "id": "4fe3f102.783b3",
        "type": "link in",
        "z": "a0cdc0f9.a362b",
        "name": "Turn On Light",
        "links": [
            "6f485fb3.adf71",
            "90fde8f7.a26cb8",
            "d320a708.e46708"
        ],
        "x": 175,
        "y": 580,
        "wires": [
            [
                "43f0cbfb.ff1114"
            ]
        ]
    },
    {
        "id": "9edcd817.aed998",
        "type": "switch",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 450,
        "y": 580,
        "wires": [
            [
                "dfbfea55.092c18"
            ],
            [
                "a43cb31c.bbb2a",
                "1df00caa.c88d63",
                "807b6968.6ef5c8"
            ]
        ]
    },
    {
        "id": "95a4dd4.cece52",
        "type": "trigger",
        "z": "a0cdc0f9.a362b",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "40",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "Assume Failure After 40 Minutes",
        "x": 1610,
        "y": 440,
        "wires": [
            [
                "44b62be6.846c34"
            ]
        ]
    },
    {
        "id": "a43cb31c.bbb2a",
        "type": "change",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 520,
        "wires": [
            [
                "95a4dd4.cece52"
            ]
        ]
    },
    {
        "id": "bc7a046f.08cac8",
        "type": "trigger",
        "z": "a0cdc0f9.a362b",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "5",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 910,
        "y": 580,
        "wires": [
            [
                "35d5239.16e63dc"
            ]
        ]
    },
    {
        "id": "1df00caa.c88d63",
        "type": "change",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 480,
        "wires": [
            [
                "bc7a046f.08cac8",
                "4a2e8ced.86f9d4"
            ]
        ]
    },
    {
        "id": "43f0cbfb.ff1114",
        "type": "rbe",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 290,
        "y": 580,
        "wires": [
            [
                "9edcd817.aed998"
            ]
        ]
    },
    {
        "id": "63f156bc.aed608",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Dim Lights",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.bathroom_light\",\"brightness_pct\":25,\"transition\":0}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 3310,
        "y": 380,
        "wires": [
            [
                "4a2e8ced.86f9d4"
            ]
        ]
    },
    {
        "id": "4a2e8ced.86f9d4",
        "type": "trigger",
        "z": "a0cdc0f9.a362b",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "20",
        "extend": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 3570,
        "y": 540,
        "wires": [
            [
                "7cd2befd.6212",
                "a43cb31c.bbb2a"
            ]
        ]
    },
    {
        "id": "7cd2befd.6212",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Turn off Lights",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.bathroom_light\",\"transition\":15}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 3820,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "35d5239.16e63dc",
        "type": "api-current-state",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "input_boolean.bathtime",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1210,
        "y": 580,
        "wires": [
            [
                "5c8e616a.83de2"
            ]
        ]
    },
    {
        "id": "5c8e616a.83de2",
        "type": "switch",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1450,
        "y": 580,
        "wires": [
            [],
            [
                "44b62be6.846c34"
            ]
        ]
    },
    {
        "id": "72d8e323.abf5dc",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Dim Lights",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.bathroom_light\",\"brightness_pct\":10}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 1610,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "78facd5e.ed58b4",
        "type": "time-range-switch",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "lat": "",
        "lon": "",
        "startTime": "06:45",
        "endTime": "22:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1390,
        "y": 360,
        "wires": [
            [
                "221d531d.195e8c"
            ],
            [
                "72d8e323.abf5dc"
            ]
        ],
        "outputLabels": [
            "trur",
            "false"
        ]
    },
    {
        "id": "8b43d993.76bf28",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Full Lights",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.bathroom_light\",\"brightness_pct\":100}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 1810,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "9d078a72.d4b5a8",
        "type": "change",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 940,
        "wires": [
            [
                "9a49fe8e.6bfee",
                "a43cb31c.bbb2a"
            ]
        ]
    },
    {
        "id": "70e711fa.a2035",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Living Room Motion",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "binary_sensor.living_room_pir",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 130,
        "y": 280,
        "wires": [
            [
                "46820b01.32dab4",
                "224d137d.2e20dc"
            ]
        ]
    },
    {
        "id": "46820b01.32dab4",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Living Room Motion (PIR)",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Living Room Motion (PIR)",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 280,
        "wires": [
            [
                "64a723bb.a421cc",
                "9e478c97.728cd"
            ]
        ]
    },
    {
        "id": "224d137d.2e20dc",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Living Room Motion (PIR)",
        "links": [
            "8f80ab0d.e271b8"
        ],
        "x": 355,
        "y": 240,
        "wires": []
    },
    {
        "id": "8f80ab0d.e271b8",
        "type": "link in",
        "z": "a068bd5.28a8d4",
        "name": "Living Room Motion (PIR) - Action",
        "links": [
            "224d137d.2e20dc",
            "3495a219.f840be",
            "f8efe1fe.a4a0e"
        ],
        "x": 75,
        "y": 1980,
        "wires": [
            [
                "d5e198ac.4ec488"
            ]
        ]
    },
    {
        "id": "8ca88ef0.2dcb",
        "type": "time-range-switch",
        "z": "a068bd5.28a8d4",
        "name": "",
        "lat": "",
        "lon": "",
        "startTime": "03:00",
        "endTime": "08:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1010,
        "y": 1900,
        "wires": [
            [
                "f05be72e.898218",
                "e8c03186.98b5e"
            ],
            []
        ]
    },
    {
        "id": "e04902ac.5849e",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Hallway Motion",
        "links": [
            "c215726b.e66d5",
            "a2f7cd26.7ec92",
            "c3e890f4.9c742"
        ],
        "x": 355,
        "y": 440,
        "wires": []
    },
    {
        "id": "c215726b.e66d5",
        "type": "link in",
        "z": "a068bd5.28a8d4",
        "name": "Hallway Motion - Action",
        "links": [
            "e04902ac.5849e"
        ],
        "x": 75,
        "y": 1920,
        "wires": [
            [
                "4b47eaf4.4a6da4"
            ]
        ]
    },
    {
        "id": "f05be72e.898218",
        "type": "api-call-service",
        "z": "a068bd5.28a8d4",
        "name": "Turn on living room lights",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.living_room_lights\",\"brightness_pct\":100}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 1328,
        "y": 1894,
        "wires": [
            []
        ]
    },
    {
        "id": "e8c03186.98b5e",
        "type": "trigger",
        "z": "a068bd5.28a8d4",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "30",
        "extend": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "Time to come down",
        "x": 1310,
        "y": 1960,
        "wires": [
            [
                "f7b6728.24f7a9"
            ]
        ]
    },
    {
        "id": "d5e198ac.4ec488",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 1980,
        "wires": [
            [
                "e8c03186.98b5e"
            ]
        ]
    },
    {
        "id": "f7b6728.24f7a9",
        "type": "api-call-service",
        "z": "a068bd5.28a8d4",
        "name": "Turn off living room lights - No movent",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.living_room_lights\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 1590,
        "y": 1960,
        "wires": [
            []
        ]
    },
    {
        "id": "86692ab8.010d38",
        "type": "subflow:c9b308f8.01ef68",
        "z": "a3158433.9d1f78",
        "name": "",
        "x": 1070,
        "y": 1220,
        "wires": []
    },
    {
        "id": "404814cc.c2c46c",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Turn Off Lights",
        "server": "eef5a84.da24f58",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hue_lightstrip_plus_1\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1080,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "15e204de.45b3bb",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "BathRoom Availability",
        "info": "",
        "x": 160,
        "y": 1540,
        "wires": []
    },
    {
        "id": "8ef2eef7.7fb0c",
        "type": "mqtt in",
        "z": "48ba348c.61270c",
        "name": "",
        "topic": "checkIn/bathroomMCU",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 160,
        "y": 1580,
        "wires": [
            [
                "1c55810f.6df78f",
                "d9d4b9f.8725548"
            ]
        ]
    },
    {
        "id": "1c55810f.6df78f",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "8",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 430,
        "y": 1560,
        "wires": [
            [
                "de82ca98.6d5598",
                "49e35126.2d4f",
                "a119708f.86aad"
            ]
        ]
    },
    {
        "id": "de82ca98.6d5598",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/bathroomMCU",
        "topic": "availability/bathroomMCU",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 770,
        "y": 1620,
        "wires": []
    },
    {
        "id": "d9d4b9f.8725548",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bedroom",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1600,
        "wires": [
            [
                "de82ca98.6d5598"
            ]
        ]
    },
    {
        "id": "d6c5ee0b.dd471",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Bath Node MCU - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1040,
        "y": 1580,
        "wires": [
            []
        ]
    },
    {
        "id": "49e35126.2d4f",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Bathroom Node MCU has not checked in",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Bathroom Node MCU",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart Bathroom node mcu",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bathroom",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1540,
        "wires": [
            [
                "f6daaed4.01e24"
            ]
        ]
    },
    {
        "id": "f6daaed4.01e24",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 935,
        "y": 1540,
        "wires": []
    },
    {
        "id": "4b47eaf4.4a6da4",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "Triggered?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 200,
        "y": 1920,
        "wires": [
            [
                "e880a854.db5a98"
            ]
        ]
    },
    {
        "id": "807b6968.6ef5c8",
        "type": "delay",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "pauseType": "delay",
        "timeout": "200",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 670,
        "y": 640,
        "wires": [
            [
                "bc7a046f.08cac8"
            ]
        ]
    },
    {
        "id": "d6fa96e8.148b68",
        "type": "comment",
        "z": "a0cdc0f9.a362b",
        "name": "TODO: is dark? - record when bathroom goes to dark: flase for first time",
        "info": "",
        "x": 1790,
        "y": 300,
        "wires": []
    },
    {
        "id": "125fd92.83d6a27",
        "type": "alexa-home",
        "z": "a0a4859f.5a2a48",
        "conf": "3fa4c0fe.0f3ed",
        "device": "53496",
        "acknoledge": true,
        "name": "Red Alert",
        "topic": "",
        "x": 120,
        "y": 460,
        "wires": [
            [
                "6437b20a.d659fc",
                "6f9e018d.2605f",
                "8dd6735b.05853"
            ]
        ]
    },
    {
        "id": "e5e95e2e.4d267",
        "type": "subflow:47bc2d66.1132e4",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "x": 1950,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "8dd6735b.05853",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Red Alert Triggered\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 420,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "6f9e018d.2605f",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Let Danni Know ",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "danniiphone",
        "data": "{\"message\":\"Red Alert Triggered\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 420,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "e28df683.3ce3d8",
        "type": "api-current-state",
        "z": "a068bd5.28a8d4",
        "name": "Light State",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "light.living_room_lights",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "",
        "override_data": "none",
        "x": 650,
        "y": 1900,
        "wires": [
            [
                "3d02e496.8d505c"
            ]
        ]
    },
    {
        "id": "3d02e496.8d505c",
        "type": "switch",
        "z": "a068bd5.28a8d4",
        "name": "Is off?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 830,
        "y": 1900,
        "wires": [
            [
                "8ca88ef0.2dcb"
            ]
        ]
    },
    {
        "id": "87cfb997.596a08",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "12",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 950,
        "y": 1020,
        "wires": [
            [
                "e1b8ad57.cdca"
            ]
        ]
    },
    {
        "id": "6b2ad87a.0e91f8",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "22",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 950,
        "y": 1080,
        "wires": [
            [
                "5f3ed30a.fb17ac"
            ]
        ]
    },
    {
        "id": "9bb7e742.fe6778",
        "type": "change",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 934,
        "wires": [
            [
                "87cfb997.596a08",
                "6b2ad87a.0e91f8"
            ]
        ]
    },
    {
        "id": "b15702d1.3a09",
        "type": "rbe",
        "z": "a3158433.9d1f78",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 380,
        "y": 480,
        "wires": [
            [
                "ed273171.7f05f"
            ]
        ]
    },
    {
        "id": "57ce7fd6.512fb",
        "type": "rbe",
        "z": "a3158433.9d1f78",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 380,
        "y": 520,
        "wires": [
            [
                "ed273171.7f05f"
            ]
        ]
    },
    {
        "id": "cab70747.d77428",
        "type": "rbe",
        "z": "a3158433.9d1f78",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 378,
        "y": 560,
        "wires": [
            [
                "2040e4b1.d5c3fc"
            ]
        ]
    },
    {
        "id": "4d55b523.00f95c",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "Start up complete",
        "property": "StartUpCompleted",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2236,
        "y": 591,
        "wires": [
            [
                "b217742e.3caa78"
            ]
        ]
    },
    {
        "id": "121df473.76cdfc",
        "type": "comment",
        "z": "b8a16318.b66a5",
        "name": "Start Up",
        "info": "",
        "x": 100,
        "y": 520,
        "wires": []
    },
    {
        "id": "4ae824ff.6456fc",
        "type": "inject",
        "z": "b8a16318.b66a5",
        "name": "",
        "topic": "Starting",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "x": 100,
        "y": 560,
        "wires": [
            [
                "cdb49bda.24b898",
                "a1c74ed7.4353b"
            ]
        ]
    },
    {
        "id": "561911f5.ea224",
        "type": "inject",
        "z": "b8a16318.b66a5",
        "name": "",
        "topic": "",
        "payload": "Started",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "120",
        "x": 100,
        "y": 640,
        "wires": [
            [
                "e459e773.cc4ca8",
                "d09e9ffd.22858",
                "96744777.ee4268"
            ]
        ]
    },
    {
        "id": "cdb49bda.24b898",
        "type": "change",
        "z": "b8a16318.b66a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "StartUpCompleted",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "e459e773.cc4ca8",
        "type": "change",
        "z": "b8a16318.b66a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "StartUpCompleted",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "d09e9ffd.22858",
        "type": "time-range-switch",
        "z": "b8a16318.b66a5",
        "name": "",
        "lat": "",
        "lon": "",
        "startTime": "09:00",
        "endTime": "20:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 270,
        "y": 700,
        "wires": [
            [
                "93fd391a.057098"
            ],
            []
        ]
    },
    {
        "id": "221d531d.195e8c",
        "type": "time-range-switch",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "lat": "",
        "lon": "",
        "startTime": "10:00",
        "endTime": "18:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1610,
        "y": 340,
        "wires": [
            [],
            [
                "8b43d993.76bf28"
            ]
        ]
    },
    {
        "id": "f2f81d70.02f45",
        "type": "api-current-state",
        "z": "48ba348c.61270c",
        "name": "Bathroom Light",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "light.bathroom_light",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 400,
        "y": 1740,
        "wires": [
            [
                "e52e2bae.e37f08"
            ]
        ]
    },
    {
        "id": "e52e2bae.e37f08",
        "type": "switch",
        "z": "48ba348c.61270c",
        "name": "Is on?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 630,
        "y": 1740,
        "wires": [
            [
                "32a12bfb.202554"
            ]
        ]
    },
    {
        "id": "829f4cff.e7ef9",
        "type": "switch",
        "z": "48ba348c.61270c",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "80",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1740,
        "wires": [
            [
                "ceef5649.2c1e28",
                "6554bcd1.9b1094"
            ]
        ]
    },
    {
        "id": "32a12bfb.202554",
        "type": "function",
        "z": "48ba348c.61270c",
        "name": "How many minutes?",
        "func": "var startTime = new Date(msg.data.last_changed); \nvar endTime = new Date(Date.now());\nvar difference = endTime.getTime() - startTime.getTime(); // This will give difference in milliseconds\nvar resultInMinutes = Math.round(difference / 60000);\nmsg.payload = resultInMinutes\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 840,
        "y": 1740,
        "wires": [
            [
                "829f4cff.e7ef9"
            ]
        ]
    },
    {
        "id": "ceef5649.2c1e28",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Bathroom Light is still on after 80 minutes",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Bathroom Light Is Still",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Auto fix - tunring off light",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1210,
        "y": 1740,
        "wires": [
            [
                "ab9413e4.3c106"
            ]
        ]
    },
    {
        "id": "ab9413e4.3c106",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 1355,
        "y": 1740,
        "wires": []
    },
    {
        "id": "a8b7b552.c40c58",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "Every 5 Minutes",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "300",
        "crontab": "",
        "once": true,
        "onceDelay": "60",
        "x": 150,
        "y": 1740,
        "wires": [
            [
                "f2f81d70.02f45"
            ]
        ]
    },
    {
        "id": "bb7358f3.65e0f8",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "BathRoom Light",
        "info": "",
        "x": 140,
        "y": 1680,
        "wires": []
    },
    {
        "id": "6554bcd1.9b1094",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Turn Off Bathroom light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\" light.bathroom_light\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1250,
        "y": 1780,
        "wires": [
            []
        ]
    },
    {
        "id": "19a57a1d.668396",
        "type": "trigger-state",
        "z": "acf12371.2c1ae",
        "name": "",
        "server": "5ee4d578.f7736c",
        "entityid": "light.hue_lightstrip_plus_1_2",
        "entityidfiltertype": "exact",
        "debugenabled": false,
        "constraints": [
            {
                "id": "yrj9xgqsli",
                "targetType": "this_entity",
                "targetValue": "",
                "propertyType": "current_state",
                "propertyValue": "new_state.state",
                "comparatorType": "is",
                "comparatorValueDatatype": "str",
                "comparatorValue": "on"
            },
            {
                "id": "awav1i06gke",
                "targetType": "this_entity",
                "targetValue": "",
                "propertyType": "previous_state",
                "propertyValue": "old_state.state",
                "comparatorType": "is_not",
                "comparatorValueDatatype": "str",
                "comparatorValue": "on"
            }
        ],
        "constraintsmustmatch": "all",
        "outputs": 2,
        "customoutputs": [],
        "outputinitially": false,
        "state_type": "str",
        "x": 380,
        "y": 260,
        "wires": [
            [
                "305f853b.a9109a",
                "69f941cc.67b3d"
            ],
            []
        ]
    },
    {
        "id": "305f853b.a9109a",
        "type": "api-call-service",
        "z": "acf12371.2c1ae",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.hue_lightstrip_plus_1_2\",\"rgb_color\":[255,40,254]}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 760,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "69f941cc.67b3d",
        "type": "api-call-service",
        "z": "acf12371.2c1ae",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.office_light_rgb\",\"rgb_color\":[255,40,254]}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 760,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "419be230.6e864c",
        "type": "comment",
        "z": "acf12371.2c1ae",
        "name": "When office plug active",
        "info": "",
        "x": 320,
        "y": 200,
        "wires": []
    },
    {
        "id": "ebbc8996.c43b58",
        "type": "catch",
        "z": "acf12371.2c1ae",
        "name": "",
        "scope": null,
        "x": 80,
        "y": 80,
        "wires": [
            [
                "1b1f5173.a7432f"
            ]
        ]
    },
    {
        "id": "1b1f5173.a7432f",
        "type": "subflow:f5eab19a.7cf17",
        "z": "acf12371.2c1ae",
        "name": "",
        "x": 310,
        "y": 80,
        "wires": []
    },
    {
        "id": "88992cf0.ec7f5",
        "type": "comment",
        "z": "acf12371.2c1ae",
        "name": "Error Handler",
        "info": "",
        "x": 90,
        "y": 40,
        "wires": []
    },
    {
        "id": "8cbf3f8d.84749",
        "type": "ha-wait-until",
        "z": "d73100a9.0d64d",
        "name": "Both In Bed",
        "server": "5ee4d578.f7736c",
        "outputs": 2,
        "entityId": "sensor.num_in_master_bed",
        "property": "state",
        "comparator": "is",
        "value": "2",
        "valueType": "str",
        "timeout": "2",
        "timeoutUnits": "hours",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "x": 1510,
        "y": 300,
        "wires": [
            [
                "eb0ba936.3f4e18"
            ],
            [
                "7356acc5.e71944"
            ]
        ]
    },
    {
        "id": "747f847d.8cf0ec",
        "type": "subflow:47bc2d66.1132e4",
        "z": "d73100a9.0d64d",
        "name": "",
        "env": [],
        "x": 2488,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "b4bcf0ef.3f114",
        "type": "subflow:c9b308f8.01ef68",
        "z": "d73100a9.0d64d",
        "name": "",
        "env": [],
        "x": 2470,
        "y": 440,
        "wires": []
    },
    {
        "id": "52988821.c30f68",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Disable holiday mode",
        "server": "eef5a84.da24f58",
        "service_domain": "input_boolean",
        "service": "turn_off",
        "data": "{\"entity_id\":\"input_boolean.holidaymode\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 480,
        "y": 1400,
        "wires": [
            []
        ]
    },
    {
        "id": "359bae70.db4ef2",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Disarm Alarm",
        "server": "5ee4d578.f7736c",
        "service_domain": "alarm_control_panel",
        "service": "alarm_disarm",
        "data": "{\"entity_id\":\"alarm_control_panel.home_alarm\"}",
        "mergecontext": "",
        "x": 1060,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "ae2c061b.21ee48",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "8",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "Give Life life 360 time to update",
        "x": 1110,
        "y": 400,
        "wires": [
            [
                "2040e4b1.d5c3fc",
                "da37bd86.e9a86"
            ]
        ]
    },
    {
        "id": "ed273171.7f05f",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "4",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "Give Life life 360 time to update",
        "x": 790,
        "y": 500,
        "wires": [
            [
                "2040e4b1.d5c3fc"
            ]
        ]
    },
    {
        "id": "a2cfceb9.6eebc",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Someone Home",
        "server": "eef5a84.da24f58",
        "service_domain": "input_boolean",
        "service": "turn_on",
        "data": "{\"entity_id\":\"input_boolean.isanyonehome\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 240,
        "y": 1000,
        "wires": [
            []
        ]
    },
    {
        "id": "dc2626b6.cb8a88",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Away",
        "server": "eef5a84.da24f58",
        "service_domain": "input_boolean",
        "service": "turn_off",
        "data": "{\"entity_id\":\"input_boolean.isanyonehome\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 450,
        "y": 1140,
        "wires": [
            []
        ]
    },
    {
        "id": "bea24dc.62f6cb",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "SomeOne Left ",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 780,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "81818922.360f98",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "Someone Home",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 780,
        "y": 220,
        "wires": [
            [
                "359bae70.db4ef2",
                "34d4aee9.cd2842",
                "ae2c061b.21ee48",
                "554a47c4.710788"
            ]
        ]
    },
    {
        "id": "85dea4f7.0782b8",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "Greater then 10?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "10",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 370,
        "y": 260,
        "wires": [
            [
                "81818922.360f98"
            ],
            [
                "bea24dc.62f6cb"
            ]
        ],
        "outputLabels": [
            "Yes",
            "No"
        ]
    },
    {
        "id": "fa841a56.1037e8",
        "type": "link out",
        "z": "a3158433.9d1f78",
        "name": "Matt Home",
        "links": [
            "2bed651f.90ee2a"
        ],
        "x": 995,
        "y": 131,
        "wires": []
    },
    {
        "id": "2bed651f.90ee2a",
        "type": "link in",
        "z": "dceb45d8.425368",
        "name": "Matt Lunch Time - Home vis bt",
        "links": [
            "6590eef7.36df6",
            "fa841a56.1037e8"
        ],
        "x": 75,
        "y": 140,
        "wires": [
            [
                "912e1c7f.de2ae"
            ]
        ]
    },
    {
        "id": "b217742e.3caa78",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "Start up complete",
        "property": "DisarmDelayOver",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2490,
        "y": 590,
        "wires": [
            [
                "21652d70.72b232"
            ]
        ]
    },
    {
        "id": "da37bd86.e9a86",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "Deactive - DisarmDelayOver",
        "rules": [
            {
                "t": "set",
                "p": "DisarmDelayOver",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1420,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "554a47c4.710788",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "Active - DisarmDelayOver",
        "rules": [
            {
                "t": "set",
                "p": "DisarmDelayOver",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1090,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "a1c74ed7.4353b",
        "type": "change",
        "z": "b8a16318.b66a5",
        "name": "Deactive - DisarmDelayOver",
        "rules": [
            {
                "t": "set",
                "p": "DisarmDelayOver",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "ecc00f70.5015e",
        "type": "trigger-state",
        "z": "a0cdc0f9.a362b",
        "name": "Bathroom Door Closes",
        "server": "5ee4d578.f7736c",
        "entityid": "binary_sensor.bathroom_door",
        "entityidfiltertype": "exact",
        "debugenabled": true,
        "constraints": [
            {
                "id": "d5vltnbuxze",
                "targetType": "this_entity",
                "targetValue": "",
                "propertyType": "current_state",
                "propertyValue": "new_state.state",
                "comparatorType": "is",
                "comparatorValueDatatype": "str",
                "comparatorValue": "off"
            },
            {
                "id": "9ynzlhs6z8",
                "targetType": "this_entity",
                "targetValue": "",
                "propertyType": "previous_state",
                "propertyValue": "old_state.state",
                "comparatorType": "is",
                "comparatorValueDatatype": "str",
                "comparatorValue": "on"
            }
        ],
        "constraintsmustmatch": "all",
        "outputs": 2,
        "customoutputs": [],
        "outputinitially": false,
        "state_type": "str",
        "x": 140,
        "y": 460,
        "wires": [
            [
                "11cc7991.aa98f6"
            ],
            []
        ]
    },
    {
        "id": "11cc7991.aa98f6",
        "type": "change",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 200,
        "y": 520,
        "wires": [
            [
                "9edcd817.aed998"
            ]
        ]
    },
    {
        "id": "6f09f51.c3f470c",
        "type": "delay",
        "z": "d73100a9.0d64d",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 320,
        "y": 360,
        "wires": [
            [
                "76161c80.f91cb4"
            ]
        ]
    },
    {
        "id": "4dd1d9f0.0d6928",
        "type": "server-state-changed",
        "z": "21d6efde.d0943",
        "name": "Number Of People In Bed",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "entityidfilter": "sensor.num_in_master_bed",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 170,
        "y": 380,
        "wires": [
            [
                "17ce9344.2f1a6d"
            ]
        ]
    },
    {
        "id": "17ce9344.2f1a6d",
        "type": "function",
        "z": "21d6efde.d0943",
        "name": "What changed?",
        "func": "if (msg.payload == \"0\" && msg.data.old_state.state >= \"1\") {\n    // Bed Empty\n    return [null, null, null, msg];\n}if ((msg.payload == \"1\" && msg.data.old_state.state == \"2\" )) {\n    // Someone got out of bed    \n    return [msg, null, null, null];\n} else if (msg.payload == \"2\" ) {\n    // All In bed\n    return [null, msg, null, null];\n} else if (msg.payload == \"1\" && msg.data.old_state.state == \"0\" ) {\n    return [null,null ,msg, null];\n}\n",
        "outputs": 4,
        "noerr": 0,
        "x": 443,
        "y": 380,
        "wires": [
            [
                "b5f1a42e.badfd8",
                "8742d21b.87bac"
            ],
            [
                "b5f1a42e.badfd8",
                "37a4096e.f440b6"
            ],
            [
                "b5f1a42e.badfd8",
                "e00c5e15.87c8"
            ],
            [
                "8742d21b.87bac",
                "89782bb8.4daed8",
                "b5f1a42e.badfd8"
            ]
        ],
        "outputLabels": [
            "Someone got out of bed ",
            "All In bed",
            "Some one got into bed",
            ""
        ]
    },
    {
        "id": "73c4653f.fa065c",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Turn Off Hallway",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hallway_light\"}",
        "mergecontext": "",
        "x": 960,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "406dc049.8d9a9",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Turn Off Bath Room Light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.bathroom_light\"}",
        "mergecontext": "",
        "x": 1290,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "31e78bac.bf7a44",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Get Light Status",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "light.hue_lightstrip_plus_1",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 960,
        "y": 220,
        "wires": [
            [
                "e6526ce7.a7f6d"
            ]
        ]
    },
    {
        "id": "e6526ce7.a7f6d",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Is on?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1150,
        "y": 220,
        "wires": [
            [
                "c184b274.473dd"
            ]
        ]
    },
    {
        "id": "bf1745aa.99ae38",
        "type": "trigger",
        "z": "21d6efde.d0943",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "40",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1810,
        "y": 220,
        "wires": [
            [
                "4db1c7dc.20b988"
            ]
        ]
    },
    {
        "id": "d94b6303.4c9b4",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Get Light Status",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "light.hue_lightstrip_plus_1",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 960,
        "y": 580,
        "wires": [
            [
                "3e8b67b.d67e898"
            ]
        ]
    },
    {
        "id": "3e8b67b.d67e898",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Is on?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1116,
        "y": 580,
        "wires": [
            [],
            [
                "cd3f3b72.852b78"
            ]
        ]
    },
    {
        "id": "ad898ac9.92eed8",
        "type": "trigger",
        "z": "21d6efde.d0943",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "20",
        "extend": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1330,
        "y": 480,
        "wires": [
            [
                "434e6fc5.b6d3f"
            ]
        ]
    },
    {
        "id": "b72e15a1.166368",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Get Light Status",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "light.hue_lightstrip_plus_1",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 954,
        "y": 440,
        "wires": [
            [
                "c33821b3.7c2f2"
            ]
        ]
    },
    {
        "id": "c33821b3.7c2f2",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Is on?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1144,
        "y": 440,
        "wires": [
            [
                "ad898ac9.92eed8"
            ]
        ]
    },
    {
        "id": "cd3f3b72.852b78",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Get Light Level",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "sensor.bedroom_light_level",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1314,
        "y": 580,
        "wires": [
            [
                "fa0d5a78.60f6c8"
            ]
        ]
    },
    {
        "id": "fa0d5a78.60f6c8",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Is Drak?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "10",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1514,
        "y": 580,
        "wires": [
            [
                "77cd270e.473e68",
                "7908f2b0.d712bc"
            ]
        ]
    },
    {
        "id": "77cd270e.473e68",
        "type": "trigger",
        "z": "21d6efde.d0943",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "4",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1690,
        "y": 620,
        "wires": [
            [
                "54d568b1.55c118"
            ]
        ]
    },
    {
        "id": "b5f1a42e.badfd8",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Reset",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 520,
        "wires": [
            [
                "ad898ac9.92eed8",
                "77cd270e.473e68",
                "bf1745aa.99ae38",
                "85de34f9.89a238",
                "2f384af5.144826"
            ]
        ]
    },
    {
        "id": "b97181b3.4fed7",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "TODO: Once Barthroom door open - increase lgiht level",
        "info": "",
        "x": 1737,
        "y": 320,
        "wires": []
    },
    {
        "id": "54d568b1.55c118",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Is sun up?",
        "property": "sunstate",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "above_horizon",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1870,
        "y": 620,
        "wires": [
            [
                "3ae27dd.11c2082"
            ],
            [
                "970b044c.ac0df8"
            ]
        ],
        "outputLabels": [
            "Yes",
            "No"
        ]
    },
    {
        "id": "3ae27dd.11c2082",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Turn Off Light Strip",
        "server": "eef5a84.da24f58",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hue_lightstrip_plus_1\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 2076,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "d320a708.e46708",
        "type": "link out",
        "z": "21d6efde.d0943",
        "name": "Someone going to bathroom",
        "links": [
            "4fe3f102.783b3"
        ],
        "x": 1095,
        "y": 180,
        "wires": []
    },
    {
        "id": "f095ae40.45f81",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Bathroom light",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 180,
        "wires": [
            [
                "d320a708.e46708"
            ]
        ]
    },
    {
        "id": "5f66252.fc79adc",
        "type": "comment",
        "z": "a068bd5.28a8d4",
        "name": "Auto Down Stairs Lights",
        "info": "",
        "x": 170,
        "y": 1840,
        "wires": []
    },
    {
        "id": "7dad6fcb.83973",
        "type": "catch",
        "z": "21d6efde.d0943",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 60,
        "wires": [
            [
                "36ab283d.217f38"
            ]
        ]
    },
    {
        "id": "36ab283d.217f38",
        "type": "subflow:f5eab19a.7cf17",
        "z": "21d6efde.d0943",
        "name": "",
        "x": 350,
        "y": 60,
        "wires": []
    },
    {
        "id": "7ea1ee6b.d0763",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 20,
        "wires": []
    },
    {
        "id": "54664ccd.b262b4",
        "type": "api-call-service",
        "z": "7df159d5.618c58",
        "name": "Call Service",
        "server": "5ee4d578.f7736c",
        "service_domain": "",
        "service": "",
        "data": "",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 730,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "eaa2ec0.5e97a18",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 140,
        "y": 1220,
        "wires": [
            [
                "b1b009eb.b78008"
            ]
        ]
    },
    {
        "id": "b1b009eb.b78008",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = SLOW_LOW",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "SLOW_LOW",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1220,
        "wires": [
            [
                "b339899d.9350e8"
            ]
        ]
    },
    {
        "id": "b339899d.9350e8",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "x": 720,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "8fb12ce9.36e89",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = HIGH",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "HIGH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 1260,
        "wires": [
            [
                "b339899d.9350e8"
            ]
        ]
    },
    {
        "id": "b976ad9c.9ff01",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 140,
        "y": 1260,
        "wires": [
            [
                "8fb12ce9.36e89"
            ]
        ]
    },
    {
        "id": "2e287d01.0a12d2",
        "type": "function",
        "z": "7df159d5.618c58",
        "name": "Build Command",
        "func": "var rgb_color;\nvar mattColor = [72,255,118] // greeb\nvar danniColor = [75,164,255] // blue\nvar fullBed = [201,40,255] // dark pink\nvar emtpyBed = [255,182,109] // oragne\n\nif (msg.payload.NumberInBed == \"0\") {\n    rgb_color = emtpyBed; \n} else if (msg.payload.NumberInBed == \"2\") {\n   rgb_color = fullBed;\n} else if (msg.payload.DanniInBed == \"True\") {\n    rgb_color = danniColor;\n} else if (msg.payload.MattInBed == \"True\") {\n    rgb_color = mattColor;\n} else {\n    rgb_color = [255,43,0]; // Error this should happen\n}\n\n\n\nif (msg.LightLevel == \"DIMMED\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : \"turn_on\",\n     \"data\" : \n        { \n            \"entity_id\" : \"light.hue_lightstrip_plus_1\",\n            \"brightness_pct\": \"50\",\n            \"transition\":\"5\",\n            \"rgb_color\": rgb_color\n        } \n    }\n} else if (msg.LightLevel == \"SLOW_LOW\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : \"turn_on\",\n     \"data\" : \n        { \n            \"entity_id\" : \"light.hue_lightstrip_plus_1\",\n            \"brightness_pct\": \"10\",\n            \"transition\":\"30\",\n            \"rgb_color\": rgb_color\n        } \n    }\n}else if (msg.LightLevel == \"FAST_LOW\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : \"turn_on\",\n     \"data\" : \n        { \n            \"entity_id\" : \"light.hue_lightstrip_plus_1\",\n            \"brightness_pct\": \"10\",\n            \"transition\":\"5\",\n            \"rgb_color\": rgb_color\n        } \n    }\n} else if (msg.LightLevel == \"HIGH\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : \"turn_on\",\n     \"data\" : \n        { \n            \"entity_id\" : \"light.hue_lightstrip_plus_1\",\n            \"brightness_pct\": \"100\",\n            \"transition\":\"2\",\n            \"rgb_color\": rgb_color\n        } \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 480,
        "y": 80,
        "wires": [
            [
                "54664ccd.b262b4"
            ]
        ]
    },
    {
        "id": "55364589.7caf5c",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Someone Got Out of Bed",
        "info": "",
        "x": 987,
        "y": 140,
        "wires": []
    },
    {
        "id": "7163eb0e.a8e594",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Both in Bed",
        "info": "",
        "x": 944,
        "y": 280,
        "wires": []
    },
    {
        "id": "80b968a4.750978",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Someone got into to bed and bed was empty",
        "info": "",
        "x": 1050,
        "y": 540,
        "wires": []
    },
    {
        "id": "8742d21b.87bac",
        "type": "function",
        "z": "21d6efde.d0943",
        "name": "Someone Got Out of Bed",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 713,
        "y": 200,
        "wires": [
            [
                "31e78bac.bf7a44",
                "f095ae40.45f81"
            ]
        ]
    },
    {
        "id": "37a4096e.f440b6",
        "type": "function",
        "z": "21d6efde.d0943",
        "name": "Both In Bed",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 730,
        "y": 400,
        "wires": [
            [
                "73c4653f.fa065c",
                "b72e15a1.166368",
                "60ccf4c9.3b230c",
                "2f384af5.144826",
                "19968e17.daaa62"
            ]
        ]
    },
    {
        "id": "3a419f66.b12e2",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 140,
        "y": 1180,
        "wires": [
            [
                "c91f466e.75eec8"
            ]
        ]
    },
    {
        "id": "c91f466e.75eec8",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = FAST_LOW",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "FAST_LOW",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 1180,
        "wires": [
            [
                "b339899d.9350e8"
            ]
        ]
    },
    {
        "id": "c184b274.473dd",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = DIMMED",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "DIMMED",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 220,
        "wires": [
            [
                "9eb3ee48.7eea1"
            ]
        ]
    },
    {
        "id": "9eb3ee48.7eea1",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "env": [],
        "x": 1600,
        "y": 220,
        "wires": [
            [
                "bf1745aa.99ae38"
            ]
        ]
    },
    {
        "id": "4db1c7dc.20b988",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = FAST_LOW",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "FAST_LOW",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2040,
        "y": 220,
        "wires": [
            [
                "da590105.3c2f"
            ]
        ]
    },
    {
        "id": "da590105.3c2f",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "x": 2280,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "970b044c.ac0df8",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = FAST_LOW",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "FAST_LOW",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2106,
        "y": 627,
        "wires": [
            [
                "2c7afb08.7664c4"
            ]
        ]
    },
    {
        "id": "2c7afb08.7664c4",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "x": 2346,
        "y": 627,
        "wires": [
            []
        ]
    },
    {
        "id": "9908c87d.751788",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = DIMMED",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "DIMMED",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 1300,
        "wires": [
            [
                "b339899d.9350e8"
            ]
        ]
    },
    {
        "id": "a9d60da4.efb3b",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 140,
        "y": 1300,
        "wires": [
            [
                "9908c87d.751788"
            ]
        ]
    },
    {
        "id": "7908f2b0.d712bc",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = HIGH",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "HIGH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1720,
        "y": 580,
        "wires": [
            [
                "344376be.729b2a"
            ]
        ]
    },
    {
        "id": "344376be.729b2a",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "env": [],
        "x": 1940,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "434e6fc5.b6d3f",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = SLOW_LOW",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "SLOW_LOW",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1610,
        "y": 440,
        "wires": [
            [
                "37fbd464.c082bc"
            ]
        ]
    },
    {
        "id": "37fbd464.c082bc",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "x": 1920,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "e890483e.ef37a8",
        "type": "api-render-template",
        "z": "7df159d5.618c58",
        "name": "GetState",
        "server": "5ee4d578.f7736c",
        "template": "{\n  \"MattInBed\": \"{{ states(\"sensor.matt_in_bed\") }}\",\n  \"DanniInBed\": \"{{ states(\"sensor.danni_in_bed\") }}\",\n  \"NumberInBed\": \"{{ states(\"sensor.num_in_master_bed\") }}\"\n}",
        "resultsLocation": "payload",
        "resultsLocationType": "msg",
        "templateLocation": "template",
        "templateLocationType": "msg",
        "x": 260,
        "y": 80,
        "wires": [
            [
                "2e287d01.0a12d2"
            ]
        ]
    },
    {
        "id": "ffbd43d0.7ad8c",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Automation based on bed sensor",
        "info": "",
        "x": 193,
        "y": 160,
        "wires": []
    },
    {
        "id": "cd442f93.a7434",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Testing",
        "info": "",
        "x": 110,
        "y": 1120,
        "wires": []
    },
    {
        "id": "6986a0d4.bf4d6",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "Set LightLevel = FAST_LOW",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "FAST_LOW",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2518,
        "y": 500,
        "wires": [
            [
                "f7a7ad4c.e1887"
            ]
        ]
    },
    {
        "id": "f7a7ad4c.e1887",
        "type": "subflow:7df159d5.618c58",
        "z": "d73100a9.0d64d",
        "name": "",
        "x": 2780,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "33d67a23.de0b26",
        "type": "function",
        "z": "d73100a9.0d64d",
        "name": "-",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2290,
        "y": 440,
        "wires": [
            [
                "b4bcf0ef.3f114",
                "6986a0d4.bf4d6"
            ]
        ]
    },
    {
        "id": "ebab3cd6.89d6d",
        "type": "function",
        "z": "47bc2d66.1132e4",
        "name": "Build Data",
        "func": "msg.payload = {\n    \"data\":\n        { \"message\": \".\", \"entity_id\": msg.pri_alexa }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 970,
        "y": 100,
        "wires": [
            [
                "275d0587.9c0bba"
            ]
        ]
    },
    {
        "id": "a2f7cd26.7ec92",
        "type": "link in",
        "z": "21d6efde.d0943",
        "name": "Hallway Motion - Action",
        "links": [
            "e04902ac.5849e"
        ],
        "x": 75,
        "y": 1060,
        "wires": [
            [
                "4a31153c.c3f34c"
            ]
        ]
    },
    {
        "id": "85de34f9.89a238",
        "type": "ha-wait-until",
        "z": "21d6efde.d0943",
        "name": "",
        "server": "5ee4d578.f7736c",
        "outputs": 2,
        "entityId": "sensor.num_in_master_bed",
        "property": "state",
        "comparator": "gte",
        "value": "1",
        "valueType": "num",
        "timeout": "3",
        "timeoutUnits": "minutes",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": true,
        "x": 900,
        "y": 1100,
        "wires": [
            [],
            [
                "b37727b7.7328c8"
            ]
        ]
    },
    {
        "id": "8a4277a0.b55188",
        "type": "subflow:7df159d5.618c58",
        "z": "21d6efde.d0943",
        "name": "",
        "env": [],
        "x": 1160,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "f1950263.27857",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Set LightLevel = HIGH",
        "rules": [
            {
                "t": "set",
                "p": "LightLevel",
                "pt": "msg",
                "to": "HIGH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 940,
        "y": 1060,
        "wires": [
            [
                "8a4277a0.b55188"
            ]
        ]
    },
    {
        "id": "54dcaa5e.c2e7e4",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Is Drak?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "10",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 614,
        "y": 1060,
        "wires": [
            [
                "f1950263.27857",
                "85de34f9.89a238"
            ]
        ]
    },
    {
        "id": "65fba381.feb66c",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Get Light Level",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "sensor.bedroom_light_level",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 414,
        "y": 1060,
        "wires": [
            [
                "54dcaa5e.c2e7e4"
            ]
        ],
        "icon": "node-red/mongodb.png"
    },
    {
        "id": "7ed0494c.0f48f8",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Hallway motion",
        "info": "",
        "x": 140,
        "y": 1020,
        "wires": []
    },
    {
        "id": "b37727b7.7328c8",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Turn Off Light Strip",
        "server": "eef5a84.da24f58",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.hue_lightstrip_plus_1\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1170,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "4a31153c.c3f34c",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Triggered?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 210,
        "y": 1060,
        "wires": [
            [
                "65fba381.feb66c",
                "cac0fa9c.057558"
            ]
        ]
    },
    {
        "id": "cac0fa9c.057558",
        "type": "debug",
        "z": "21d6efde.d0943",
        "name": "hallway ",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 390,
        "y": 1020,
        "wires": []
    },
    {
        "id": "c3e890f4.9c742",
        "type": "link in",
        "z": "a0cdc0f9.a362b",
        "name": "Hallway Motion - Action",
        "links": [
            "e04902ac.5849e"
        ],
        "x": 55,
        "y": 360,
        "wires": [
            [
                "6d9dc6b3.422258"
            ]
        ]
    },
    {
        "id": "6d9dc6b3.422258",
        "type": "switch",
        "z": "a0cdc0f9.a362b",
        "name": "Triggered?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 190,
        "y": 360,
        "wires": [
            [
                "a930f15f.b431d",
                "dfbfea55.092c18"
            ]
        ]
    },
    {
        "id": "be46a4b4.32eef8",
        "type": "comment",
        "z": "a0cdc0f9.a362b",
        "name": "Hallway motion",
        "info": "",
        "x": 120,
        "y": 300,
        "wires": []
    },
    {
        "id": "c6403382.59d75",
        "type": "trigger",
        "z": "a0cdc0f9.a362b",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "2",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "Wait 2 Minute for some one to enter",
        "x": 700,
        "y": 280,
        "wires": [
            [
                "44b62be6.846c34"
            ]
        ]
    },
    {
        "id": "dfbfea55.092c18",
        "type": "change",
        "z": "a0cdc0f9.a362b",
        "name": "Someone Entered Bathroom",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 380,
        "wires": [
            [
                "c6403382.59d75",
                "f49bd1bf.ad501",
                "95a4dd4.cece52",
                "1df00caa.c88d63"
            ]
        ]
    },
    {
        "id": "d6eda8a.8082c58",
        "type": "change",
        "z": "dceb45d8.425368",
        "name": "SET LunchTime Var",
        "rules": [
            {
                "t": "set",
                "p": "LunchTime.BeenTrigged",
                "pt": "global",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "60ccf4c9.3b230c",
        "type": "link out",
        "z": "21d6efde.d0943",
        "name": "Both In Bed",
        "links": [
            "5a8e5309.e00ddc"
        ],
        "x": 895,
        "y": 480,
        "wires": []
    },
    {
        "id": "5a8e5309.e00ddc",
        "type": "link in",
        "z": "a0cdc0f9.a362b",
        "name": "Bathroom disable timer",
        "links": [
            "60ccf4c9.3b230c"
        ],
        "x": 175,
        "y": 640,
        "wires": [
            [
                "9b9a792f.af51f8"
            ]
        ]
    },
    {
        "id": "367929a4.b81d46",
        "type": "change",
        "z": "c9b308f8.01ef68",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasGoodNightBeenTriggered",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "8f9c705.d69fb9",
        "type": "change",
        "z": "99d64a3d.f4e418",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasGoodNightBeenTriggered",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "6ea9b8b4.f2d438",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "Has triggered",
        "property": "hasGoodNightBeenTriggered",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1220,
        "y": 360,
        "wires": [
            [],
            [
                "8cbf3f8d.84749"
            ]
        ]
    },
    {
        "id": "eb0ba936.3f4e18",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "Has triggered",
        "property": "hasGoodNightBeenTriggered",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1800,
        "y": 360,
        "wires": [
            [
                "6e45a7ed.2c8728",
                "5d848996.a2fc68",
                "3eddd440.5a143c"
            ]
        ]
    },
    {
        "id": "c6eba40a.366198",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1000,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "1c6435f7.2b5b4a",
        "type": "function",
        "z": "a0a4859f.5a2a48",
        "name": "Data",
        "func": "msg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"Alarm still going off disable light show\",\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 750,
        "y": 760,
        "wires": [
            [
                "c6eba40a.366198"
            ]
        ]
    },
    {
        "id": "7bc3b53b.a5caec",
        "type": "server-state-changed",
        "z": "acf12371.2c1ae",
        "name": "",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "sensor.octoprint_current_state",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 190,
        "y": 380,
        "wires": [
            [
                "8b157c0.56ad788"
            ]
        ]
    },
    {
        "id": "acdd264f.f21468",
        "type": "api-call-service",
        "z": "acf12371.2c1ae",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 840,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "8b157c0.56ad788",
        "type": "function",
        "z": "acf12371.2c1ae",
        "name": "Data",
        "func": "msg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"Printer new Status: \" + msg.payload\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 530,
        "y": 380,
        "wires": [
            [
                "acdd264f.f21468"
            ]
        ]
    },
    {
        "id": "7076afa8.c4a22",
        "type": "comment",
        "z": "acf12371.2c1ae",
        "name": "Printer State Change",
        "info": "",
        "x": 120,
        "y": 340,
        "wires": []
    },
    {
        "id": "b28527ed.3a86f8",
        "type": "switch",
        "z": "acf12371.2c1ae",
        "name": "Is Open?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 220,
        "y": 640,
        "wires": [
            [
                "2d437d10.987252"
            ],
            []
        ]
    },
    {
        "id": "2b73f0a0.724a4",
        "type": "api-call-service",
        "z": "acf12371.2c1ae",
        "name": "Turn on office Light",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_on",
        "data": "{\"entity_id\":\"light.office_light\"}",
        "mergecontext": "",
        "x": 1050,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "5ec4b1fb.2f549",
        "type": "api-current-state",
        "z": "acf12371.2c1ae",
        "name": "Is office light strip",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "override_topic": true,
        "entity_id": "light.hue_lightstrip_plus_1_2",
        "override_payload": true,
        "override_data": true,
        "x": 610,
        "y": 620,
        "wires": [
            [
                "8b16eeba.b939e"
            ]
        ]
    },
    {
        "id": "8b16eeba.b939e",
        "type": "switch",
        "z": "acf12371.2c1ae",
        "name": "is On",
        "property": "data.attributes.dark",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 810,
        "y": 620,
        "wires": [
            [
                "2b73f0a0.724a4"
            ]
        ]
    },
    {
        "id": "aa78949c.41c9a8",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Office Door State Change",
        "links": [
            "79d508d7.4f2b68"
        ],
        "x": 355,
        "y": 1360,
        "wires": []
    },
    {
        "id": "79d508d7.4f2b68",
        "type": "link in",
        "z": "acf12371.2c1ae",
        "name": "",
        "links": [
            "aa78949c.41c9a8"
        ],
        "x": 115,
        "y": 640,
        "wires": [
            [
                "b28527ed.3a86f8"
            ]
        ]
    },
    {
        "id": "bac0e249.335d6",
        "type": "api-current-state",
        "z": "56368b94.f11494",
        "name": "Hallway State",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "binary_sensor.hallway_motion_sensor",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 200,
        "y": 80,
        "wires": [
            [
                "76978b35.4c91e4"
            ]
        ]
    },
    {
        "id": "76978b35.4c91e4",
        "type": "switch",
        "z": "56368b94.f11494",
        "name": "Is Dark?",
        "property": "data.attributes.dark",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 380,
        "y": 80,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "2d437d10.987252",
        "type": "subflow:56368b94.f11494",
        "z": "acf12371.2c1ae",
        "name": "",
        "x": 380,
        "y": 640,
        "wires": [
            [
                "5ec4b1fb.2f549"
            ],
            [],
            []
        ]
    },
    {
        "id": "3aaf4288.5a861e",
        "type": "comment",
        "z": "acf12371.2c1ae",
        "name": "On Door Open - Turn on light if dark",
        "info": "",
        "x": 180,
        "y": 580,
        "wires": []
    },
    {
        "id": "2554c135.8f322e",
        "type": "api-call-service",
        "z": "2aff94ce.fdbbdc",
        "name": "Office Plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.plug_05\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 510,
        "y": 120,
        "wires": [
            [
                "ef5eac6b.9761a"
            ]
        ]
    },
    {
        "id": "97ee681f.882eb8",
        "type": "delay",
        "z": "2aff94ce.fdbbdc",
        "name": "",
        "pauseType": "delay",
        "timeout": "60",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 220,
        "y": 120,
        "wires": [
            [
                "2554c135.8f322e"
            ]
        ]
    },
    {
        "id": "63544d80.0c9704",
        "type": "subflow:2aff94ce.fdbbdc",
        "z": "c9b308f8.01ef68",
        "name": "",
        "env": [],
        "x": 500,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "8bbc548a.b8c088",
        "type": "comment",
        "z": "c9b308f8.01ef68",
        "name": "Todo: is tv on?",
        "info": "",
        "x": 490,
        "y": 260,
        "wires": []
    },
    {
        "id": "3889bd46.c46682",
        "type": "switch",
        "z": "fec14295.8a46d",
        "name": "Is On?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "true"
            },
            {
                "t": "eq",
                "v": "On",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Yes",
                "vt": "str"
            },
            {
                "t": "false"
            },
            {
                "t": "eq",
                "v": "Off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "no",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 9,
        "x": 270,
        "y": 140,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "4b081df5.3a2924",
        "type": "comment",
        "z": "fec14295.8a46d",
        "name": "True",
        "info": "",
        "x": 570,
        "y": 40,
        "wires": []
    },
    {
        "id": "46cf8510.1b9b6c",
        "type": "comment",
        "z": "fec14295.8a46d",
        "name": "False",
        "info": "",
        "x": 570,
        "y": 200,
        "wires": []
    },
    {
        "id": "bb415259.e6d81",
        "type": "function",
        "z": "a0a4859f.5a2a48",
        "name": "Data",
        "func": "var loc = \"Alarm not active - \" + msg.location;\nif (msg.trusted == false) {\n    loc = \"untrusted motion detected alarm will not trigger - \"  + msg.location\n}\n\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": loc,\n    \"data\": \n    {\n      \"push\": {\n            \"badge\": 5,\n            \"category\": \"alarm\"\n        },\"attachment\": \n      {\n        \"url\": msg.image,\n        \"content-type\": \"jpeg\",\n        \"hide-thumbnail\": false\n      }\n    }\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1190,
        "y": 100,
        "wires": [
            [
                "4766ddd2.ac3f44"
            ]
        ]
    },
    {
        "id": "49841f4d.0e0a6",
        "type": "api-current-state",
        "z": "cdbc6ec6.2e0ec",
        "name": "Matt",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "sensor.matt_living_room",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 210,
        "y": 40,
        "wires": [
            [
                "179e2120.6949bf"
            ]
        ]
    },
    {
        "id": "1f3dd269.5d463e",
        "type": "api-current-state",
        "z": "cdbc6ec6.2e0ec",
        "name": "Danni",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "sensor.danni_living_room",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 210,
        "y": 80,
        "wires": [
            [
                "179e2120.6949bf"
            ]
        ]
    },
    {
        "id": "179e2120.6949bf",
        "type": "join",
        "z": "cdbc6ec6.2e0ec",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "2",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 430,
        "y": 60,
        "wires": [
            [
                "78367767.3a14a8"
            ]
        ]
    },
    {
        "id": "78367767.3a14a8",
        "type": "function",
        "z": "cdbc6ec6.2e0ec",
        "name": "Any on home?",
        "func": "\nif (msg.payload[0] > 10 || msg.payload[1] > 10) {\n   return [msg, null];\n} else if (msg.payload[0] == 0 && msg.payload[1] == 0)  {\n    return [null, msg];\n} else {\n    return [null, null];\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 680,
        "y": 60,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "e615d2e5.a6b6e",
        "type": "subflow:cdbc6ec6.2e0ec",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "env": [],
        "x": 980,
        "y": 100,
        "wires": [
            [],
            [
                "bb415259.e6d81"
            ]
        ]
    },
    {
        "id": "1ed9c8f5.1b8567",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Notication Only",
        "info": "",
        "x": 980,
        "y": 60,
        "wires": []
    },
    {
        "id": "4631bb30.00af14",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm & Notication",
        "info": "",
        "x": 990,
        "y": 140,
        "wires": []
    },
    {
        "id": "7825ad5c.712c84",
        "type": "trigger",
        "z": "a0a4859f.5a2a48",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "20",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "wait 20 seconds",
        "x": 1380,
        "y": 360,
        "wires": [
            [
                "ef97081d.287ae8"
            ]
        ]
    },
    {
        "id": "6aaf5f6d.8996c",
        "type": "rbe",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "location",
        "x": 810,
        "y": 100,
        "wires": [
            [
                "e615d2e5.a6b6e"
            ]
        ]
    },
    {
        "id": "bc309a6c.e0b7a8",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1640,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "dbc2e0b1.99c28",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Let Danni Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "danniiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1640,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "ea5b671b.6800a8",
        "type": "function",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm Disarmed",
        "func": "\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"Alarm Disarmed\"\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1280,
        "y": 820,
        "wires": [
            [
                "bc309a6c.e0b7a8",
                "dbc2e0b1.99c28"
            ]
        ]
    },
    {
        "id": "22b57d8c.92fe72",
        "type": "inject",
        "z": "dceb45d8.425368",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 120,
        "y": 180,
        "wires": [
            [
                "912e1c7f.de2ae"
            ]
        ]
    },
    {
        "id": "686dec51.be0b24",
        "type": "api-call-service",
        "z": "2aff94ce.fdbbdc",
        "name": "Hibrate Computer",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.mattpc_off\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 250,
        "y": 80,
        "wires": [
            [
                "ef5eac6b.9761a"
            ]
        ]
    },
    {
        "id": "5cbf4f55.ced48",
        "type": "subflow:cdbc6ec6.2e0ec",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "env": [],
        "x": 670,
        "y": 1200,
        "wires": [
            [
                "770fb6fb.c34b98",
                "30cf93b0.d2bb6c",
                "9bb7e742.fe6778"
            ],
            []
        ]
    },
    {
        "id": "5ade2405.4537cc",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Block if someone home",
        "info": "",
        "x": 680,
        "y": 1160,
        "wires": []
    },
    {
        "id": "770fb6fb.c34b98",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Disarm Alarm",
        "server": "5ee4d578.f7736c",
        "service_domain": "alarm_control_panel",
        "service": "alarm_disarm",
        "data": "{\"entity_id\":\"alarm_control_panel.home_alarm\"}",
        "mergecontext": "",
        "x": 940,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "c9abaa1c.5ae078",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1260,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "21658842.1f96a8",
        "type": "api-call-service",
        "z": "a0a4859f.5a2a48",
        "name": "Let Danni Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "danniiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1260,
        "y": 1240,
        "wires": [
            []
        ]
    },
    {
        "id": "30cf93b0.d2bb6c",
        "type": "function",
        "z": "a0a4859f.5a2a48",
        "name": "Alarm Activation Blocked",
        "func": "\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"Alarm Activation Blocked\"\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 970,
        "y": 1220,
        "wires": [
            [
                "c9abaa1c.5ae078",
                "21658842.1f96a8"
            ]
        ]
    },
    {
        "id": "a930f15f.b431d",
        "type": "api-current-state",
        "z": "a0cdc0f9.a362b",
        "name": "Light off?",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "light.bathroom",
        "state_type": "habool",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 420,
        "y": 280,
        "wires": [
            [],
            [
                "c6403382.59d75"
            ]
        ]
    },
    {
        "id": "5d848996.a2fc68",
        "type": "ha-wait-until",
        "z": "d73100a9.0d64d",
        "name": "Wait 2 Min",
        "server": "5ee4d578.f7736c",
        "outputs": 2,
        "entityId": "sensor.num_in_master_bed",
        "property": "state",
        "comparator": "is_not",
        "value": "2",
        "valueType": "str",
        "timeout": "2",
        "timeoutUnits": "minutes",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "x": 2070,
        "y": 360,
        "wires": [
            [],
            [
                "ff31cac4.b7b148"
            ]
        ]
    },
    {
        "id": "3eddd440.5a143c",
        "type": "ha-wait-until",
        "z": "d73100a9.0d64d",
        "name": "Wait 5 Min",
        "server": "5ee4d578.f7736c",
        "outputs": 2,
        "entityId": "sensor.num_in_master_bed",
        "property": "state",
        "comparator": "is_not",
        "value": "2",
        "valueType": "str",
        "timeout": "5",
        "timeoutUnits": "minutes",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "x": 2068,
        "y": 420,
        "wires": [
            [
                "86cbf076.c386f"
            ],
            [
                "33d67a23.de0b26"
            ]
        ]
    },
    {
        "id": "c3aa3a6e.de2c88",
        "type": "link in",
        "z": "d73100a9.0d64d",
        "name": "Good Night Message",
        "links": [
            "5d68af75.25cde"
        ],
        "x": 1575,
        "y": 440,
        "wires": [
            [
                "7356acc5.e71944"
            ]
        ]
    },
    {
        "id": "7356acc5.e71944",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "Has triggered",
        "property": "hasGoodNightBeenTriggered",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1720,
        "y": 440,
        "wires": [
            [
                "94c4fb0a.6129d8",
                "b399da43.7ff288"
            ]
        ]
    },
    {
        "id": "94c4fb0a.6129d8",
        "type": "trigger",
        "z": "d73100a9.0d64d",
        "op1": "",
        "op2": "on",
        "op1type": "nul",
        "op2type": "str",
        "duration": "2",
        "extend": false,
        "units": "min",
        "reset": "off",
        "bytopic": "all",
        "name": "",
        "x": 2050,
        "y": 480,
        "wires": [
            [
                "ff31cac4.b7b148"
            ]
        ]
    },
    {
        "id": "b399da43.7ff288",
        "type": "trigger",
        "z": "d73100a9.0d64d",
        "op1": "",
        "op2": "on",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "units": "min",
        "reset": "off",
        "bytopic": "all",
        "name": "",
        "x": 2050,
        "y": 520,
        "wires": [
            [
                "33d67a23.de0b26"
            ]
        ]
    },
    {
        "id": "9763e2da.ca994",
        "type": "inject",
        "z": "acf12371.2c1ae",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 100,
        "y": 260,
        "wires": [
            [
                "19a57a1d.668396"
            ]
        ]
    },
    {
        "id": "8bb1ee4b.d0777",
        "type": "inject",
        "z": "d73100a9.0d64d",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 500,
        "y": 440,
        "wires": [
            [
                "6ea9b8b4.f2d438",
                "dbfd4318.98ec5"
            ]
        ]
    },
    {
        "id": "dbfd4318.98ec5",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "hasGoodNightBeenTriggered",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 460,
        "wires": [
            [
                "54fc6c62.79b6c4"
            ]
        ]
    },
    {
        "id": "54fc6c62.79b6c4",
        "type": "debug",
        "z": "d73100a9.0d64d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 900,
        "y": 440,
        "wires": []
    },
    {
        "id": "cc4f8d1.d9d097",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Reset Goog Night State",
        "rules": [
            {
                "t": "set",
                "p": "hasGoodNightBeenTriggered",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 933,
        "wires": [
            []
        ]
    },
    {
        "id": "ba0cbec6.deb3e",
        "type": "link in",
        "z": "d73100a9.0d64d",
        "name": "Font Door Open",
        "links": [
            "82e7bf66.f63d3"
        ],
        "x": 1115,
        "y": 300,
        "wires": [
            [
                "30a579f3.b06e06"
            ]
        ]
    },
    {
        "id": "30a579f3.b06e06",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "Is it night",
        "property": "bedTime",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1220,
        "y": 300,
        "wires": [
            [
                "8cbf3f8d.84749"
            ]
        ]
    },
    {
        "id": "3f4805be.d14eba",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bedTime",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "8f58fd59.491a9",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bedTime",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "430cb417.cb4e7c",
        "type": "inject",
        "z": "acf12371.2c1ae",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 480,
        "y": 300,
        "wires": [
            [
                "305f853b.a9109a",
                "69f941cc.67b3d"
            ]
        ]
    },
    {
        "id": "6ee79555.3f313c",
        "type": "subflow:cdbc6ec6.2e0ec",
        "z": "a3158433.9d1f78",
        "name": "",
        "x": 3050,
        "y": 620,
        "wires": [
            [
                "45eeaa29.0cf7c4"
            ],
            [
                "f4d0131e.967c4"
            ]
        ]
    },
    {
        "id": "45eeaa29.0cf7c4",
        "type": "trigger",
        "z": "a3158433.9d1f78",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "10",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 3330,
        "y": 600,
        "wires": [
            [
                "f4d0131e.967c4"
            ]
        ]
    },
    {
        "id": "883e0b57.4516a8",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3040,
        "y": 580,
        "wires": [
            [
                "45eeaa29.0cf7c4"
            ]
        ]
    },
    {
        "id": "9622b30d.8b1b6",
        "type": "comment",
        "z": "a3158433.9d1f78",
        "name": "Allow 10 minute delay",
        "info": "",
        "x": 3060,
        "y": 540,
        "wires": []
    },
    {
        "id": "9488063b.727978",
        "type": "time-range-switch",
        "z": "85970b46.61e358",
        "name": "",
        "lat": "",
        "lon": "",
        "startTime": "07:00",
        "endTime": "goldenHour",
        "startOffset": "20:00",
        "endOffset": 0,
        "x": 670,
        "y": 40,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "b4c7c6f4.4d91b8",
        "type": "change",
        "z": "85970b46.61e358",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "NoteType",
                "tot": "env"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 40,
        "wires": [
            [
                "9488063b.727978"
            ]
        ]
    },
    {
        "id": "a119708f.86aad",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 740,
        "y": 1580,
        "wires": [
            [
                "d6c5ee0b.dd471"
            ],
            []
        ]
    },
    {
        "id": "e9c109a5.b4ce18",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 1020,
        "y": 1420,
        "wires": [
            [
                "3fc21522.ece32a"
            ],
            []
        ]
    },
    {
        "id": "d8742850.a3fb68",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 1020,
        "y": 1280,
        "wires": [
            [
                "4b56562a.e13668"
            ],
            []
        ]
    },
    {
        "id": "38de4a13.9e07c6",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 1020,
        "y": 1100,
        "wires": [
            [
                "cbb5e819.633268"
            ],
            []
        ]
    },
    {
        "id": "21d9c69d.9f8e7a",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 740,
        "y": 920,
        "wires": [
            [
                "ac6c25a0.3f1b98"
            ],
            []
        ]
    },
    {
        "id": "a8227300.13432",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 740,
        "y": 780,
        "wires": [
            [
                "cad6c4a0.0570e8"
            ],
            []
        ]
    },
    {
        "id": "18bb5523.688fcb",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 740,
        "y": 620,
        "wires": [
            [
                "be55b0fe.1cdef"
            ],
            []
        ]
    },
    {
        "id": "f4e9b89.fd1c548",
        "type": "subflow:85970b46.61e358",
        "z": "a068bd5.28a8d4",
        "name": "",
        "x": 1040,
        "y": 740,
        "wires": [
            [
                "408d5f52.6ad53"
            ],
            []
        ]
    },
    {
        "id": "27a0c65e.2a12da",
        "type": "api-call-service",
        "z": "a068bd5.28a8d4",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1440,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "408d5f52.6ad53",
        "type": "function",
        "z": "a068bd5.28a8d4",
        "name": "Data",
        "func": "msg.payload = \n{\n  \"data\": \n  {\n    \"message\": msg.location,\n    \"data\": \n    {\n      \"push\": {\n            \"badge\": 5,\n            \"category\": \"alarm\"\n        },\"attachment\": \n      {\n        \"url\": msg.image,\n        \"content-type\": \"jpeg\",\n        \"hide-thumbnail\": false\n      }\n    }\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1230,
        "y": 740,
        "wires": [
            [
                "27a0c65e.2a12da"
            ]
        ]
    },
    {
        "id": "275e27be.7bb5e8",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 500,
        "y": 240,
        "wires": [
            [
                "ca7402bc.ba7c8"
            ],
            []
        ]
    },
    {
        "id": "ef5eac6b.9761a",
        "type": "debug",
        "z": "2aff94ce.fdbbdc",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 770,
        "y": 60,
        "wires": []
    },
    {
        "id": "24753368.d0e28c",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "10 Second After Start up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 170,
        "y": 1160,
        "wires": [
            [
                "124b807c.ce19b",
                "51c0fbb2.abfe34"
            ]
        ]
    },
    {
        "id": "84157fba.07d2",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "10 Second After Start up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 170,
        "y": 1340,
        "wires": [
            [
                "24f7770e.b891b8",
                "899c25f0.69a088"
            ]
        ]
    },
    {
        "id": "8d22476.bf1ffb8",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/rmMini",
        "topic": "availability/rmMini",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1030,
        "y": 1320,
        "wires": []
    },
    {
        "id": "299c3b08.68c174",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "10 Second After Start up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 170,
        "y": 1480,
        "wires": [
            [
                "8ea47506.ccd558",
                "af146bf.3df0b98"
            ]
        ]
    },
    {
        "id": "141d4bb.57eb4b4",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/livingroomcam",
        "topic": "availability/livingroomcam",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1050,
        "y": 1460,
        "wires": []
    },
    {
        "id": "f49bd1bf.ad501",
        "type": "subflow:56368b94.f11494",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "env": [],
        "x": 1060,
        "y": 360,
        "wires": [
            [
                "78facd5e.ed58b4"
            ],
            [
                "a43cb31c.bbb2a"
            ],
            [
                "78facd5e.ed58b4"
            ]
        ]
    },
    {
        "id": "44b62be6.846c34",
        "type": "subflow:56368b94.f11494",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "env": [],
        "x": 2720,
        "y": 380,
        "wires": [
            [
                "918f0fb5.9a267"
            ],
            [],
            [
                "918f0fb5.9a267"
            ]
        ]
    },
    {
        "id": "918f0fb5.9a267",
        "type": "api-current-state",
        "z": "a0cdc0f9.a362b",
        "name": "Light On",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "light.bathroom_light",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 2900,
        "y": 380,
        "wires": [
            [
                "770e1c17.c8aae4"
            ]
        ]
    },
    {
        "id": "770e1c17.c8aae4",
        "type": "subflow:fec14295.8a46d",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "env": [],
        "x": 3080,
        "y": 380,
        "wires": [
            [
                "63f156bc.aed608"
            ],
            [],
            [
                "63f156bc.aed608"
            ]
        ]
    },
    {
        "id": "564bca04.e08854",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 260,
        "wires": [
            [
                "e5220084.3f59c"
            ]
        ]
    },
    {
        "id": "e5220084.3f59c",
        "type": "function",
        "z": "c7191d19.c1e7b",
        "name": "Start",
        "func": "context.global.startTime = new Date().getTime();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 420,
        "y": 260,
        "wires": [
            [
                "6aaa305f.aef59"
            ]
        ]
    },
    {
        "id": "4b43bcbe.e8e214",
        "type": "function",
        "z": "c7191d19.c1e7b",
        "name": "",
        "func": "var currentTime = new Date().getTime();\nvar timeElpased = (currentTime -context.global.startTime)\nmsg.payload = timeElpased / 1000\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 810,
        "y": 260,
        "wires": [
            [
                "6ad13589.f6ebec"
            ]
        ]
    },
    {
        "id": "6ad13589.f6ebec",
        "type": "debug",
        "z": "c7191d19.c1e7b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1080,
        "y": 260,
        "wires": []
    },
    {
        "id": "6aaa305f.aef59",
        "type": "delay",
        "z": "c7191d19.c1e7b",
        "name": "",
        "pauseType": "random",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "10",
        "randomUnits": "seconds",
        "drop": false,
        "x": 620,
        "y": 260,
        "wires": [
            [
                "4b43bcbe.e8e214"
            ]
        ]
    },
    {
        "id": "6bca89c5.5e7c58",
        "type": "delay",
        "z": "c7191d19.c1e7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "20",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 430,
        "y": 420,
        "wires": [
            [
                "13d2ee7a.5ebda2"
            ]
        ]
    },
    {
        "id": "eec5933a.c030f",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 420,
        "wires": [
            [
                "6bca89c5.5e7c58"
            ]
        ]
    },
    {
        "id": "13d2ee7a.5ebda2",
        "type": "debug",
        "z": "c7191d19.c1e7b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 630,
        "y": 420,
        "wires": []
    },
    {
        "id": "6e9cf58e.e6fb2c",
        "type": "trigger",
        "z": "dceb45d8.425368",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "250",
        "extend": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 740,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "cd549302.f2eef",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 580,
        "wires": [
            [
                "12006f03.25df01"
            ]
        ]
    },
    {
        "id": "12006f03.25df01",
        "type": "change",
        "z": "c7191d19.c1e7b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 580,
        "wires": [
            [
                "81c29c10.c4769"
            ]
        ]
    },
    {
        "id": "8d7e64a8.7349e8",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 640,
        "wires": [
            [
                "81c29c10.c4769"
            ]
        ]
    },
    {
        "id": "81c29c10.c4769",
        "type": "delay",
        "z": "c7191d19.c1e7b",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 680,
        "y": 640,
        "wires": [
            [
                "a91e297c.0447e8"
            ]
        ]
    },
    {
        "id": "a91e297c.0447e8",
        "type": "debug",
        "z": "c7191d19.c1e7b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 970,
        "y": 620,
        "wires": []
    },
    {
        "id": "f81c6cf8.0f401",
        "type": "link in",
        "z": "dceb45d8.425368",
        "name": "Matt Left",
        "links": [
            "6590eef7.36df6"
        ],
        "x": 535,
        "y": 160,
        "wires": [
            [
                "c10515b6.577c78"
            ]
        ]
    },
    {
        "id": "6590eef7.36df6",
        "type": "link out",
        "z": "a3158433.9d1f78",
        "name": "Matt Left",
        "links": [
            "2bed651f.90ee2a",
            "f81c6cf8.0f401"
        ],
        "x": 995,
        "y": 91,
        "wires": []
    },
    {
        "id": "d1dbd941.ea1448",
        "type": "switch",
        "z": "cd950567.f864b8",
        "name": "Good Payload",
        "property": "goodpayload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 740,
        "y": 280,
        "wires": [
            [],
            [
                "8620b0eb.c8e42",
                "9cf0022a.84784"
            ]
        ]
    },
    {
        "id": "29f17be6.082704",
        "type": "counter",
        "z": "c7191d19.c1e7b",
        "name": "",
        "init": "0",
        "step": "1",
        "lower": "",
        "upper": "",
        "mode": "increment",
        "outputs": "1",
        "x": 580,
        "y": 760,
        "wires": [
            [
                "b6ab72ec.1809c"
            ]
        ]
    },
    {
        "id": "e3c27111.ded22",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "5",
        "payloadType": "num",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 210,
        "y": 760,
        "wires": [
            [
                "29f17be6.082704"
            ]
        ]
    },
    {
        "id": "1cbfba1.8d14546",
        "type": "debug",
        "z": "c7191d19.c1e7b",
        "name": "done",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1130,
        "y": 840,
        "wires": []
    },
    {
        "id": "b147d528.768918",
        "type": "switch",
        "z": "c7191d19.c1e7b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "count",
                "vt": "msg"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 970,
        "y": 900,
        "wires": [
            [
                "1cbfba1.8d14546"
            ],
            [
                "29f17be6.082704",
                "3fb1cdcb.a65f32"
            ]
        ]
    },
    {
        "id": "e6966de2.d7197",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 150,
        "y": 880,
        "wires": [
            [
                "7bca777a.757688"
            ]
        ]
    },
    {
        "id": "7bca777a.757688",
        "type": "change",
        "z": "c7191d19.c1e7b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 880,
        "wires": [
            [
                "29f17be6.082704"
            ]
        ]
    },
    {
        "id": "3fb1cdcb.a65f32",
        "type": "debug",
        "z": "c7191d19.c1e7b",
        "name": "mess",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1130,
        "y": 900,
        "wires": []
    },
    {
        "id": "b6ab72ec.1809c",
        "type": "switch",
        "z": "c7191d19.c1e7b",
        "name": "",
        "property": "reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 750,
        "y": 760,
        "wires": [
            [
                "b147d528.768918"
            ]
        ]
    },
    {
        "id": "b823a8df.a826f8",
        "type": "counter",
        "z": "9a341993.fbc528",
        "name": "",
        "init": "0",
        "step": "1",
        "lower": "",
        "upper": "",
        "mode": "increment",
        "outputs": "1",
        "x": 760,
        "y": 160,
        "wires": [
            [
                "6c60f311.d0dcac"
            ]
        ]
    },
    {
        "id": "2fa1cf32.1c306",
        "type": "switch",
        "z": "9a341993.fbc528",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "count",
                "vt": "msg"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1150,
        "y": 300,
        "wires": [
            [
                "cb5fd0b9.f0996",
                "c7c38c9e.f6358"
            ],
            [
                "3e976e3b.b4d8a2",
                "5c47dd7f.176194"
            ]
        ]
    },
    {
        "id": "cb5fd0b9.f0996",
        "type": "change",
        "z": "9a341993.fbc528",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 100,
        "wires": [
            [
                "b823a8df.a826f8"
            ]
        ]
    },
    {
        "id": "6c60f311.d0dcac",
        "type": "switch",
        "z": "9a341993.fbc528",
        "name": "",
        "property": "reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 930,
        "y": 160,
        "wires": [
            [
                "2fa1cf32.1c306"
            ]
        ]
    },
    {
        "id": "841dbbf7.f8bb78",
        "type": "function",
        "z": "9a341993.fbc528",
        "name": "Adjust Conter",
        "func": "var val = msg.payload;\nif (val > 20) {\n   val = val -20;\n   msg.dir = \"up\";\n} else if (val < 20) {\n   val = 20 - val;\n   msg.dir = \"down\";\n} else {\n    val = 0;\n}\nmsg.payload = val;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 540,
        "y": 160,
        "wires": [
            [
                "b823a8df.a826f8"
            ]
        ]
    },
    {
        "id": "d518a0a9.2f721",
        "type": "server-state-changed",
        "z": "9a341993.fbc528",
        "name": "Tv Volume Change",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "input_number.tv_volume_change",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 130,
        "y": 160,
        "wires": [
            [
                "706c4797.6edd68"
            ]
        ]
    },
    {
        "id": "87a80779.608118",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "Volume Up",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_on",
        "data": "{   \"entity_id\": \"switch.tv_volume\" }",
        "mergecontext": "",
        "x": 1590,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "a446c097.612b1",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "Volume Down",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{   \"entity_id\": \"switch.tv_volume\" }",
        "mergecontext": "",
        "x": 1600,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "3e976e3b.b4d8a2",
        "type": "switch",
        "z": "9a341993.fbc528",
        "name": "",
        "property": "dir",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "down",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1400,
        "y": 320,
        "wires": [
            [
                "87a80779.608118"
            ],
            [
                "a446c097.612b1"
            ]
        ]
    },
    {
        "id": "5c47dd7f.176194",
        "type": "delay",
        "z": "9a341993.fbc528",
        "name": "",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 810,
        "y": 260,
        "wires": [
            [
                "b823a8df.a826f8"
            ]
        ]
    },
    {
        "id": "c7c38c9e.f6358",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_number",
        "service": "set_value",
        "data": "{\"entity_id\":\"input_number.tv_volume_change\",\"value\":\"20\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 1470,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "706c4797.6edd68",
        "type": "switch",
        "z": "9a341993.fbc528",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "20",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 310,
        "y": 160,
        "wires": [
            [
                "841dbbf7.f8bb78"
            ]
        ]
    },
    {
        "id": "93417511.0ebcd8",
        "type": "function",
        "z": "7355692b.0038c8",
        "name": "",
        "func": "var seconds = msg.payload;\n//var numyears = Math.floor(seconds / 31536000);\nvar numdays = Math.floor((seconds % 31536000) / 86400); \nvar numhours = Math.floor(((seconds % 31536000) % 86400) / 3600);\nvar numminutes = Math.floor((((seconds % 31536000) % 86400) % 3600) / 60);\nvar numseconds = (((seconds % 31536000) % 86400) % 3600) % 60;\n//msg.payload = numyears + \" years \" + \nmsg.payload = \"\";\nif (numdays > 0) {\n    msg.payload = numdays + \" days \" \n}\nif (numhours > 0) {\n    msg.payload = msg.payload + numhours + \" hours \" \n}\nmsg.payload = msg.payload + numminutes + \" minutes \" + Math.round(numseconds) + \" seconds\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 230,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "711ceb5.807fe14",
        "type": "subflow:7355692b.0038c8",
        "z": "c7191d19.c1e7b",
        "name": "",
        "env": [],
        "x": 480,
        "y": 180,
        "wires": [
            [
                "b3bacadd.eafab8"
            ]
        ]
    },
    {
        "id": "f0761190.01ad8",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "128",
        "payloadType": "num",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 190,
        "y": 180,
        "wires": [
            [
                "711ceb5.807fe14"
            ]
        ]
    },
    {
        "id": "b3bacadd.eafab8",
        "type": "debug",
        "z": "c7191d19.c1e7b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 750,
        "y": 180,
        "wires": []
    },
    {
        "id": "5cc13c0f.32a2b4",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "86528",
        "payloadType": "num",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 190,
        "y": 140,
        "wires": [
            [
                "711ceb5.807fe14"
            ]
        ]
    },
    {
        "id": "5cb14a6d.6175a4",
        "type": "inject",
        "z": "c7191d19.c1e7b",
        "name": "",
        "topic": "",
        "payload": "3728",
        "payloadType": "num",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 190,
        "y": 80,
        "wires": [
            [
                "711ceb5.807fe14"
            ]
        ]
    },
    {
        "id": "137bf256.d02bfe",
        "type": "rbe",
        "z": "a3158433.9d1f78",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 750,
        "y": 111,
        "wires": [
            [
                "cde91d89.de2be"
            ]
        ]
    },
    {
        "id": "52956d68.af7aa4",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 91,
        "wires": [
            [
                "137bf256.d02bfe"
            ]
        ]
    },
    {
        "id": "7ba936d7.0aba18",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 131,
        "wires": [
            [
                "137bf256.d02bfe"
            ]
        ]
    },
    {
        "id": "cde91d89.de2be",
        "type": "switch",
        "z": "a3158433.9d1f78",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 870,
        "y": 111,
        "wires": [
            [
                "6590eef7.36df6",
                "261e0b4c.0e67c4"
            ],
            [
                "fa841a56.1037e8",
                "46f08a7c.f9b394"
            ]
        ]
    },
    {
        "id": "261e0b4c.0e67c4",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "Matt Home",
        "func": "context.global.mattHomeStartTime = new Date().getTime();\n\nvar currentTime = new Date().getTime();\nvar timeElpased = (currentTime -context.global.mattLeaveStartTime)\nmsg.payload = timeElpased / 1000;\nmsg.homeAway = \"Home\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1050,
        "y": 51,
        "wires": [
            [
                "83d576bb.50f978"
            ]
        ]
    },
    {
        "id": "46f08a7c.f9b394",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "Matt Leave",
        "func": "context.global.mattLeaveStartTime = new Date().getTime();\n\nvar currentTime = new Date().getTime();\nvar timeElpased = (currentTime -context.global.mattHomeStartTime)\nmsg.payload = timeElpased / 1000\nmsg.homeAway = \"Away\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1050,
        "y": 167,
        "wires": [
            [
                "208ca481.a39efc"
            ]
        ]
    },
    {
        "id": "208ca481.a39efc",
        "type": "subflow:7355692b.0038c8",
        "z": "a3158433.9d1f78",
        "name": "",
        "env": [],
        "x": 1260,
        "y": 166,
        "wires": [
            [
                "689b6f85.e3471"
            ]
        ]
    },
    {
        "id": "83d576bb.50f978",
        "type": "subflow:7355692b.0038c8",
        "z": "a3158433.9d1f78",
        "name": "",
        "env": [],
        "x": 1260,
        "y": 51,
        "wires": [
            [
                "689b6f85.e3471"
            ]
        ]
    },
    {
        "id": "689b6f85.e3471",
        "type": "function",
        "z": "a3158433.9d1f78",
        "name": "Data",
        "func": "var r = \"Matt is now \" + msg.homeAway + \". \" + msg.payload;\n\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": r\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1510,
        "y": 100,
        "wires": [
            [
                "3d6830a6.4a911",
                "130cffbd.29d66"
            ]
        ]
    },
    {
        "id": "a5ee1acb.0128a8",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 1980,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "3d6830a6.4a911",
        "type": "debug",
        "z": "a3158433.9d1f78",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1650,
        "y": 60,
        "wires": []
    },
    {
        "id": "ff7bed56.cde45",
        "type": "inject",
        "z": "a3158433.9d1f78",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 820,
        "y": 40,
        "wires": [
            [
                "261e0b4c.0e67c4"
            ]
        ]
    },
    {
        "id": "130cffbd.29d66",
        "type": "change",
        "z": "a3158433.9d1f78",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "homeAway",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1720,
        "y": 100,
        "wires": [
            [
                "a5ee1acb.0128a8"
            ]
        ]
    },
    {
        "id": "de600384.13d1",
        "type": "inject",
        "z": "a3158433.9d1f78",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 820,
        "y": 160,
        "wires": [
            [
                "46f08a7c.f9b394"
            ]
        ]
    },
    {
        "id": "7532ac43.f4bc54",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "media_player",
        "service": "volume_set",
        "data": "{\"entity_id\":\"media_player.office\",\"volume_level\":\"0.1\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 510,
        "y": 2480,
        "wires": [
            []
        ]
    },
    {
        "id": "85bbe655.9ced88",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 150,
        "y": 2480,
        "wires": [
            [
                "7532ac43.f4bc54"
            ]
        ]
    },
    {
        "id": "e880a854.db5a98",
        "type": "subflow:56368b94.f11494",
        "z": "a068bd5.28a8d4",
        "name": "",
        "x": 420,
        "y": 1920,
        "wires": [
            [
                "e28df683.3ce3d8"
            ],
            [],
            [
                "e28df683.3ce3d8"
            ]
        ]
    },
    {
        "id": "a16d7201.bd4a3",
        "type": "mqtt in",
        "z": "84ed1066.f22de",
        "name": "",
        "topic": "shellies/shellyht-E00E22/sensor/temperature",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 230,
        "y": 180,
        "wires": [
            [
                "e5beba83.142648",
                "e22c7f3e.a84ad",
                "5973e3f4.6edb9c"
            ]
        ]
    },
    {
        "id": "e5beba83.142648",
        "type": "switch",
        "z": "84ed1066.f22de",
        "name": "Warmer Then 6C",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "6",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "6",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 570,
        "y": 200,
        "wires": [
            [
                "af9fa763.602c18"
            ],
            [
                "6dae2581.18d8fc"
            ]
        ]
    },
    {
        "id": "b89a4f68.e80b4",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{    \"message\": \"Warning! Frigde is greater then 6C\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1680,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "5dd0e20c.1b737c",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Frigde temperature restored\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1680,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "818a6a7a.bf8988",
        "type": "mqtt out",
        "z": "84ed1066.f22de",
        "name": "",
        "topic": "Fridge/Status",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1030,
        "y": 100,
        "wires": []
    },
    {
        "id": "af9fa763.602c18",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "To Hot",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "To Hot",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 180,
        "wires": [
            [
                "818a6a7a.bf8988",
                "dffc412b.555e2"
            ]
        ]
    },
    {
        "id": "6dae2581.18d8fc",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "Good",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Good",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 220,
        "wires": [
            [
                "818a6a7a.bf8988",
                "5c381bb1.1c40b4",
                "81a9b11b.31e23"
            ]
        ]
    },
    {
        "id": "5c381bb1.1c40b4",
        "type": "rbe",
        "z": "84ed1066.f22de",
        "name": "",
        "func": "rbei",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 1290,
        "y": 220,
        "wires": [
            [
                "ca1972ac.01e52"
            ]
        ]
    },
    {
        "id": "ca1972ac.01e52",
        "type": "switch",
        "z": "84ed1066.f22de",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "To Hot",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Good",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1450,
        "y": 180,
        "wires": [
            [
                "b89a4f68.e80b4",
                "6d31ab7b.eb7514"
            ],
            [
                "5dd0e20c.1b737c",
                "4fc7334b.b81cac"
            ]
        ]
    },
    {
        "id": "5973e3f4.6edb9c",
        "type": "trigger",
        "z": "84ed1066.f22de",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "4",
        "extend": true,
        "units": "hr",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 545,
        "y": 360,
        "wires": [
            [
                "241a99d9.e13a76",
                "fd4bf7a6.bc1f68",
                "47c93fd7.a79cb"
            ]
        ]
    },
    {
        "id": "241a99d9.e13a76",
        "type": "mqtt out",
        "z": "84ed1066.f22de",
        "name": "availability/fridgeshelly",
        "topic": "availability/fridgeshelly",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 875,
        "y": 420,
        "wires": []
    },
    {
        "id": "e22c7f3e.a84ad",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bedroom",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 525,
        "y": 400,
        "wires": [
            [
                "241a99d9.e13a76"
            ]
        ]
    },
    {
        "id": "cc3b2a14.4f2478",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Fridge Shelly - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1155,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "fd4bf7a6.bc1f68",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Fridge has not posted an update in the last 4 hours",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Frigde Shell HT",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 845,
        "y": 340,
        "wires": [
            [
                "51f52cc1.b9deb4"
            ]
        ]
    },
    {
        "id": "51f52cc1.b9deb4",
        "type": "link out",
        "z": "84ed1066.f22de",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 1050,
        "y": 340,
        "wires": []
    },
    {
        "id": "47c93fd7.a79cb",
        "type": "subflow:85970b46.61e358",
        "z": "84ed1066.f22de",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 855,
        "y": 380,
        "wires": [
            [
                "cc3b2a14.4f2478"
            ],
            []
        ]
    },
    {
        "id": "4199bfba.1277",
        "type": "comment",
        "z": "84ed1066.f22de",
        "name": "Check Temp",
        "info": "",
        "x": 550,
        "y": 120,
        "wires": []
    },
    {
        "id": "fc766fed.708d3",
        "type": "comment",
        "z": "84ed1066.f22de",
        "name": "Check for check in",
        "info": "",
        "x": 570,
        "y": 300,
        "wires": []
    },
    {
        "id": "38dec50a.659a9a",
        "type": "mqtt in",
        "z": "84ed1066.f22de",
        "name": "",
        "topic": "shellies/shellyht-E00E22/sensor/battery",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 210,
        "y": 560,
        "wires": [
            [
                "21a98a7.149a476"
            ]
        ]
    },
    {
        "id": "21a98a7.149a476",
        "type": "switch",
        "z": "84ed1066.f22de",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "20",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 480,
        "y": 560,
        "wires": [
            [
                "44bd4ee1.98529"
            ]
        ]
    },
    {
        "id": "44bd4ee1.98529",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Frigde shelly has less then 20% battery!\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 780,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "1f592428.b2c4ac",
        "type": "mqtt in",
        "z": "84ed1066.f22de",
        "name": "",
        "topic": "shellies/shellyht-E00E0F/sensor/temperature",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 230,
        "y": 920,
        "wires": [
            [
                "de75af60.1d9fc",
                "f6e6db82.702fe8",
                "ef5c0f7b.2f341"
            ]
        ]
    },
    {
        "id": "de75af60.1d9fc",
        "type": "switch",
        "z": "84ed1066.f22de",
        "name": "Warmer Then -20C",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "-20",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "-20",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 570,
        "y": 940,
        "wires": [
            [
                "16a78b98.5ad494"
            ],
            [
                "fc7c3b76.11baa8"
            ]
        ]
    },
    {
        "id": "cb576c15.2bb82",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Warning! Feezer is greater then -20C\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1420,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "8cc3d334.3571e",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Freezer temperature restored\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1420,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "51dc882d.3e4d38",
        "type": "mqtt out",
        "z": "84ed1066.f22de",
        "name": "",
        "topic": "Freezer/Status",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1040,
        "y": 860,
        "wires": []
    },
    {
        "id": "16a78b98.5ad494",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "To Hot",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "To Hot",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 920,
        "wires": [
            [
                "51dc882d.3e4d38",
                "4725cb5c.b4f804"
            ]
        ]
    },
    {
        "id": "fc7c3b76.11baa8",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "Good",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Good",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 960,
        "wires": [
            [
                "51dc882d.3e4d38",
                "4725cb5c.b4f804"
            ]
        ]
    },
    {
        "id": "4725cb5c.b4f804",
        "type": "rbe",
        "z": "84ed1066.f22de",
        "name": "",
        "func": "rbei",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 1010,
        "y": 940,
        "wires": [
            [
                "15f6a55e.481aeb"
            ]
        ]
    },
    {
        "id": "15f6a55e.481aeb",
        "type": "switch",
        "z": "84ed1066.f22de",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "To Hot",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Good",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 940,
        "wires": [
            [
                "cb576c15.2bb82",
                "46a1164f.bc0e28",
                "3d5bb7f0.7d5888"
            ],
            [
                "8cc3d334.3571e"
            ]
        ]
    },
    {
        "id": "ef5c0f7b.2f341",
        "type": "trigger",
        "z": "84ed1066.f22de",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "4",
        "extend": true,
        "units": "hr",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 545,
        "y": 1100,
        "wires": [
            [
                "d8894444.6e9cc8",
                "8a1eb863.bf6f18",
                "3eb28781.04e518"
            ]
        ]
    },
    {
        "id": "d8894444.6e9cc8",
        "type": "mqtt out",
        "z": "84ed1066.f22de",
        "name": "availability/freezershelly",
        "topic": "availability/freezershelly",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 885,
        "y": 1160,
        "wires": []
    },
    {
        "id": "f6e6db82.702fe8",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bedroom",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 525,
        "y": 1140,
        "wires": [
            [
                "d8894444.6e9cc8"
            ]
        ]
    },
    {
        "id": "4d5cf8c7.198318",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Fridge Shelly - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1155,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "8a1eb863.bf6f18",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Freezer has not posted an update in the last 4 hours",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Freezer Shell HT",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 845,
        "y": 1080,
        "wires": [
            [
                "748d8b68.2ac2f4"
            ]
        ]
    },
    {
        "id": "748d8b68.2ac2f4",
        "type": "link out",
        "z": "84ed1066.f22de",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 1050,
        "y": 1080,
        "wires": []
    },
    {
        "id": "3eb28781.04e518",
        "type": "subflow:85970b46.61e358",
        "z": "84ed1066.f22de",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 855,
        "y": 1120,
        "wires": [
            [
                "4d5cf8c7.198318"
            ],
            []
        ]
    },
    {
        "id": "fdc1e76f.ffdb48",
        "type": "comment",
        "z": "84ed1066.f22de",
        "name": "Check Temp",
        "info": "",
        "x": 550,
        "y": 860,
        "wires": []
    },
    {
        "id": "8cf7e29f.7cd",
        "type": "comment",
        "z": "84ed1066.f22de",
        "name": "Check for check in",
        "info": "",
        "x": 570,
        "y": 1040,
        "wires": []
    },
    {
        "id": "5162fe41.58231",
        "type": "mqtt in",
        "z": "84ed1066.f22de",
        "name": "",
        "topic": "shellies/shellyht-E00E0F/sensor/battery",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 210,
        "y": 1300,
        "wires": [
            [
                "6e1c0d67.a4e2b4"
            ]
        ]
    },
    {
        "id": "6e1c0d67.a4e2b4",
        "type": "switch",
        "z": "84ed1066.f22de",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "20",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 530,
        "y": 1300,
        "wires": [
            [
                "f6fb7193.143eb"
            ]
        ]
    },
    {
        "id": "f6fb7193.143eb",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Frigde shelly has less then 20% battery!\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 780,
        "y": 1300,
        "wires": [
            []
        ]
    },
    {
        "id": "dffc412b.555e2",
        "type": "trigger",
        "z": "84ed1066.f22de",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "40",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1130,
        "y": 160,
        "wires": [
            [
                "5c381bb1.1c40b4"
            ]
        ]
    },
    {
        "id": "81a9b11b.31e23",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 260,
        "wires": [
            [
                "dffc412b.555e2"
            ]
        ]
    },
    {
        "id": "2e01df80.788d4",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 150,
        "y": 2680,
        "wires": [
            [
                "482adf50.d5a9b"
            ]
        ]
    },
    {
        "id": "482adf50.d5a9b",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"spotify:playlist:Matt Awesomeness\",\"media_content_type\":\"SPOTIFY\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 480,
        "y": 2680,
        "wires": [
            []
        ]
    },
    {
        "id": "4e651081.a3f9d",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "alexa_tts",
        "data": "{\"entity_id\":\"media_player.office\",\"message\":\"test\",\"type\":\"announce\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 620,
        "y": 3380,
        "wires": [
            []
        ]
    },
    {
        "id": "c0d4f9e5.21d478",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 260,
        "y": 3380,
        "wires": [
            [
                "4e651081.a3f9d"
            ]
        ]
    },
    {
        "id": "d72255a3.a81358",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "alexa_media_office",
        "data": "{    \"message\": \"test\"    ,\"data\":{\"type\":\"announce\", \"method\":\"speak\"}}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 630,
        "y": 3500,
        "wires": [
            []
        ]
    },
    {
        "id": "15af48c.64eaeb7",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 260,
        "y": 3500,
        "wires": [
            [
                "d72255a3.a81358"
            ]
        ]
    },
    {
        "id": "227c52a.611f8ae",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "working announce",
        "info": "",
        "x": 270,
        "y": 3460,
        "wires": []
    },
    {
        "id": "ad0df8c3.8338f8",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "alexa_media_office",
        "data": "{    \"message\": \"<amazon:effect name='whispered'>hello</amazon:effect>\",    \"data\": {        \"type\": \"announce\",        \"method\": \"speak\"    }}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 630,
        "y": 3620,
        "wires": [
            []
        ]
    },
    {
        "id": "52d3d825.33e748",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 260,
        "y": 3620,
        "wires": [
            [
                "ad0df8c3.8338f8"
            ]
        ]
    },
    {
        "id": "e5ddff.761fe2",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "working announce wisper",
        "info": "",
        "x": 290,
        "y": 3580,
        "wires": []
    },
    {
        "id": "514977ec.00c9e8",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "alexa_media_danielle_s_echo_dot",
        "data": "{    \"message\": \"<amazon:effect name='whispered'>love you!!</amazon:effect>\",    \"data\": {        \"type\": \"tts\",        \"method\": \"speak\"    }}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 670,
        "y": 3760,
        "wires": [
            []
        ]
    },
    {
        "id": "5ef43786.725918",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 260,
        "y": 3760,
        "wires": [
            [
                "514977ec.00c9e8"
            ]
        ]
    },
    {
        "id": "db5147a9.fcaec8",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "working announce",
        "info": "",
        "x": 270,
        "y": 3720,
        "wires": []
    },
    {
        "id": "786ad735.4c75c8",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "alexa_media_office",
        "data": "{    \"message\": \"<amazon:effect name='whispered'>love you</amazon:effect>\",    \"data\": {        \"type\": \"announce\",        \"method\": \"speak\"    }}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 650,
        "y": 3900,
        "wires": [
            []
        ]
    },
    {
        "id": "5bb45e59.7d733",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 260,
        "y": 3900,
        "wires": [
            [
                "786ad735.4c75c8"
            ]
        ]
    },
    {
        "id": "92fc2547.287d18",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "alexa_media_danielle_s_echo_dot",
        "data": "{    \"message\": \"<amazon:effect name='whispered'>love you</amazon:effect>\",    \"data\": {        \"type\": \"announce\",        \"method\": \"speak\"    }}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 670,
        "y": 3840,
        "wires": [
            []
        ]
    },
    {
        "id": "6018e4ec.eb39bc",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 240,
        "y": 3840,
        "wires": [
            [
                "92fc2547.287d18"
            ]
        ]
    },
    {
        "id": "cb412e26.b7636",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "play_media",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"test hass\",\"media_content_type\":\"routine\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 550,
        "y": 4180,
        "wires": [
            []
        ]
    },
    {
        "id": "1142b998.0c38a6",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 220,
        "y": 4180,
        "wires": [
            [
                "cb412e26.b7636"
            ]
        ]
    },
    {
        "id": "43eefc64.84b834",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "routine",
        "info": "routine",
        "x": 210,
        "y": 4100,
        "wires": []
    },
    {
        "id": "fc85022.e94dc",
        "type": "alexa-home",
        "z": "48ba348c.61270c",
        "conf": "3fa4c0fe.0f3ed",
        "device": "55337",
        "acknoledge": true,
        "name": "Test Alexa",
        "topic": "",
        "x": 140,
        "y": 2160,
        "wires": [
            [
                "133788d9.3c7a57",
                "7de9701c.ad9a5"
            ]
        ]
    },
    {
        "id": "badd92c3.692f9",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Call Routine",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "play_media",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"test hass\",\"media_content_type\":\"routine\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 410,
        "y": 2100,
        "wires": [
            []
        ]
    },
    {
        "id": "41fcb984.0bf2d8",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Alexa Inbound",
        "info": "",
        "x": 150,
        "y": 2040,
        "wires": []
    },
    {
        "id": "b7739156.649f8",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "Every 4 Minutes",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "240",
        "crontab": "",
        "once": true,
        "onceDelay": "60",
        "x": 170,
        "y": 2100,
        "wires": [
            []
        ]
    },
    {
        "id": "133788d9.3c7a57",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "17",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 430,
        "y": 2160,
        "wires": [
            [
                "60cb00c7.59c35",
                "e59d24a3.cbfcd8",
                "e271efdf.ff522"
            ]
        ]
    },
    {
        "id": "60cb00c7.59c35",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/alexaInbound",
        "topic": "availability/alexaInbound",
        "qos": "0",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 770,
        "y": 2220,
        "wires": []
    },
    {
        "id": "7de9701c.ad9a5",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.bedroom",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 2220,
        "wires": [
            [
                "60cb00c7.59c35"
            ]
        ]
    },
    {
        "id": "c9acc3a9.53cf3",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Alexa Inbound - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1040,
        "y": 2180,
        "wires": [
            []
        ]
    },
    {
        "id": "e59d24a3.cbfcd8",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Alexa Inbound Command Failure ",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Alex inbound polling failed",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 2140,
        "wires": [
            [
                "e81c2f88.73a11"
            ]
        ]
    },
    {
        "id": "e81c2f88.73a11",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 935,
        "y": 2140,
        "wires": []
    },
    {
        "id": "e271efdf.ff522",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 740,
        "y": 2180,
        "wires": [
            [
                "c9acc3a9.53cf3"
            ],
            []
        ]
    },
    {
        "id": "da9d8fb4.7e958",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "10 Second After Start up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 190,
        "y": 2220,
        "wires": [
            [
                "133788d9.3c7a57",
                "7de9701c.ad9a5"
            ]
        ]
    },
    {
        "id": "1d8854f0.d579fb",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "media_player",
        "service": "play_media",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"spotify:song\",\"media_content_type\":\"SPOTIFY\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 530,
        "y": 4480,
        "wires": [
            []
        ]
    },
    {
        "id": "4617748e.27d67c",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 190,
        "y": 4480,
        "wires": [
            [
                "1d8854f0.d579fb"
            ]
        ]
    },
    {
        "id": "b4eafbdf.3701c8",
        "type": "comment",
        "z": "1f9e3480.5be75c",
        "name": "play my musise",
        "info": "routine",
        "x": 220,
        "y": 4420,
        "wires": []
    },
    {
        "id": "ab73663a.33f708",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "media_player",
        "service": "play_media",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"spotify:tracks\",\"media_content_type\":\"SPOTIFY\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 530,
        "y": 4540,
        "wires": [
            []
        ]
    },
    {
        "id": "fa722fb9.2311d",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 190,
        "y": 4540,
        "wires": [
            [
                "ab73663a.33f708"
            ]
        ]
    },
    {
        "id": "8ffe3f9.cb0b8c",
        "type": "api-call-service",
        "z": "a0cdc0f9.a362b",
        "name": "Alexa Shower Time - Routine",
        "server": "eef5a84.da24f58",
        "service_domain": "media_player",
        "service": "play_media",
        "data": "{\"entity_id\":\"media_player.office\",\"media_content_id\":\"shower time\",\"media_content_type\":\"routine\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 720,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "6c3320de.22c4",
        "type": "comment",
        "z": "a0cdc0f9.a362b",
        "name": "Shower Time",
        "info": "",
        "x": 150,
        "y": 1320,
        "wires": []
    },
    {
        "id": "8fa41eed.e0746",
        "type": "link in",
        "z": "a0cdc0f9.a362b",
        "name": "",
        "links": [],
        "x": 100,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "402e1b88.8e6d14",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Bath Room Door",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "binary_sensor.bathroom_door",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 120,
        "y": 480,
        "wires": [
            [
                "f6e880d3.d5189",
                "6f485fb3.adf71"
            ]
        ]
    },
    {
        "id": "f6e880d3.d5189",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Bathroom Door Open",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Bathroom Door Open",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 480,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "6f485fb3.adf71",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Bathroom Door",
        "links": [
            "4fe3f102.783b3"
        ],
        "x": 355,
        "y": 520,
        "wires": []
    },
    {
        "id": "d96fd86e.a642e8",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Kitchen Cam",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "binary_sensor.kitchencam_motion_sensor",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 110,
        "y": 640,
        "wires": [
            [
                "decef216.64021",
                "f8efe1fe.a4a0e"
            ]
        ]
    },
    {
        "id": "decef216.64021",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Kitchen Cam Motion Detected",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Kitchen Cam Motion Detected",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "trusted",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 640,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "f8efe1fe.a4a0e",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Kitchen cam Motion Detected",
        "links": [
            "8f80ab0d.e271b8"
        ],
        "x": 355,
        "y": 680,
        "wires": []
    },
    {
        "id": "7a16963d.9235c8",
        "type": "server-state-changed",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "entityidfilter": "sensor.last_alexa",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "haltifstate": "",
        "outputs": 1,
        "x": 250,
        "y": 4800,
        "wires": [
            [
                "c8f6ce16.1e173"
            ]
        ]
    },
    {
        "id": "c8f6ce16.1e173",
        "type": "debug",
        "z": "1f9e3480.5be75c",
        "name": "Last Alexa State Changed",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 610,
        "y": 4800,
        "wires": []
    },
    {
        "id": "b3fa2d76.559f8",
        "type": "inject",
        "z": "1f9e3480.5be75c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 4700,
        "wires": [
            [
                "9b6fe914.4d32e8"
            ]
        ]
    },
    {
        "id": "9b6fe914.4d32e8",
        "type": "api-call-service",
        "z": "1f9e3480.5be75c",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "alexa_media",
        "service": "update_last_called",
        "data": "",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "x": 560,
        "y": 4700,
        "wires": [
            []
        ]
    },
    {
        "id": "7186346f.4ab48c",
        "type": "delay",
        "z": "99d64a3d.f4e418",
        "name": "wait 25 min",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "hours",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 850,
        "y": 340,
        "wires": [
            [
                "a961f727.8da2a8",
                "8f9c705.d69fb9"
            ]
        ]
    },
    {
        "id": "46a1164f.bc0e28",
        "type": "trigger",
        "z": "84ed1066.f22de",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "-15",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1650,
        "y": 900,
        "wires": [
            [
                "b252c457.5fe1b8"
            ]
        ]
    },
    {
        "id": "b252c457.5fe1b8",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Warning! Feezer is still greater then -20C\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 1900,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "3d5bb7f0.7d5888",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1420,
        "y": 940,
        "wires": [
            [
                "46a1164f.bc0e28"
            ]
        ]
    },
    {
        "id": "6d31ab7b.eb7514",
        "type": "trigger",
        "z": "84ed1066.f22de",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "-15",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1930,
        "y": 120,
        "wires": [
            [
                "87751cc2.966a4"
            ]
        ]
    },
    {
        "id": "87751cc2.966a4",
        "type": "api-call-service",
        "z": "84ed1066.f22de",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{    \"message\": \"Warning! Frigde is still greater then 6C\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 2180,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "4fc7334b.b81cac",
        "type": "change",
        "z": "84ed1066.f22de",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 180,
        "wires": [
            [
                "6d31ab7b.eb7514"
            ]
        ]
    },
    {
        "id": "31cbc1c6.2545be",
        "type": "mqtt in",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "topic": "kitchen/dishwasherLDR",
        "qos": "2",
        "datatype": "utf8",
        "broker": "1b6bc4ba.56ff4b",
        "x": 240,
        "y": 100,
        "wires": [
            [
                "87aeda18.66c048"
            ]
        ]
    },
    {
        "id": "90c2b8ec.3950d8",
        "type": "function",
        "z": "6e74caff.7ad1f4",
        "name": "Data",
        "func": "msg.payloadvalue = msg.payload\nmsg.payload = \n{\n  \"data\": \n  {\n    \"message\": \"Diswasher Status \" + msg.payload\n  }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 100,
        "wires": [
            [
                "3af1fdf9.c39842",
                "2266c996.db78e6"
            ]
        ]
    },
    {
        "id": "87aeda18.66c048",
        "type": "rbe",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "func": "rbei",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 430,
        "y": 100,
        "wires": [
            [
                "90c2b8ec.3950d8",
                "40895bf9.d34864",
                "5b45d804.3fbd78"
            ]
        ]
    },
    {
        "id": "3af1fdf9.c39842",
        "type": "debug",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1050,
        "y": 60,
        "wires": []
    },
    {
        "id": "dd3eec86.c33db",
        "type": "change",
        "z": "5625076e.ee59e8",
        "name": "Have a good lunch",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "Have a good lunch. Timer set",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "LunchTime.BeenTrigged",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 340,
        "wires": [
            [
                "bc429cf8.fed8b"
            ]
        ]
    },
    {
        "id": "bc429cf8.fed8b",
        "type": "subflow:47bc2d66.1132e4",
        "z": "5625076e.ee59e8",
        "name": "",
        "env": [],
        "x": 650,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "c180db42.37b678",
        "type": "change",
        "z": "6e74caff.7ad1f4",
        "name": "Dishwasher done",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "the dish washer has finished",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "down",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1050,
        "y": 220,
        "wires": [
            [
                "7db16e01.687d6",
                "758ca086.931b9"
            ]
        ]
    },
    {
        "id": "7db16e01.687d6",
        "type": "subflow:47bc2d66.1132e4",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "env": [],
        "x": 1270,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "40895bf9.d34864",
        "type": "switch",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Running",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 850,
        "y": 240,
        "wires": [
            [
                "c180db42.37b678"
            ],
            [
                "96c28029.cbc45"
            ]
        ]
    },
    {
        "id": "96c28029.cbc45",
        "type": "change",
        "z": "6e74caff.7ad1f4",
        "name": "Dishwasher Started",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "the dish washer has started",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "alexa",
                "pt": "msg",
                "to": "Kitchen",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1050,
        "y": 260,
        "wires": [
            [
                "7db16e01.687d6",
                "758ca086.931b9"
            ]
        ]
    },
    {
        "id": "3d3fb4fe.b5ba7c",
        "type": "change",
        "z": "47bc2d66.1132e4",
        "name": "Kitchen",
        "rules": [
            {
                "t": "set",
                "p": "pri_alexa",
                "pt": "msg",
                "to": "[\"media_player.kitten\"]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 260,
        "wires": [
            [
                "c5f11237.56983"
            ]
        ]
    },
    {
        "id": "758ca086.931b9",
        "type": "debug",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1310,
        "y": 280,
        "wires": []
    },
    {
        "id": "84f95833.944a98",
        "type": "comment",
        "z": "48ba348c.61270c",
        "name": "Office Availability",
        "info": "",
        "x": 160,
        "y": 2360,
        "wires": []
    },
    {
        "id": "c3c81fe2.07c17",
        "type": "mqtt in",
        "z": "48ba348c.61270c",
        "name": "",
        "topic": "checkIn/kitchenMCU",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 170,
        "y": 2400,
        "wires": [
            [
                "4cd31c18.781db4",
                "4eccd077.9722e"
            ]
        ]
    },
    {
        "id": "4cd31c18.781db4",
        "type": "trigger",
        "z": "48ba348c.61270c",
        "op1": "",
        "op2": "offline",
        "op1type": "nul",
        "op2type": "str",
        "duration": "8",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 450,
        "y": 2380,
        "wires": [
            [
                "396d016d.b31cfe",
                "1eee9814.8d00c8",
                "edc2a997.3d0a08"
            ]
        ]
    },
    {
        "id": "396d016d.b31cfe",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "availability/kitchenMCU",
        "topic": "availability/kitchenMCU",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 790,
        "y": 2440,
        "wires": []
    },
    {
        "id": "4eccd077.9722e",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "online",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "devicecheckin.office",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 2420,
        "wires": [
            [
                "396d016d.b31cfe"
            ]
        ]
    },
    {
        "id": "59f7b45d.52c54c",
        "type": "api-call-service",
        "z": "48ba348c.61270c",
        "name": "Lett Matt Know",
        "server": "eef5a84.da24f58",
        "service_domain": "notify",
        "service": "mattiphone",
        "data": "{\"message\":\"Kitchen Node MCU - Offline\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 980,
        "y": 2400,
        "wires": [
            []
        ]
    },
    {
        "id": "1eee9814.8d00c8",
        "type": "change",
        "z": "48ba348c.61270c",
        "name": "Fault Details",
        "rules": [
            {
                "t": "set",
                "p": "fault.name",
                "pt": "msg",
                "to": "Kitchen Node MCU has not checked in",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.item",
                "pt": "msg",
                "to": "Kitchen Node MCU",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fault.actiontofix",
                "pt": "msg",
                "to": "Restart office node mcu.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 2360,
        "wires": [
            [
                "38b94500.07dd2c"
            ]
        ]
    },
    {
        "id": "38b94500.07dd2c",
        "type": "link out",
        "z": "48ba348c.61270c",
        "name": "Fault Detected",
        "links": [
            "c6717092.75d4b"
        ],
        "x": 955,
        "y": 2360,
        "wires": []
    },
    {
        "id": "edc2a997.3d0a08",
        "type": "subflow:85970b46.61e358",
        "z": "48ba348c.61270c",
        "name": "",
        "env": [
            {
                "name": "NoteType",
                "type": "str",
                "value": "FAULT_DETECTION"
            }
        ],
        "x": 760,
        "y": 2400,
        "wires": [
            [
                "59f7b45d.52c54c"
            ],
            []
        ]
    },
    {
        "id": "28fa280.0f108d8",
        "type": "function",
        "z": "a83e69e1.4b2ab8",
        "name": "Data",
        "func": "var mess = env.get(\"message\")\nvar title = env.get(\"title\")\n\nvar notification_id = env.get(\"notification_id\")\n\nvar who = env.get(\"who\")\nvar target;\nif (who == \"Matt\") {\n   target = \"mattiphone_iphone_10smax\"\n} else if (who == \"Danni\") {\n   target = \"mattiphone_danni_iphonexr\" \n} else if (who == \"\") {\n    target = \"\"\n} else {\n   target = \"mattiphone\"\n}\n\n\nif (mess == \"PAYLOAD\") {\n    msg.payload = \n    {\n      \"service\": target,\n      \"data\": msg.payload.data \n    }\n} else {\n    msg.payload = \n    {\n      \"service\": target,\n      \"data\": \n      {\n        \"message\": mess\n      }\n    }\n}\n\nvar createNot = null\nvar clearNot = null\nif( notification_id !== \"\" ) {\n    if (title == \"CLEARED\") {\n        clearNot = {\n         \"payload\": {\n             \"data\": {\n                    \"notification_id\":notification_id\n                }\n            }\n        }\n    } else {\n        createNot = {\n         \"payload\": {\n             \"data\": {\n                    \"message\": mess,\n                    \"title\": title,\n                    \"notification_id\":notification_id\n                }\n            }\n        }\n    }\n    \n}\n\n\nif (target == \"\") {\n    msg = null\n}\n\n\nreturn [msg,createNot,clearNot];",
        "outputs": 3,
        "noerr": 0,
        "x": 450,
        "y": 180,
        "wires": [
            [
                "839c216a.4a97d"
            ],
            [
                "107302af.bf410d"
            ],
            [
                "21ae6270.68b64e"
            ]
        ]
    },
    {
        "id": "c33a81d7.395f2",
        "type": "catch",
        "z": "5625076e.ee59e8",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "a58559a5.eca708"
            ]
        ]
    },
    {
        "id": "a58559a5.eca708",
        "type": "subflow:f5eab19a.7cf17",
        "z": "5625076e.ee59e8",
        "name": "",
        "env": [],
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "b3b81baa.5c2938",
        "type": "comment",
        "z": "5625076e.ee59e8",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "89db94b2.2cd5c8",
        "type": "inject",
        "z": "48ba348c.61270c",
        "name": "10 Second After Start up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "0",
        "x": 490,
        "y": 1020,
        "wires": [
            [
                "644d8797.711c28"
            ]
        ]
    },
    {
        "id": "644d8797.711c28",
        "type": "mqtt out",
        "z": "48ba348c.61270c",
        "name": "btmonitor/scan/restart",
        "topic": "btmonitor/scan/restart",
        "qos": "2",
        "retain": "true",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1060,
        "y": 1020,
        "wires": []
    },
    {
        "id": "e1a0cf09.c2cb",
        "type": "api-call-service",
        "z": "c9b308f8.01ef68",
        "name": "Living Room Lam,p",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "turn_off",
        "data": "{\"entity_id\":\"light.bed_room_lamp\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 250,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "2266c996.db78e6",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "PAYLOAD"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Both"
            }
        ],
        "x": 1060,
        "y": 100,
        "wires": []
    },
    {
        "id": "8620b0eb.c8e42",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "cd950567.f864b8",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "PAYLOAD"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            }
        ],
        "x": 1000,
        "y": 280,
        "wires": []
    },
    {
        "id": "9cf0022a.84784",
        "type": "debug",
        "z": "cd950567.f864b8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 970,
        "y": 320,
        "wires": []
    },
    {
        "id": "93fd391a.057098",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "b8a16318.b66a5",
        "name": "Let Matt Know",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Node red started"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            }
        ],
        "x": 500,
        "y": 700,
        "wires": []
    },
    {
        "id": "ae019a30.ff6f78",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "d1172b8b.3d3298",
        "name": "Let Both Know",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Door ball been pressed"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Both"
            }
        ],
        "x": 700,
        "y": 180,
        "wires": []
    },
    {
        "id": "740c59e5.4fccd8",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "a3158433.9d1f78",
        "name": "Let Both Know",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Arming Alarm"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Both"
            }
        ],
        "x": 480,
        "y": 1220,
        "wires": []
    },
    {
        "id": "23bafa9c.c59eb6",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "a3158433.9d1f78",
        "name": "Let Both Know",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Some one home"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Both"
            }
        ],
        "x": 240,
        "y": 960,
        "wires": []
    },
    {
        "id": "ae6cd96b.088a18",
        "type": "delay",
        "z": "a068bd5.28a8d4",
        "name": "",
        "pauseType": "timed",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "5",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 440,
        "y": 893,
        "wires": [
            [
                "9c585f5f.3d0d4"
            ]
        ]
    },
    {
        "id": "d6906ef5.59f6d",
        "type": "mqtt out",
        "z": "cd950567.f864b8",
        "name": "Restart Tracker",
        "topic": "btmonitor/scan/restart",
        "qos": "0",
        "retain": "false",
        "broker": "1b6bc4ba.56ff4b",
        "x": 400,
        "y": 740,
        "wires": []
    },
    {
        "id": "bdd13f50.74924",
        "type": "inject",
        "z": "cd950567.f864b8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 160,
        "y": 740,
        "wires": [
            [
                "d6906ef5.59f6d"
            ]
        ]
    },
    {
        "id": "a6f67c64.7b979",
        "type": "mqtt out",
        "z": "b8a16318.b66a5",
        "name": "Restart Tracker",
        "topic": "btmonitor/scan/restart",
        "qos": "0",
        "retain": "false",
        "broker": "1b6bc4ba.56ff4b",
        "x": 340,
        "y": 940,
        "wires": []
    },
    {
        "id": "8b4076b0.a87368",
        "type": "inject",
        "z": "b8a16318.b66a5",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "43200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 940,
        "wires": [
            [
                "a6f67c64.7b979"
            ]
        ]
    },
    {
        "id": "96744777.ee4268",
        "type": "mqtt out",
        "z": "b8a16318.b66a5",
        "name": "Restart Tracker",
        "topic": "btmonitor/scan/restart",
        "qos": "0",
        "retain": "false",
        "broker": "1b6bc4ba.56ff4b",
        "x": 280,
        "y": 760,
        "wires": []
    },
    {
        "id": "879b2b35.d68d68",
        "type": "comment",
        "z": "b8a16318.b66a5",
        "name": "Restart Bluetooth",
        "info": "",
        "x": 120,
        "y": 880,
        "wires": []
    },
    {
        "id": "93002185.91156",
        "type": "api-call-service",
        "z": "b8a16318.b66a5",
        "name": "Snapshot_Partial",
        "server": "5ee4d578.f7736c",
        "service_domain": "hassio",
        "service": "snapshot_partial",
        "data": "{\"addons\":[\"a0d7b954_appdaemon3\",\"a0d7b954_influxdb\",\"a0d7b954_sonweb\",\"core_mosquitto\",\"15ef4d2f_esphome\",\"a0d7b954_motioneye\",\"a0d7b954_vscode\",\"a0d7b954_unifi\",\"a0d7b954_nodered\",\"a0d7b954_logviewer\",\"a0d7b954_portainer\",\"core_samba\",\"a0d7b954_appdaemon3\",\"a0d7b954_grafana\",\"core_ssh\",\"core_duckdns\",\"03d23610_dasshio\",\"core_mosquitto\",\"a0d7b954_sonweb\",\"core_samba\",\"a0d7b954_nodered\",\"a0d7b954_logviewer\",\"a0d7b954_motioneye\",\"03d23610_dasshio\",\"core_ssh\",\"a0d7b954_portainer\",\"a0d7b954_grafana\",\"core_duckdns\",\"a0d7b954_plex\"],\"folders\":[\"homeassistant\",\"ssl\",\"addons_local.tar\"]}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 530,
        "y": 1160,
        "wires": [
            [
                "ef6362ca.c8d73"
            ]
        ]
    },
    {
        "id": "ef930840.9f5ef8",
        "type": "inject",
        "z": "b8a16318.b66a5",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 240,
        "y": 1160,
        "wires": [
            [
                "93002185.91156"
            ]
        ]
    },
    {
        "id": "ef6362ca.c8d73",
        "type": "debug",
        "z": "b8a16318.b66a5",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 810,
        "y": 1160,
        "wires": []
    },
    {
        "id": "f1015be1.129118",
        "type": "mqtt out",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "topic": "kitchen/dishwasher",
        "qos": "",
        "retain": "",
        "broker": "1b6bc4ba.56ff4b",
        "x": 1290,
        "y": 380,
        "wires": []
    },
    {
        "id": "5b45d804.3fbd78",
        "type": "switch",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Running",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "paused",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off ",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 710,
        "y": 420,
        "wires": [
            [
                "f1015be1.129118"
            ],
            [
                "f1015be1.129118"
            ],
            [
                "f04c12f1.7bfe9",
                "f7ab9190.bfd47"
            ]
        ]
    },
    {
        "id": "f04c12f1.7bfe9",
        "type": "ha-wait-until",
        "z": "6e74caff.7ad1f4",
        "name": "",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "entityId": "door",
        "property": "",
        "comparator": "is",
        "value": "",
        "valueType": "str",
        "timeout": 0,
        "timeoutUnits": "seconds",
        "entityLocation": "",
        "entityLocationType": "none",
        "checkCurrentState": true,
        "blockInputOverrides": true,
        "x": 920,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "f7ab9190.bfd47",
        "type": "change",
        "z": "6e74caff.7ad1f4",
        "name": "Washed",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Washed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 440,
        "wires": [
            [
                "f1015be1.129118"
            ]
        ]
    },
    {
        "id": "32e8e836.bbb578",
        "type": "catch",
        "z": "84ed1066.f22de",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 60,
        "wires": [
            [
                "77633fff.a34ae"
            ]
        ]
    },
    {
        "id": "77633fff.a34ae",
        "type": "subflow:f5eab19a.7cf17",
        "z": "84ed1066.f22de",
        "name": "",
        "x": 350,
        "y": 60,
        "wires": []
    },
    {
        "id": "792b4e79.c84b8",
        "type": "comment",
        "z": "84ed1066.f22de",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 20,
        "wires": []
    },
    {
        "id": "c89dd3e1.b78cb",
        "type": "catch",
        "z": "e361c01.ee9f54",
        "name": "",
        "scope": null,
        "x": 160,
        "y": 100,
        "wires": [
            [
                "8173a0ff.8a22"
            ]
        ]
    },
    {
        "id": "8173a0ff.8a22",
        "type": "subflow:f5eab19a.7cf17",
        "z": "e361c01.ee9f54",
        "name": "",
        "x": 390,
        "y": 100,
        "wires": []
    },
    {
        "id": "57b88e3d.55fb5",
        "type": "comment",
        "z": "e361c01.ee9f54",
        "name": "Error Handler",
        "info": "",
        "x": 170,
        "y": 60,
        "wires": []
    },
    {
        "id": "459d6827.eb2ff8",
        "type": "server-state-changed",
        "z": "e361c01.ee9f54",
        "name": "Power Change",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "sensor.plug_02_energy_power",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 180,
        "y": 180,
        "wires": [
            [
                "dcf0e660.845408",
                "dd1b2ddf.ab4aa"
            ]
        ]
    },
    {
        "id": "ee2fe00c.dfd2d",
        "type": "switch",
        "z": "e361c01.ee9f54",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 490,
        "y": 180,
        "wires": [
            [
                "3d849770.8ae318"
            ],
            [
                "3db19334.8fee3c",
                "ba2df1bf.c4dd7"
            ]
        ]
    },
    {
        "id": "dcf0e660.845408",
        "type": "debug",
        "z": "e361c01.ee9f54",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 370,
        "y": 140,
        "wires": []
    },
    {
        "id": "dd1b2ddf.ab4aa",
        "type": "rbe",
        "z": "e361c01.ee9f54",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 350,
        "y": 180,
        "wires": [
            [
                "ee2fe00c.dfd2d"
            ]
        ]
    },
    {
        "id": "3d849770.8ae318",
        "type": "trigger",
        "z": "e361c01.ee9f54",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 890,
        "y": 180,
        "wires": [
            [
                "ba2df1bf.c4dd7"
            ]
        ]
    },
    {
        "id": "3db19334.8fee3c",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 200,
        "wires": [
            [
                "3d849770.8ae318"
            ]
        ]
    },
    {
        "id": "8512839f.c786a",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Tempure Control - Get Target",
        "info": "",
        "x": 160,
        "y": 1420,
        "wires": []
    },
    {
        "id": "22891806.64f638",
        "type": "mqtt in",
        "z": "21d6efde.d0943",
        "name": "bedroom/ac/temperature/set",
        "topic": "bedroom/ac/temperature/set",
        "qos": "2",
        "datatype": "auto",
        "broker": "1b6bc4ba.56ff4b",
        "x": 140,
        "y": 1620,
        "wires": [
            [
                "9c51fdcd.c41e7"
            ]
        ]
    },
    {
        "id": "d70fa3b8.bbf3c",
        "type": "server-state-changed",
        "z": "21d6efde.d0943",
        "name": "",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "climate.bedroom",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 150,
        "y": 1820,
        "wires": [
            [
                "63f3fbc4.44b3a4",
                "1d40f751.e5c5e9"
            ]
        ]
    },
    {
        "id": "a232e09b.a287c",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Current Target",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "climate.bedroom",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 360,
        "y": 1480,
        "wires": [
            [
                "7ce04831.3ae818"
            ]
        ]
    },
    {
        "id": "e277f8fc.dd9e88",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "Start Up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 120,
        "y": 1480,
        "wires": [
            [
                "a232e09b.a287c"
            ]
        ]
    },
    {
        "id": "63f3fbc4.44b3a4",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Off?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "auto",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 410,
        "y": 1820,
        "wires": [
            [
                "7cb468dc.60a3a8"
            ],
            [
                "9d2fae06.e4429"
            ]
        ]
    },
    {
        "id": "7cb468dc.60a3a8",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Fan Off",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.plug_04\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1040,
        "y": 1980,
        "wires": [
            []
        ]
    },
    {
        "id": "7738872a.c8fec8",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Fan On",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_on",
        "data": "{\"entity_id\":\"switch.plug_04\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1040,
        "y": 2020,
        "wires": [
            []
        ]
    },
    {
        "id": "b3d23dae.d82fc",
        "type": "server-state-changed",
        "z": "21d6efde.d0943",
        "name": "Temperature Change",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "sensor.bedroom_temperature",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "num",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 120,
        "y": 2000,
        "wires": [
            [
                "bc8c848c.de4218"
            ]
        ]
    },
    {
        "id": "bc8c848c.de4218",
        "type": "rbe",
        "z": "21d6efde.d0943",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 390,
        "y": 2000,
        "wires": [
            [
                "b21ead51.2e274"
            ]
        ]
    },
    {
        "id": "9c51fdcd.c41e7",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bedroom.targettemp",
                "pt": "global",
                "to": "$number(payload)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 1620,
        "wires": [
            [
                "9d2fae06.e4429",
                "2fe61c64.f41694"
            ]
        ]
    },
    {
        "id": "1a74e282.88c43d",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "bedroom.targettemp",
                "vt": "global"
            },
            {
                "t": "gt",
                "v": "bedroom.targettemp",
                "vt": "global"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 870,
        "y": 2000,
        "wires": [
            [
                "7cb468dc.60a3a8"
            ],
            [
                "7738872a.c8fec8"
            ]
        ]
    },
    {
        "id": "7ce04831.3ae818",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bedroom.targettemp",
                "pt": "global",
                "to": "$number(data.attributes.temperature)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "bedroom.ac.status",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "b0d7b9ab.a54a28",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "bedroom.targettemp",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 1560,
        "wires": [
            [
                "214086c1.e908fa"
            ]
        ]
    },
    {
        "id": "422333fe.48c93c",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "Start Up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "10",
        "x": 120,
        "y": 1560,
        "wires": [
            [
                "b0d7b9ab.a54a28"
            ]
        ]
    },
    {
        "id": "214086c1.e908fa",
        "type": "debug",
        "z": "21d6efde.d0943",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 530,
        "y": 1560,
        "wires": []
    },
    {
        "id": "9d2fae06.e4429",
        "type": "api-current-state",
        "z": "21d6efde.d0943",
        "name": "Current Target",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "climate.bedroom",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 300,
        "y": 1900,
        "wires": [
            [
                "357964cc.1d2acc"
            ]
        ]
    },
    {
        "id": "cdffb08d.c0d2b",
        "type": "inject",
        "z": "21d6efde.d0943",
        "name": "Testing",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "20",
        "x": 90,
        "y": 1900,
        "wires": [
            [
                "9d2fae06.e4429"
            ]
        ]
    },
    {
        "id": "357964cc.1d2acc",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$number(data.attributes.current_temperature)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 1900,
        "wires": [
            [
                "b21ead51.2e274"
            ]
        ]
    },
    {
        "id": "1d40f751.e5c5e9",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bedroom.ac.status",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 1780,
        "wires": [
            []
        ]
    },
    {
        "id": "a55ccceb.c6863",
        "type": "comment",
        "z": "21d6efde.d0943",
        "name": "Tempure Control - Fan Status",
        "info": "",
        "x": 140,
        "y": 1700,
        "wires": []
    },
    {
        "id": "2fe61c64.f41694",
        "type": "debug",
        "z": "21d6efde.d0943",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 750,
        "y": 1620,
        "wires": []
    },
    {
        "id": "b21ead51.2e274",
        "type": "switch",
        "z": "21d6efde.d0943",
        "name": "Ac On?",
        "property": "bedroom.ac.status",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "auto",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 720,
        "y": 2000,
        "wires": [
            [
                "1a74e282.88c43d"
            ]
        ]
    },
    {
        "id": "9aa1f984.f7e9b8",
        "type": "comment",
        "z": "a83e69e1.4b2ab8",
        "name": "message == \"PAYLOAD\"",
        "info": "",
        "x": 510,
        "y": 20,
        "wires": []
    },
    {
        "id": "13aee063.b908",
        "type": "catch",
        "z": "8a69107f.14257",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "749a5f9f.b6165"
            ]
        ]
    },
    {
        "id": "749a5f9f.b6165",
        "type": "subflow:f5eab19a.7cf17",
        "z": "8a69107f.14257",
        "name": "",
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "65041a04.fc28d4",
        "type": "comment",
        "z": "8a69107f.14257",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "a2b59366.b506c",
        "type": "inject",
        "z": "8a69107f.14257",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 120,
        "y": 220,
        "wires": [
            [
                "3188d052.ade6a"
            ]
        ]
    },
    {
        "id": "dffa7430.b742c8",
        "type": "server-state-changed",
        "z": "8a69107f.14257",
        "name": "",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "input_boolean.danni_button",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 210,
        "y": 260,
        "wires": [
            [
                "3188d052.ade6a"
            ]
        ]
    },
    {
        "id": "3188d052.ade6a",
        "type": "delay",
        "z": "8a69107f.14257",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 520,
        "y": 260,
        "wires": [
            [
                "18ef958.0291f6b",
                "b72ca218.0888c",
                "9230b5c2.51a1b8"
            ]
        ]
    },
    {
        "id": "18ef958.0291f6b",
        "type": "api-call-service",
        "z": "8a69107f.14257",
        "name": "Toggle library_lights",
        "server": "5ee4d578.f7736c",
        "service_domain": "light",
        "service": "toggle",
        "data": "{\"entity_id\":\"light.library_lights\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 820,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "b72ca218.0888c",
        "type": "api-call-service",
        "z": "8a69107f.14257",
        "name": "Reset Button Status",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_boolean",
        "service": "turn_off",
        "data": "{\"entity_id\":\"input_boolean.danni_button\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 820,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "23f1ca9a.46ac56",
        "type": "inject",
        "z": "8a69107f.14257",
        "name": "Start up",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 540,
        "y": 320,
        "wires": [
            [
                "b72ca218.0888c"
            ]
        ]
    },
    {
        "id": "f6c97631.876a78",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Turn BedRoom Themo Stat Off",
        "server": "5ee4d578.f7736c",
        "service_domain": "climate",
        "service": "turn_off",
        "data": "{\"entity_id\":\"climate.bedroom\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 1130,
        "y": 1140,
        "wires": [
            []
        ]
    },
    {
        "id": "46aac761.a8d478",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "TV On/Off",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "toggle",
        "data": "{\"entity_id\":\"switch.tv\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 300,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "7bbc3eb4.8f7f7",
        "type": "alexa-home",
        "z": "9a341993.fbc528",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51101",
        "acknoledge": true,
        "name": "TV",
        "topic": "",
        "x": 90,
        "y": 560,
        "wires": [
            [
                "46aac761.a8d478"
            ]
        ]
    },
    {
        "id": "70c7c129.62c72",
        "type": "alexa-home",
        "z": "acf12371.2c1ae",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51127",
        "acknoledge": true,
        "name": "Office Light",
        "topic": "",
        "x": 110,
        "y": 880,
        "wires": [
            [
                "7220a200.ab48bc"
            ]
        ]
    },
    {
        "id": "e5fca852.5b0018",
        "type": "function",
        "z": "acf12371.2c1ae",
        "name": "",
        "func": "light = msg.light\ncommad = \"turn_on\"\nif (msg.command == \"TurnOffRequest\") {\n    commad = \"turn_off\"\n}\n\nif (msg.command == \"SetPercentageRequest\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : commad,\n     \"data\" : \n        { \n            \"entity_id\" : light,\n            \"brightness_pct\": msg.payload\n        } \n    }\n} else  if (msg.command == \"SetColorRequest\") {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : commad,\n     \"data\" : \n        { \n            \"entity_id\" : light,\n            \"hs_color\": [msg.payload.hue,80 ]\n        } \n    }\n\n\n} else {\n    msg.payload = { \"domain\" : \"light\",\n    \"service\" : commad,\n     \"data\" : \n        { \n            \"entity_id\" : light\n        } \n    }\n}\n\n    \n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 880,
        "wires": [
            [
                "97d287d3.931b08"
            ]
        ],
        "outputLabels": [
            "On"
        ]
    },
    {
        "id": "97d287d3.931b08",
        "type": "api-call-service",
        "z": "acf12371.2c1ae",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "",
        "service": "",
        "data": "",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "x": 730,
        "y": 880,
        "wires": [
            [
                "6fd2f313.15989c"
            ]
        ]
    },
    {
        "id": "7220a200.ab48bc",
        "type": "change",
        "z": "acf12371.2c1ae",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "light",
                "pt": "msg",
                "to": "light.office_light",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 880,
        "wires": [
            [
                "e5fca852.5b0018"
            ]
        ]
    },
    {
        "id": "b0af4cab.0987e",
        "type": "api-current-state",
        "z": "acf12371.2c1ae",
        "name": "",
        "server": "5ee4d578.f7736c",
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "{\"entity_id\":msg.payload}",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1240,
        "y": 880,
        "wires": [
            [
                "563f792a.0bae58"
            ]
        ]
    },
    {
        "id": "563f792a.0bae58",
        "type": "debug",
        "z": "acf12371.2c1ae",
        "name": "Get State",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1540,
        "y": 880,
        "wires": []
    },
    {
        "id": "6fd2f313.15989c",
        "type": "function",
        "z": "acf12371.2c1ae",
        "name": "",
        "func": "\n\n    msg.payload = \"light.office_light\"\n\n\n    \n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 930,
        "y": 880,
        "wires": [
            [
                "b0af4cab.0987e"
            ]
        ],
        "outputLabels": [
            "On"
        ]
    },
    {
        "id": "2aae3e27.5ca3a2",
        "type": "api-current-state",
        "z": "acf12371.2c1ae",
        "name": "Office Plug State",
        "server": "eef5a84.da24f58",
        "version": 1,
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": true,
        "entity_id": "switch.plug_05",
        "state_type": "str",
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 530,
        "y": 960,
        "wires": [
            [
                "e2e2154f.5b1378"
            ]
        ]
    },
    {
        "id": "e2e2154f.5b1378",
        "type": "switch",
        "z": "acf12371.2c1ae",
        "name": "No?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 710,
        "y": 960,
        "wires": [
            [
                "31072690.e3364a"
            ],
            []
        ]
    },
    {
        "id": "eef647a0.bc28f8",
        "type": "alexa-home",
        "z": "acf12371.2c1ae",
        "conf": "3fa4c0fe.0f3ed",
        "device": "51102",
        "acknoledge": true,
        "name": "Computer",
        "topic": "",
        "x": 100,
        "y": 980,
        "wires": [
            [
                "1de7a1cf.3f6b6e"
            ]
        ]
    },
    {
        "id": "73676143.217a5",
        "type": "subflow:2aff94ce.fdbbdc",
        "z": "acf12371.2c1ae",
        "name": "",
        "env": [],
        "x": 530,
        "y": 1000,
        "wires": [
            []
        ]
    },
    {
        "id": "1de7a1cf.3f6b6e",
        "type": "subflow:fec14295.8a46d",
        "z": "acf12371.2c1ae",
        "name": "",
        "x": 300,
        "y": 980,
        "wires": [
            [
                "2aae3e27.5ca3a2"
            ],
            [
                "73676143.217a5"
            ],
            []
        ]
    },
    {
        "id": "aeaa8ad9.155118",
        "type": "catch",
        "z": "80866e71.966c6",
        "name": "",
        "scope": null,
        "x": 120,
        "y": 80,
        "wires": [
            [
                "e7f80448.57d3b8"
            ]
        ]
    },
    {
        "id": "e7f80448.57d3b8",
        "type": "subflow:f5eab19a.7cf17",
        "z": "80866e71.966c6",
        "name": "",
        "x": 350,
        "y": 80,
        "wires": []
    },
    {
        "id": "1ddf72a9.fdd1dd",
        "type": "comment",
        "z": "80866e71.966c6",
        "name": "Error Handler",
        "info": "",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "3519bbc8.f58554",
        "type": "change",
        "z": "5625076e.ee59e8",
        "name": "The door bell has been pressed The door bell has been pressed",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "The door bell has been pressed The door bell has been pressed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 480,
        "wires": [
            [
                "bed4d962.498428"
            ]
        ]
    },
    {
        "id": "bed4d962.498428",
        "type": "subflow:47bc2d66.1132e4",
        "z": "5625076e.ee59e8",
        "name": "",
        "x": 930,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "4905c786.48bbf8",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 140,
        "y": 340,
        "wires": [
            [
                "dd3eec86.c33db"
            ]
        ]
    },
    {
        "id": "192ac354.6dc3fd",
        "type": "comment",
        "z": "a0a4859f.5a2a48",
        "name": "Presence Detected",
        "info": "",
        "x": 170,
        "y": 180,
        "wires": []
    },
    {
        "id": "27296b10.af2594",
        "type": "switch",
        "z": "f5eab19a.7cf17",
        "name": "",
        "property": "error.message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Call-service API error. Error Message: 'rateLimits'",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 410,
        "y": 60,
        "wires": [
            [],
            [
                "8ee737f2.2dc868"
            ]
        ]
    },
    {
        "id": "40a46c6f.c7ba64",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Bed side plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_on",
        "data": "{\"entity_id\":\"switch.plug_08\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 960,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "e00c5e15.87c8",
        "type": "function",
        "z": "21d6efde.d0943",
        "name": "Someone got into to bed and bed was empty",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 600,
        "wires": [
            [
                "d94b6303.4c9b4",
                "40a46c6f.c7ba64",
                "19968e17.daaa62"
            ]
        ]
    },
    {
        "id": "89782bb8.4daed8",
        "type": "function",
        "z": "21d6efde.d0943",
        "name": "Emtpy Bed",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 800,
        "wires": [
            [
                "4775ee16.55733"
            ]
        ]
    },
    {
        "id": "4775ee16.55733",
        "type": "trigger",
        "z": "21d6efde.d0943",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "15",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 950,
        "y": 760,
        "wires": [
            [
                "e7c2066f.c4ddf8",
                "b191db40.a5b7f8"
            ]
        ]
    },
    {
        "id": "e7c2066f.c4ddf8",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Bed side plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.plug_08\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1140,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "2f384af5.144826",
        "type": "trigger",
        "z": "21d6efde.d0943",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "pay",
        "duration": "20",
        "extend": true,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 1030,
        "y": 400,
        "wires": [
            [
                "406dc049.8d9a9"
            ]
        ]
    },
    {
        "id": "b191db40.a5b7f8",
        "type": "api-call-service",
        "z": "21d6efde.d0943",
        "name": "Bedroom climate",
        "server": "5ee4d578.f7736c",
        "service_domain": "climate",
        "service": "turn_off",
        "data": "{\"entity_id\":\"climate.bedroom\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1150,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "31072690.e3364a",
        "type": "api-call-service",
        "z": "acf12371.2c1ae",
        "name": "Office Plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_on",
        "data": "{\"entity_id\":\"switch.plug_05\"}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 910,
        "y": 960,
        "wires": [
            []
        ]
    },
    {
        "id": "19968e17.daaa62",
        "type": "change",
        "z": "21d6efde.d0943",
        "name": "Reset",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "unauthorised access detected. notifying police, uploading real-time camera footage to remote server",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 740,
        "wires": [
            [
                "4775ee16.55733"
            ]
        ]
    },
    {
        "id": "72c8674b.8e3c38",
        "type": "api-call-service",
        "z": "a3158433.9d1f78",
        "name": "Bed side plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "turn_off",
        "data": "{\"entity_id\":\"switch.plug_08\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 1080,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "4a6ffa82.453554",
        "type": "server-state-changed",
        "z": "a068bd5.28a8d4",
        "name": "Kitchen Motion",
        "server": "5ee4d578.f7736c",
        "version": "1",
        "entityidfilter": "binary_sensor.kitchen_motion",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": false,
        "x": 120,
        "y": 720,
        "wires": [
            [
                "726c2fb2.8c822",
                "3495a219.f840be"
            ]
        ]
    },
    {
        "id": "726c2fb2.8c822",
        "type": "change",
        "z": "a068bd5.28a8d4",
        "name": "Kitchen Motion",
        "rules": [
            {
                "t": "set",
                "p": "location",
                "pt": "msg",
                "to": "Kitchen Motion",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 720,
        "wires": [
            [
                "64a723bb.a421cc"
            ]
        ]
    },
    {
        "id": "3495a219.f840be",
        "type": "link out",
        "z": "a068bd5.28a8d4",
        "name": "Kitchen Motion Detected",
        "links": [
            "8f80ab0d.e271b8"
        ],
        "x": 355,
        "y": 760,
        "wires": []
    },
    {
        "id": "9230b5c2.51a1b8",
        "type": "api-call-service",
        "z": "8a69107f.14257",
        "name": "Toggle plug",
        "server": "5ee4d578.f7736c",
        "service_domain": "switch",
        "service": "toggle",
        "data": "{\"entity_id\":\"switch.plug_06\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 790,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "86cbf076.c386f",
        "type": "counter",
        "z": "d73100a9.0d64d",
        "name": "",
        "init": "0",
        "step": "1",
        "lower": "",
        "upper": "100",
        "mode": "increment",
        "outputs": 1,
        "x": 2320,
        "y": 100,
        "wires": [
            [
                "9d46d128.5c116",
                "22b85b0d.95e5b4"
            ]
        ]
    },
    {
        "id": "9d46d128.5c116",
        "type": "debug",
        "z": "d73100a9.0d64d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 2630,
        "y": 60,
        "wires": []
    },
    {
        "id": "6a38d27e.f667ec",
        "type": "inject",
        "z": "d73100a9.0d64d",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 1280,
        "y": 440,
        "wires": [
            [
                "8cbf3f8d.84749"
            ]
        ]
    },
    {
        "id": "633fd784.87d398",
        "type": "inject",
        "z": "d73100a9.0d64d",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 640,
        "y": 60,
        "wires": [
            [
                "1f2cf988.2620b6"
            ]
        ]
    },
    {
        "id": "1f2cf988.2620b6",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasGoodNightBeenTriggered",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "54338a4f.a1c854",
        "type": "delay",
        "z": "d73100a9.0d64d",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 2680,
        "y": 220,
        "wires": [
            [
                "8cbf3f8d.84749"
            ]
        ]
    },
    {
        "id": "22b85b0d.95e5b4",
        "type": "switch",
        "z": "d73100a9.0d64d",
        "name": "up to 5 time",
        "property": "count",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "5",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2490,
        "y": 180,
        "wires": [
            [
                "832545e1.4bf1f8"
            ],
            [
                "54338a4f.a1c854"
            ]
        ]
    },
    {
        "id": "99afc7fd.02cdd8",
        "type": "change",
        "z": "d73100a9.0d64d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2940,
        "y": 100,
        "wires": [
            [
                "86cbf076.c386f"
            ]
        ]
    },
    {
        "id": "c73f668c.f7ef28",
        "type": "function",
        "z": "d73100a9.0d64d",
        "name": "-",
        "func": "\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1030,
        "y": 120,
        "wires": [
            [
                "86cbf076.c386f"
            ]
        ]
    },
    {
        "id": "832545e1.4bf1f8",
        "type": "trigger",
        "z": "d73100a9.0d64d",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "15",
        "extend": true,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 2690,
        "y": 160,
        "wires": [
            [
                "99afc7fd.02cdd8",
                "8cbf3f8d.84749"
            ]
        ]
    },
    {
        "id": "9b9a792f.af51f8",
        "type": "change",
        "z": "a0cdc0f9.a362b",
        "name": "Off",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 640,
        "wires": [
            [
                "43f0cbfb.ff1114"
            ]
        ]
    },
    {
        "id": "d967e96f.341888",
        "type": "server-state-changed",
        "z": "9a341993.fbc528",
        "name": "Power Change",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "sensor.plug_07_energy_power",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 180,
        "y": 960,
        "wires": [
            [
                "e9f4c700.bf3c08",
                "bbcfcdc6.3d796"
            ]
        ]
    },
    {
        "id": "b0c782fe.509f1",
        "type": "switch",
        "z": "9a341993.fbc528",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 490,
        "y": 960,
        "wires": [
            [
                "c9a21b37.68cf68"
            ],
            [
                "dc700d5c.5f554",
                "c562a33.fc16d6"
            ]
        ]
    },
    {
        "id": "e9f4c700.bf3c08",
        "type": "debug",
        "z": "9a341993.fbc528",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 370,
        "y": 920,
        "wires": []
    },
    {
        "id": "bbcfcdc6.3d796",
        "type": "rbe",
        "z": "9a341993.fbc528",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 350,
        "y": 960,
        "wires": [
            [
                "b0c782fe.509f1"
            ]
        ]
    },
    {
        "id": "c9a21b37.68cf68",
        "type": "trigger",
        "z": "9a341993.fbc528",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 890,
        "y": 960,
        "wires": [
            [
                "c562a33.fc16d6"
            ]
        ]
    },
    {
        "id": "dc700d5c.5f554",
        "type": "change",
        "z": "9a341993.fbc528",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 980,
        "wires": [
            [
                "c9a21b37.68cf68"
            ]
        ]
    },
    {
        "id": "c562a33.fc16d6",
        "type": "switch",
        "z": "9a341993.fbc528",
        "name": "Status",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "btwn",
                "v": "",
                "vt": "num",
                "v2": "10",
                "v2t": "num"
            },
            {
                "t": "lt",
                "v": "270",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 150,
        "y": 1160,
        "wires": [
            [
                "8c3e0d70.aec22"
            ],
            [
                "5c0d216f.67deb"
            ],
            [
                "d72e9909.52f548"
            ]
        ]
    },
    {
        "id": "ba2df1bf.c4dd7",
        "type": "switch",
        "z": "e361c01.ee9f54",
        "name": "Status",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "10",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "200",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "1000",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 5,
        "x": 210,
        "y": 420,
        "wires": [
            [
                "afe8d4d6.b3fa78"
            ],
            [
                "afe8d4d6.b3fa78"
            ],
            [
                "e2de91a7.55223"
            ],
            [
                "450d4cab.ced584"
            ],
            [
                "482d8d0a.6d6084"
            ]
        ]
    },
    {
        "id": "afe8d4d6.b3fa78",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "Idle",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Idle",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 380,
        "wires": [
            [
                "4265f93c.c31368",
                "35d0937d.32b63c"
            ]
        ]
    },
    {
        "id": "e2de91a7.55223",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "Pumping",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Pumping",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 420,
        "wires": [
            [
                "4265f93c.c31368",
                "4974bc55.4878e4"
            ]
        ]
    },
    {
        "id": "450d4cab.ced584",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "In Use",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "In Use",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 460,
        "wires": [
            [
                "4265f93c.c31368",
                "4974bc55.4878e4"
            ]
        ]
    },
    {
        "id": "482d8d0a.6d6084",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "Heating",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Heating",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 500,
        "wires": [
            [
                "4265f93c.c31368",
                "4974bc55.4878e4"
            ]
        ]
    },
    {
        "id": "4265f93c.c31368",
        "type": "mqtt out",
        "z": "e361c01.ee9f54",
        "name": "hottub/status",
        "topic": "hottub/status",
        "qos": "",
        "retain": "",
        "broker": "1b6bc4ba.56ff4b",
        "x": 710,
        "y": 440,
        "wires": []
    },
    {
        "id": "5c0d216f.67deb",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "On",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_select",
        "service": "select_option",
        "data": "{\"entity_id\":\"input_select.tv_state\",\"option\":\"True\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 630,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "8c3e0d70.aec22",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "Off",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_select",
        "service": "select_option",
        "data": "{\"entity_id\":\"input_select.tv_state\",\"option\":\"False\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 630,
        "y": 1140,
        "wires": [
            []
        ]
    },
    {
        "id": "d72e9909.52f548",
        "type": "api-call-service",
        "z": "9a341993.fbc528",
        "name": "Unknown",
        "server": "5ee4d578.f7736c",
        "service_domain": "input_select",
        "service": "select_option",
        "data": "{\"entity_id\":\"input_select.tv_state\",\"option\":\"Unknown\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 640,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "18ec81d3.1ead2e",
        "type": "inject",
        "z": "9a341993.fbc528",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 1280,
        "wires": [
            [
                "8c3e0d70.aec22"
            ]
        ]
    },
    {
        "id": "ba7c674e.596bb8",
        "type": "inject",
        "z": "9a341993.fbc528",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 1320,
        "wires": [
            [
                "5c0d216f.67deb"
            ]
        ]
    },
    {
        "id": "13a3bd63.527173",
        "type": "inject",
        "z": "9a341993.fbc528",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 1360,
        "wires": [
            [
                "d72e9909.52f548"
            ]
        ]
    },
    {
        "id": "1e85a050.8412e",
        "type": "api-call-service",
        "z": "5625076e.ee59e8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "persistent_notification",
        "service": "create",
        "data": "{\"message\":\"Test mesas\",\"title\":\"Test\",\"notification_id\":\"TEST_STATUS\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 660,
        "y": 660,
        "wires": [
            [
                "777dcdd0.a0f054"
            ]
        ]
    },
    {
        "id": "8f560a67.f57328",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 660,
        "wires": [
            [
                "1e85a050.8412e"
            ]
        ]
    },
    {
        "id": "4316a52c.7d3e4c",
        "type": "api-call-service",
        "z": "5625076e.ee59e8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "persistent_notification",
        "service": "mark_read",
        "data": "{\"notification_id\":\"TEST_STATUS\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 670,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "cf940c07.d9f6e",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 700,
        "wires": [
            [
                "4316a52c.7d3e4c"
            ]
        ]
    },
    {
        "id": "d253c5f.8474838",
        "type": "api-call-service",
        "z": "5625076e.ee59e8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "persistent_notification",
        "service": "dismiss",
        "data": "{\"notification_id\":\"TEST_STATUS\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 660,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "737971fa.45f07",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 740,
        "wires": [
            [
                "d253c5f.8474838"
            ]
        ]
    },
    {
        "id": "caf78461.797e28",
        "type": "api-call-service",
        "z": "5625076e.ee59e8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "persistent_notification",
        "service": "create",
        "data": "{\"message\":\"Test mesas 2\",\"title\":\"Test\",\"notification_id\":\"TEST_STATUS\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 660,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "505a1442.9d24ac",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 200,
        "y": 620,
        "wires": [
            [
                "caf78461.797e28"
            ]
        ]
    },
    {
        "id": "11e9587a.801138",
        "type": "api-call-service",
        "z": "5625076e.ee59e8",
        "name": "",
        "server": "5ee4d578.f7736c",
        "service_domain": "persistent_notification",
        "service": "create",
        "data": "{\"message\":\"Test mesas 2\",\"title\":\"Test 3\",\"notification_id\":\"TEST_STATUS\"}",
        "mergecontext": "",
        "output_location": "",
        "output_location_type": "none",
        "mustacheAltTags": false,
        "x": 640,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "797ea2c9.e54f2c",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 580,
        "wires": [
            [
                "11e9587a.801138"
            ]
        ]
    },
    {
        "id": "2ecc5432.0e657c",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 860,
        "wires": [
            [
                "17b880fd.520f4f"
            ]
        ]
    },
    {
        "id": "17b880fd.520f4f",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "5625076e.ee59e8",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Hello"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            }
        ],
        "x": 500,
        "y": 860,
        "wires": []
    },
    {
        "id": "79fc60a0.6824a",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 920,
        "wires": [
            [
                "6ebdb102.efdff"
            ]
        ]
    },
    {
        "id": "6ebdb102.efdff",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "5625076e.ee59e8",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Hello"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            },
            {
                "name": "notification_id",
                "type": "str",
                "value": "fdgf"
            }
        ],
        "x": 500,
        "y": 920,
        "wires": []
    },
    {
        "id": "107302af.bf410d",
        "type": "api-call-service",
        "z": "a83e69e1.4b2ab8",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "persistent_notification",
        "service": "create",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 780,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "777dcdd0.a0f054",
        "type": "debug",
        "z": "5625076e.ee59e8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 970,
        "y": 660,
        "wires": []
    },
    {
        "id": "bdb64371.3e3f2",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 1000,
        "wires": [
            [
                "67b09a7e.6e4434"
            ]
        ]
    },
    {
        "id": "67b09a7e.6e4434",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "5625076e.ee59e8",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "somethign else"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            },
            {
                "name": "notification_id",
                "type": "str",
                "value": "fdgf"
            },
            {
                "name": "title",
                "type": "str",
                "value": "New toitle"
            }
        ],
        "x": 500,
        "y": 1000,
        "wires": []
    },
    {
        "id": "21ae6270.68b64e",
        "type": "api-call-service",
        "z": "a83e69e1.4b2ab8",
        "name": "",
        "server": "eef5a84.da24f58",
        "service_domain": "persistent_notification",
        "service": "dismiss",
        "data": "{}",
        "mergecontext": "",
        "output_location": "payload",
        "output_location_type": "msg",
        "mustacheAltTags": false,
        "x": 780,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "2f94a2c3.b155ae",
        "type": "inject",
        "z": "5625076e.ee59e8",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 180,
        "y": 1220,
        "wires": [
            [
                "34a4d39.8bcdb2c"
            ]
        ]
    },
    {
        "id": "34a4d39.8bcdb2c",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "5625076e.ee59e8",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "somethign else"
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            },
            {
                "name": "notification_id",
                "type": "str",
                "value": "fdgf"
            },
            {
                "name": "title",
                "type": "str",
                "value": "CLEARED"
            }
        ],
        "x": 500,
        "y": 1220,
        "wires": []
    },
    {
        "id": "35d0937d.32b63c",
        "type": "trigger",
        "z": "e361c01.ee9f54",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "2",
        "extend": false,
        "units": "hr",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 930,
        "y": 360,
        "wires": [
            [
                "9f63165a.d89408",
                "a11fdde.730532"
            ]
        ]
    },
    {
        "id": "4974bc55.4878e4",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 400,
        "wires": [
            [
                "35d0937d.32b63c",
                "8ad6dfaa.2113f"
            ]
        ]
    },
    {
        "id": "9f63165a.d89408",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "e361c01.ee9f54",
        "name": "Hot Idle",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "hot tub has been idle for more then "
            },
            {
                "name": "who",
                "type": "str",
                "value": "Matt"
            },
            {
                "name": "notification_id",
                "type": "str",
                "value": "HOT_TUB_STATUS"
            },
            {
                "name": "title",
                "type": "str",
                "value": "Hot Tub Offline"
            }
        ],
        "x": 1160,
        "y": 320,
        "wires": []
    },
    {
        "id": "6cc4111d.451eb",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "e361c01.ee9f54",
        "name": "Hot Restored",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "Hot tube back on line"
            },
            {
                "name": "who",
                "type": "str",
                "value": "both"
            },
            {
                "name": "notification_id",
                "type": "str",
                "value": "HOT_TUB_STATUS"
            },
            {
                "name": "title",
                "type": "str",
                "value": "CLEARED"
            }
        ],
        "x": 1170,
        "y": 400,
        "wires": []
    },
    {
        "id": "a11fdde.730532",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "Idle Status = True",
        "rules": [
            {
                "t": "set",
                "p": "hottub.idlestatus",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1190,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "419b14f2.a8fb9c",
        "type": "change",
        "z": "e361c01.ee9f54",
        "name": "Idle Status = False",
        "rules": [
            {
                "t": "set",
                "p": "hottub.idlestatus",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1190,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "8ad6dfaa.2113f",
        "type": "switch",
        "z": "e361c01.ee9f54",
        "name": "Idle Status",
        "property": "hottub.idlestatus",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 930,
        "y": 420,
        "wires": [
            [
                "6cc4111d.451eb",
                "419b14f2.a8fb9c"
            ],
            [
                "419b14f2.a8fb9c",
                "5a385c61.1d7704"
            ]
        ]
    },
    {
        "id": "5a385c61.1d7704",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "e361c01.ee9f54",
        "name": "Hot Restored - Dont send notication",
        "env": [
            {
                "name": "notification_id",
                "type": "str",
                "value": "HOT_TUB_STATUS"
            },
            {
                "name": "title",
                "type": "str",
                "value": "CLEARED"
            }
        ],
        "x": 1240,
        "y": 480,
        "wires": []
    },
    {
        "id": "5fee203c.653f4",
        "type": "server-state-changed",
        "z": "f92add19.c43b9",
        "name": "",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "entityidfilter": "input_text.alexa_tts",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "x": 160,
        "y": 720,
        "wires": [
            [
                "62af2699.5a7be8"
            ]
        ]
    },
    {
        "id": "dc4f4973.c90148",
        "type": "subflow:47bc2d66.1132e4",
        "z": "f92add19.c43b9",
        "name": "",
        "env": [],
        "x": 1210,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "62af2699.5a7be8",
        "type": "change",
        "z": "f92add19.c43b9",
        "name": "Move to Msg.Say",
        "rules": [
            {
                "t": "set",
                "p": "say",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 720,
        "wires": [
            [
                "905d0b84.742ea8"
            ]
        ]
    },
    {
        "id": "905d0b84.742ea8",
        "type": "api-current-state",
        "z": "f92add19.c43b9",
        "name": "",
        "server": "5ee4d578.f7736c",
        "version": 1,
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "override_topic": false,
        "entity_id": "input_select.alexa_tts_echo",
        "state_type": "str",
        "state_location": "alexa",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "blockInputOverrides": false,
        "x": 800,
        "y": 720,
        "wires": [
            [
                "dc4f4973.c90148"
            ]
        ]
    },
    {
        "id": "ddc8f250.0fbf6",
        "type": "switch",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "property": "trusted",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 570,
        "y": 180,
        "wires": [
            [
                "6aaf5f6d.8996c"
            ],
            [
                "96f1c335.74979"
            ]
        ]
    },
    {
        "id": "4766ddd2.ac3f44",
        "type": "subflow:a83e69e1.4b2ab8",
        "z": "a0a4859f.5a2a48",
        "name": "",
        "env": [
            {
                "name": "message",
                "type": "str",
                "value": "PAYLOAD"
            },
            {
                "name": "who",
                "type": "str",
                "value": "both"
            }
        ],
        "x": 1460,
        "y": 180,
        "wires": []
    }
]